import{_ as e,r as o,o as c,c as u,a as n,b as s,d as t,e as a}from"./app-de0105a3.js";const l={},i=a('<h2 id="简介" tabindex="-1"><a class="header-anchor" href="#简介" aria-hidden="true">#</a> 简介</h2><p>双方使用相同的密钥对明文进行加解密。常见算法DES，DESede（3DES），AES，IDEA等。优点：计算量小，速度快，效率高。缺点：双方使用相同密钥，安全性难以保证；每对用户使用不同密钥时，在分布式等场景下的密钥管理难度高，使用成本高</p><h2 id="填充方式" tabindex="-1"><a class="header-anchor" href="#填充方式" aria-hidden="true">#</a> 填充方式</h2><p>常见填充方式如下</p><ul><li>NoPadding：不填充</li><li>ZerosPadding：0填充</li><li>PKCS5Padding：以填充字节数为值对目标字符串进行填充，如 <code>F9</code> 需填充7字节，填充后 <code>F9 07 07 07 07 07 07 07 </code>）</li></ul><h2 id="工作模式" tabindex="-1"><a class="header-anchor" href="#工作模式" aria-hidden="true">#</a> 工作模式</h2>',6),k={href:"https://zh.wikipedia.org/wiki/%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F",target:"_blank",rel:"noopener noreferrer"},r=a(`<ul><li><p>ECB模式（Electronic Code Book 电子密码本）：明文分为固定大小的块，每块独立进行分组加密</p><img src="https://upload.wikimedia.org/wikipedia/commons/c/c4/Ecb_encryption.png"></li><li><p>CBC模式（Cipher-block Chaining 密码块链）：每个明文块与前一轮输出块进行异或后再进行分组加密，加密块作为输出块。由于第一个块没有前一轮的输出，需要一个初始向量 (IV) 进行异或</p><img src="https://upload.wikimedia.org/wikipedia/commons/d/d3/Cbc_encryption.png"></li><li><p>CFB模式（Cipher Feedback 密码反馈）：将前一轮输出块进行分组加密，加密块再与当前明文块进行异或，作为本轮的输出块。由于第一个块没有前一轮的输出，也需要一个初始向量 (IV) 进行异或</p><img src="https://upload.wikimedia.org/wikipedia/commons/f/fd/Cfb_encryption.png"></li><li><p>OFB模式（Output Feedback 输出反馈）：将IV直接进行分组加密，得到新的密钥作为下一轮的输入。每轮输出内容是加密块与明文块异或的结果作为密文块</p><img src="https://upload.wikimedia.org/wikipedia/commons/a/a9/Ofb_encryption.png"></li><li><p>CTR模式（Counter 计数器）：将计数器通过密钥进行分组加密，结果再与明文异或作为输出</p><img src="https://upload.wikimedia.org/wikipedia/commons/3/3f/Ctr_encryption.png"></li><li><p>GCM模式（Galois/Counter Mode）</p></li></ul><h2 id="des" tabindex="-1"><a class="header-anchor" href="#des" aria-hidden="true">#</a> DES</h2><p>DES，即数据加密标准（Data Encrypt Standard），密钥长度56位</p><ul><li><p>DES算法消息传递流程</p><ul><li>消息传递双方同步密钥（单方生成 或 协商生成 等，生成后向未知方公布密钥）</li><li>发送者使用密钥对消息加密得到密文</li><li>发送者发送加密数据</li><li>接受者使用密钥对密文解密得到明文</li></ul></li><li><p>实现流程：将64位明文块通过64位密钥转变成64位密文块</p><ul><li>初始置换（IP）：64位分组数据块，通过一定规则对位的顺序进行对调，并拆成两个32位子分组：左32位 - L0、右32位- R0（input = D1D2D3...D64 -&gt; L0 = D58D50...D8; R0 = D57D49...D7）</li><li>通过16次迭代，得到L16，R16</li><li>逆置换：将L16，R16进行逆置换（初始置换的逆运算），得到密文</li></ul></li><li><p>代码</p><ul><li><p>Java API</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span><span class="token class-name">Key</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DES</span> <span class="token punctuation">{</span>  
    <span class="token comment">// 生成二进制密钥</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">initkey</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">{</span>
        <span class="token comment">// 实例化密钥生成器 - 需指定为哪种算法的密钥</span>
        <span class="token class-name">KeyGenerator</span> kg <span class="token operator">=</span> <span class="token class-name">KeyGenerator</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;DES&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        kg<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token number">56</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 初始化密钥长度</span>
        <span class="token class-name">SecretKey</span> secretKey <span class="token operator">=</span> kg<span class="token punctuation">.</span><span class="token function">generateKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 生成密钥</span>
        <span class="token keyword">return</span> secretKey<span class="token punctuation">.</span><span class="token function">getEncoded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 返回二进制编码</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 转换密钥 加解密时调用，将二进制密钥转换为可用密钥</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Key</span> <span class="token function">toKey</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> key<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">// 实例化密钥</span>
        <span class="token class-name">DESKeySpec</span> dks <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DESKeySpec</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 实例化密钥工厂</span>
        <span class="token class-name">SecretKeyFactory</span> keyFactory <span class="token operator">=</span> <span class="token class-name">SecretKeyFactory</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;DES&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 生成密钥</span>
        <span class="token class-name">SecretKey</span> secretKey <span class="token operator">=</span> keyFactory<span class="token punctuation">.</span><span class="token function">generateSecret</span><span class="token punctuation">(</span>dks<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> secretKey<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 加密</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> key<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;DES/ECB/PKCS5Padding&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// &lt;加解密算法&gt;/&lt;工作模式&gt;/&lt;填充方式&gt;</span>
        cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token constant">ENCRYPT_MODE</span><span class="token punctuation">,</span> <span class="token function">toKey</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 初始化，加密模式</span>
        <span class="token keyword">return</span> cipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 解密</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">decrypt</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> key<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;DES/ECB/PKCS5Padding&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// &lt;加解密算法&gt;/&lt;工作模式&gt;/&lt;填充方式&gt;</span>
        cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token constant">DECRYPT_MODE</span><span class="token punctuation">,</span> <span class="token function">toKey</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 初始化，解密模式</span>
        <span class="token keyword">return</span> cipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li></ul><h2 id="desede" tabindex="-1"><a class="header-anchor" href="#desede" aria-hidden="true">#</a> DESede</h2><p>DESede，即三重DES，又称3DES、Triple DES。用于克服DES算法密钥短等因素导致的安全性问题。密钥长度112位或168位（2倍3倍DES密钥长度），提高了安全性，但处理速度慢，计算时间长，效率不高</p>`,6),d=a(`<li><p>流程</p><ul><li>DESede3 168位密钥：将密钥拆成3个DES密钥，明文通过三个子密钥进行 <strong>DES加密 -&gt;DES解密 -&gt; DES加密</strong> 得到密文。如果前两个密钥相等，则只有最后一次加密有效，实现了对DES的向下兼容性</li><li>DESede2 112位密钥：将密钥拆成2个DES密钥，明文通过 <strong>密钥1DES加密 -&gt; 密钥2DES解密 -&gt; 密钥1DES加密</strong> 得到密文</li></ul></li><li><p>特征常量</p><ul><li><p>S-box: 8个数组</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756

-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344

520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584

8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928

256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080

536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312

2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154

268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li>`,2),m=n("p",null,"代码",-1),b={href:"https://gist.github.com/dragonwong/1af215e8ca6ef4b11af51d65432f65c4",target:"_blank",rel:"noopener noreferrer"},v=a(`<div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">des</span> <span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> message<span class="token punctuation">,</span> encrypt<span class="token punctuation">,</span> mode<span class="token punctuation">,</span> iv<span class="token punctuation">,</span> padding</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//declaring this locally speeds things up a bit</span>
    <span class="token comment">// 定义变量 S-盒初始化</span>
    <span class="token keyword">var</span> spfunction1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span> <span class="token punctuation">(</span><span class="token number">0x1010400</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x10000</span><span class="token punctuation">,</span><span class="token number">0x1010404</span><span class="token punctuation">,</span><span class="token number">0x1010004</span><span class="token punctuation">,</span><span class="token number">0x10404</span><span class="token punctuation">,</span><span class="token number">0x4</span><span class="token punctuation">,</span><span class="token number">0x10000</span><span class="token punctuation">,</span><span class="token number">0x400</span><span class="token punctuation">,</span><span class="token number">0x1010400</span><span class="token punctuation">,</span><span class="token number">0x1010404</span><span class="token punctuation">,</span><span class="token number">0x400</span><span class="token punctuation">,</span><span class="token number">0x1000404</span><span class="token punctuation">,</span><span class="token number">0x1010004</span><span class="token punctuation">,</span><span class="token number">0x1000000</span><span class="token punctuation">,</span><span class="token number">0x4</span><span class="token punctuation">,</span><span class="token number">0x404</span><span class="token punctuation">,</span><span class="token number">0x1000400</span><span class="token punctuation">,</span><span class="token number">0x1000400</span><span class="token punctuation">,</span><span class="token number">0x10400</span><span class="token punctuation">,</span><span class="token number">0x10400</span><span class="token punctuation">,</span><span class="token number">0x1010000</span><span class="token punctuation">,</span><span class="token number">0x1010000</span><span class="token punctuation">,</span><span class="token number">0x1000404</span><span class="token punctuation">,</span><span class="token number">0x10004</span><span class="token punctuation">,</span><span class="token number">0x1000004</span><span class="token punctuation">,</span><span class="token number">0x1000004</span><span class="token punctuation">,</span><span class="token number">0x10004</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x404</span><span class="token punctuation">,</span><span class="token number">0x10404</span><span class="token punctuation">,</span><span class="token number">0x1000000</span><span class="token punctuation">,</span><span class="token number">0x10000</span><span class="token punctuation">,</span><span class="token number">0x1010404</span><span class="token punctuation">,</span><span class="token number">0x4</span><span class="token punctuation">,</span><span class="token number">0x1010000</span><span class="token punctuation">,</span><span class="token number">0x1010400</span><span class="token punctuation">,</span><span class="token number">0x1000000</span><span class="token punctuation">,</span><span class="token number">0x1000000</span><span class="token punctuation">,</span><span class="token number">0x400</span><span class="token punctuation">,</span><span class="token number">0x1010004</span><span class="token punctuation">,</span><span class="token number">0x10000</span><span class="token punctuation">,</span><span class="token number">0x10400</span><span class="token punctuation">,</span><span class="token number">0x1000004</span><span class="token punctuation">,</span><span class="token number">0x400</span><span class="token punctuation">,</span><span class="token number">0x4</span><span class="token punctuation">,</span><span class="token number">0x1000404</span><span class="token punctuation">,</span><span class="token number">0x10404</span><span class="token punctuation">,</span><span class="token number">0x1010404</span><span class="token punctuation">,</span><span class="token number">0x10004</span><span class="token punctuation">,</span><span class="token number">0x1010000</span><span class="token punctuation">,</span><span class="token number">0x1000404</span><span class="token punctuation">,</span><span class="token number">0x1000004</span><span class="token punctuation">,</span><span class="token number">0x404</span><span class="token punctuation">,</span><span class="token number">0x10404</span><span class="token punctuation">,</span><span class="token number">0x1010400</span><span class="token punctuation">,</span><span class="token number">0x404</span><span class="token punctuation">,</span><span class="token number">0x1000400</span><span class="token punctuation">,</span><span class="token number">0x1000400</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x10004</span><span class="token punctuation">,</span><span class="token number">0x10400</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x1010004</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> spfunction2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0x7fef7fe0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fff8000</span><span class="token punctuation">,</span><span class="token number">0x8000</span><span class="token punctuation">,</span><span class="token number">0x108020</span><span class="token punctuation">,</span><span class="token number">0x100000</span><span class="token punctuation">,</span><span class="token number">0x20</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fefffe0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fff7fe0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fffffe0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fef7fe0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fef8000</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x80000000</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fff8000</span><span class="token punctuation">,</span><span class="token number">0x100000</span><span class="token punctuation">,</span><span class="token number">0x20</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fefffe0</span><span class="token punctuation">,</span><span class="token number">0x108000</span><span class="token punctuation">,</span><span class="token number">0x100020</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fff7fe0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x80000000</span><span class="token punctuation">,</span><span class="token number">0x8000</span><span class="token punctuation">,</span><span class="token number">0x108020</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7ff00000</span><span class="token punctuation">,</span><span class="token number">0x100020</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fffffe0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x108000</span><span class="token punctuation">,</span><span class="token number">0x8020</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fef8000</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7ff00000</span><span class="token punctuation">,</span><span class="token number">0x8020</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x108020</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fefffe0</span><span class="token punctuation">,</span><span class="token number">0x100000</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fff7fe0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7ff00000</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fef8000</span><span class="token punctuation">,</span><span class="token number">0x8000</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7ff00000</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fff8000</span><span class="token punctuation">,</span><span class="token number">0x20</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fef7fe0</span><span class="token punctuation">,</span><span class="token number">0x108020</span><span class="token punctuation">,</span><span class="token number">0x20</span><span class="token punctuation">,</span><span class="token number">0x8000</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x80000000</span><span class="token punctuation">,</span><span class="token number">0x8020</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fef8000</span><span class="token punctuation">,</span><span class="token number">0x100000</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fffffe0</span><span class="token punctuation">,</span><span class="token number">0x100020</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fff7fe0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fffffe0</span><span class="token punctuation">,</span><span class="token number">0x100020</span><span class="token punctuation">,</span><span class="token number">0x108000</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fff8000</span><span class="token punctuation">,</span><span class="token number">0x8020</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x80000000</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fefffe0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fef7fe0</span><span class="token punctuation">,</span><span class="token number">0x108000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> spfunction3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span> <span class="token punctuation">(</span><span class="token number">0x208</span><span class="token punctuation">,</span><span class="token number">0x8020200</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x8020008</span><span class="token punctuation">,</span><span class="token number">0x8000200</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x20208</span><span class="token punctuation">,</span><span class="token number">0x8000200</span><span class="token punctuation">,</span><span class="token number">0x20008</span><span class="token punctuation">,</span><span class="token number">0x8000008</span><span class="token punctuation">,</span><span class="token number">0x8000008</span><span class="token punctuation">,</span><span class="token number">0x20000</span><span class="token punctuation">,</span><span class="token number">0x8020208</span><span class="token punctuation">,</span><span class="token number">0x20008</span><span class="token punctuation">,</span><span class="token number">0x8020000</span><span class="token punctuation">,</span><span class="token number">0x208</span><span class="token punctuation">,</span><span class="token number">0x8000000</span><span class="token punctuation">,</span><span class="token number">0x8</span><span class="token punctuation">,</span><span class="token number">0x8020200</span><span class="token punctuation">,</span><span class="token number">0x200</span><span class="token punctuation">,</span><span class="token number">0x20200</span><span class="token punctuation">,</span><span class="token number">0x8020000</span><span class="token punctuation">,</span><span class="token number">0x8020008</span><span class="token punctuation">,</span><span class="token number">0x20208</span><span class="token punctuation">,</span><span class="token number">0x8000208</span><span class="token punctuation">,</span><span class="token number">0x20200</span><span class="token punctuation">,</span><span class="token number">0x20000</span><span class="token punctuation">,</span><span class="token number">0x8000208</span><span class="token punctuation">,</span><span class="token number">0x8</span><span class="token punctuation">,</span><span class="token number">0x8020208</span><span class="token punctuation">,</span><span class="token number">0x200</span><span class="token punctuation">,</span><span class="token number">0x8000000</span><span class="token punctuation">,</span><span class="token number">0x8020200</span><span class="token punctuation">,</span><span class="token number">0x8000000</span><span class="token punctuation">,</span><span class="token number">0x20008</span><span class="token punctuation">,</span><span class="token number">0x208</span><span class="token punctuation">,</span><span class="token number">0x20000</span><span class="token punctuation">,</span><span class="token number">0x8020200</span><span class="token punctuation">,</span><span class="token number">0x8000200</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x200</span><span class="token punctuation">,</span><span class="token number">0x20008</span><span class="token punctuation">,</span><span class="token number">0x8020208</span><span class="token punctuation">,</span><span class="token number">0x8000200</span><span class="token punctuation">,</span><span class="token number">0x8000008</span><span class="token punctuation">,</span><span class="token number">0x200</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x8020008</span><span class="token punctuation">,</span><span class="token number">0x8000208</span><span class="token punctuation">,</span><span class="token number">0x20000</span><span class="token punctuation">,</span><span class="token number">0x8000000</span><span class="token punctuation">,</span><span class="token number">0x8020208</span><span class="token punctuation">,</span><span class="token number">0x8</span><span class="token punctuation">,</span><span class="token number">0x20208</span><span class="token punctuation">,</span><span class="token number">0x20200</span><span class="token punctuation">,</span><span class="token number">0x8000008</span><span class="token punctuation">,</span><span class="token number">0x8020000</span><span class="token punctuation">,</span><span class="token number">0x8000208</span><span class="token punctuation">,</span><span class="token number">0x208</span><span class="token punctuation">,</span><span class="token number">0x8020000</span><span class="token punctuation">,</span><span class="token number">0x20208</span><span class="token punctuation">,</span><span class="token number">0x8</span><span class="token punctuation">,</span><span class="token number">0x8020008</span><span class="token punctuation">,</span><span class="token number">0x20200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> spfunction4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span> <span class="token punctuation">(</span><span class="token number">0x802001</span><span class="token punctuation">,</span><span class="token number">0x2081</span><span class="token punctuation">,</span><span class="token number">0x2081</span><span class="token punctuation">,</span><span class="token number">0x80</span><span class="token punctuation">,</span><span class="token number">0x802080</span><span class="token punctuation">,</span><span class="token number">0x800081</span><span class="token punctuation">,</span><span class="token number">0x800001</span><span class="token punctuation">,</span><span class="token number">0x2001</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x802000</span><span class="token punctuation">,</span><span class="token number">0x802000</span><span class="token punctuation">,</span><span class="token number">0x802081</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x800080</span><span class="token punctuation">,</span><span class="token number">0x800001</span><span class="token punctuation">,</span><span class="token number">0x1</span><span class="token punctuation">,</span><span class="token number">0x2000</span><span class="token punctuation">,</span><span class="token number">0x800000</span><span class="token punctuation">,</span><span class="token number">0x802001</span><span class="token punctuation">,</span><span class="token number">0x80</span><span class="token punctuation">,</span><span class="token number">0x800000</span><span class="token punctuation">,</span><span class="token number">0x2001</span><span class="token punctuation">,</span><span class="token number">0x2080</span><span class="token punctuation">,</span><span class="token number">0x800081</span><span class="token punctuation">,</span><span class="token number">0x1</span><span class="token punctuation">,</span><span class="token number">0x2080</span><span class="token punctuation">,</span><span class="token number">0x800080</span><span class="token punctuation">,</span><span class="token number">0x2000</span><span class="token punctuation">,</span><span class="token number">0x802080</span><span class="token punctuation">,</span><span class="token number">0x802081</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0x800080</span><span class="token punctuation">,</span><span class="token number">0x800001</span><span class="token punctuation">,</span><span class="token number">0x802000</span><span class="token punctuation">,</span><span class="token number">0x802081</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x802000</span><span class="token punctuation">,</span><span class="token number">0x2080</span><span class="token punctuation">,</span><span class="token number">0x800080</span><span class="token punctuation">,</span><span class="token number">0x800081</span><span class="token punctuation">,</span><span class="token number">0x1</span><span class="token punctuation">,</span><span class="token number">0x802001</span><span class="token punctuation">,</span><span class="token number">0x2081</span><span class="token punctuation">,</span><span class="token number">0x2081</span><span class="token punctuation">,</span><span class="token number">0x80</span><span class="token punctuation">,</span><span class="token number">0x802081</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0x1</span><span class="token punctuation">,</span><span class="token number">0x2000</span><span class="token punctuation">,</span><span class="token number">0x800001</span><span class="token punctuation">,</span><span class="token number">0x2001</span><span class="token punctuation">,</span><span class="token number">0x802080</span><span class="token punctuation">,</span><span class="token number">0x800081</span><span class="token punctuation">,</span><span class="token number">0x2001</span><span class="token punctuation">,</span><span class="token number">0x2080</span><span class="token punctuation">,</span><span class="token number">0x800000</span><span class="token punctuation">,</span><span class="token number">0x802001</span><span class="token punctuation">,</span><span class="token number">0x80</span><span class="token punctuation">,</span><span class="token number">0x800000</span><span class="token punctuation">,</span><span class="token number">0x2000</span><span class="token punctuation">,</span><span class="token number">0x802080</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> spfunction5 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span> <span class="token punctuation">(</span><span class="token number">0x100</span><span class="token punctuation">,</span><span class="token number">0x2080100</span><span class="token punctuation">,</span><span class="token number">0x2080000</span><span class="token punctuation">,</span><span class="token number">0x42000100</span><span class="token punctuation">,</span><span class="token number">0x80000</span><span class="token punctuation">,</span><span class="token number">0x100</span><span class="token punctuation">,</span><span class="token number">0x40000000</span><span class="token punctuation">,</span><span class="token number">0x2080000</span><span class="token punctuation">,</span><span class="token number">0x40080100</span><span class="token punctuation">,</span><span class="token number">0x80000</span><span class="token punctuation">,</span><span class="token number">0x2000100</span><span class="token punctuation">,</span><span class="token number">0x40080100</span><span class="token punctuation">,</span><span class="token number">0x42000100</span><span class="token punctuation">,</span><span class="token number">0x42080000</span><span class="token punctuation">,</span><span class="token number">0x80100</span><span class="token punctuation">,</span><span class="token number">0x40000000</span><span class="token punctuation">,</span><span class="token number">0x2000000</span><span class="token punctuation">,</span><span class="token number">0x40080000</span><span class="token punctuation">,</span><span class="token number">0x40080000</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x40000100</span><span class="token punctuation">,</span><span class="token number">0x42080100</span><span class="token punctuation">,</span><span class="token number">0x42080100</span><span class="token punctuation">,</span><span class="token number">0x2000100</span><span class="token punctuation">,</span><span class="token number">0x42080000</span><span class="token punctuation">,</span><span class="token number">0x40000100</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x42000000</span><span class="token punctuation">,</span><span class="token number">0x2080100</span><span class="token punctuation">,</span><span class="token number">0x2000000</span><span class="token punctuation">,</span><span class="token number">0x42000000</span><span class="token punctuation">,</span><span class="token number">0x80100</span><span class="token punctuation">,</span><span class="token number">0x80000</span><span class="token punctuation">,</span><span class="token number">0x42000100</span><span class="token punctuation">,</span><span class="token number">0x100</span><span class="token punctuation">,</span><span class="token number">0x2000000</span><span class="token punctuation">,</span><span class="token number">0x40000000</span><span class="token punctuation">,</span><span class="token number">0x2080000</span><span class="token punctuation">,</span><span class="token number">0x42000100</span><span class="token punctuation">,</span><span class="token number">0x40080100</span><span class="token punctuation">,</span><span class="token number">0x2000100</span><span class="token punctuation">,</span><span class="token number">0x40000000</span><span class="token punctuation">,</span><span class="token number">0x42080000</span><span class="token punctuation">,</span><span class="token number">0x2080100</span><span class="token punctuation">,</span><span class="token number">0x40080100</span><span class="token punctuation">,</span><span class="token number">0x100</span><span class="token punctuation">,</span><span class="token number">0x2000000</span><span class="token punctuation">,</span><span class="token number">0x42080000</span><span class="token punctuation">,</span><span class="token number">0x42080100</span><span class="token punctuation">,</span><span class="token number">0x80100</span><span class="token punctuation">,</span><span class="token number">0x42000000</span><span class="token punctuation">,</span><span class="token number">0x42080100</span><span class="token punctuation">,</span><span class="token number">0x2080000</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x40080000</span><span class="token punctuation">,</span><span class="token number">0x42000000</span><span class="token punctuation">,</span><span class="token number">0x80100</span><span class="token punctuation">,</span><span class="token number">0x2000100</span><span class="token punctuation">,</span><span class="token number">0x40000100</span><span class="token punctuation">,</span><span class="token number">0x80000</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x40080000</span><span class="token punctuation">,</span><span class="token number">0x2080100</span><span class="token punctuation">,</span><span class="token number">0x40000100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> spfunction6 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span> <span class="token punctuation">(</span><span class="token number">0x20000010</span><span class="token punctuation">,</span><span class="token number">0x20400000</span><span class="token punctuation">,</span><span class="token number">0x4000</span><span class="token punctuation">,</span><span class="token number">0x20404010</span><span class="token punctuation">,</span><span class="token number">0x20400000</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0x20404010</span><span class="token punctuation">,</span><span class="token number">0x400000</span><span class="token punctuation">,</span><span class="token number">0x20004000</span><span class="token punctuation">,</span><span class="token number">0x404010</span><span class="token punctuation">,</span><span class="token number">0x400000</span><span class="token punctuation">,</span><span class="token number">0x20000010</span><span class="token punctuation">,</span><span class="token number">0x400010</span><span class="token punctuation">,</span><span class="token number">0x20004000</span><span class="token punctuation">,</span><span class="token number">0x20000000</span><span class="token punctuation">,</span><span class="token number">0x4010</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x400010</span><span class="token punctuation">,</span><span class="token number">0x20004010</span><span class="token punctuation">,</span><span class="token number">0x4000</span><span class="token punctuation">,</span><span class="token number">0x404000</span><span class="token punctuation">,</span><span class="token number">0x20004010</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0x20400010</span><span class="token punctuation">,</span><span class="token number">0x20400010</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x404010</span><span class="token punctuation">,</span><span class="token number">0x20404000</span><span class="token punctuation">,</span><span class="token number">0x4010</span><span class="token punctuation">,</span><span class="token number">0x404000</span><span class="token punctuation">,</span><span class="token number">0x20404000</span><span class="token punctuation">,</span><span class="token number">0x20000000</span><span class="token punctuation">,</span><span class="token number">0x20004000</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0x20400010</span><span class="token punctuation">,</span><span class="token number">0x404000</span><span class="token punctuation">,</span><span class="token number">0x20404010</span><span class="token punctuation">,</span><span class="token number">0x400000</span><span class="token punctuation">,</span><span class="token number">0x4010</span><span class="token punctuation">,</span><span class="token number">0x20000010</span><span class="token punctuation">,</span><span class="token number">0x400000</span><span class="token punctuation">,</span><span class="token number">0x20004000</span><span class="token punctuation">,</span><span class="token number">0x20000000</span><span class="token punctuation">,</span><span class="token number">0x4010</span><span class="token punctuation">,</span><span class="token number">0x20000010</span><span class="token punctuation">,</span><span class="token number">0x20404010</span><span class="token punctuation">,</span><span class="token number">0x404000</span><span class="token punctuation">,</span><span class="token number">0x20400000</span><span class="token punctuation">,</span><span class="token number">0x404010</span><span class="token punctuation">,</span><span class="token number">0x20404000</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x20400010</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0x4000</span><span class="token punctuation">,</span><span class="token number">0x20400000</span><span class="token punctuation">,</span><span class="token number">0x404010</span><span class="token punctuation">,</span><span class="token number">0x4000</span><span class="token punctuation">,</span><span class="token number">0x400010</span><span class="token punctuation">,</span><span class="token number">0x20004010</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x20404000</span><span class="token punctuation">,</span><span class="token number">0x20000000</span><span class="token punctuation">,</span><span class="token number">0x400010</span><span class="token punctuation">,</span><span class="token number">0x20004010</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> spfunction7 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span> <span class="token punctuation">(</span><span class="token number">0x200000</span><span class="token punctuation">,</span><span class="token number">0x4200002</span><span class="token punctuation">,</span><span class="token number">0x4000802</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x800</span><span class="token punctuation">,</span><span class="token number">0x4000802</span><span class="token punctuation">,</span><span class="token number">0x200802</span><span class="token punctuation">,</span><span class="token number">0x4200800</span><span class="token punctuation">,</span><span class="token number">0x4200802</span><span class="token punctuation">,</span><span class="token number">0x200000</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x4000002</span><span class="token punctuation">,</span><span class="token number">0x2</span><span class="token punctuation">,</span><span class="token number">0x4000000</span><span class="token punctuation">,</span><span class="token number">0x4200002</span><span class="token punctuation">,</span><span class="token number">0x802</span><span class="token punctuation">,</span><span class="token number">0x4000800</span><span class="token punctuation">,</span><span class="token number">0x200802</span><span class="token punctuation">,</span><span class="token number">0x200002</span><span class="token punctuation">,</span><span class="token number">0x4000800</span><span class="token punctuation">,</span><span class="token number">0x4000002</span><span class="token punctuation">,</span><span class="token number">0x4200000</span><span class="token punctuation">,</span><span class="token number">0x4200800</span><span class="token punctuation">,</span><span class="token number">0x200002</span><span class="token punctuation">,</span><span class="token number">0x4200000</span><span class="token punctuation">,</span><span class="token number">0x800</span><span class="token punctuation">,</span><span class="token number">0x802</span><span class="token punctuation">,</span><span class="token number">0x4200802</span><span class="token punctuation">,</span><span class="token number">0x200800</span><span class="token punctuation">,</span><span class="token number">0x2</span><span class="token punctuation">,</span><span class="token number">0x4000000</span><span class="token punctuation">,</span><span class="token number">0x200800</span><span class="token punctuation">,</span><span class="token number">0x4000000</span><span class="token punctuation">,</span><span class="token number">0x200800</span><span class="token punctuation">,</span><span class="token number">0x200000</span><span class="token punctuation">,</span><span class="token number">0x4000802</span><span class="token punctuation">,</span><span class="token number">0x4000802</span><span class="token punctuation">,</span><span class="token number">0x4200002</span><span class="token punctuation">,</span><span class="token number">0x4200002</span><span class="token punctuation">,</span><span class="token number">0x2</span><span class="token punctuation">,</span><span class="token number">0x200002</span><span class="token punctuation">,</span><span class="token number">0x4000000</span><span class="token punctuation">,</span><span class="token number">0x4000800</span><span class="token punctuation">,</span><span class="token number">0x200000</span><span class="token punctuation">,</span><span class="token number">0x4200800</span><span class="token punctuation">,</span><span class="token number">0x802</span><span class="token punctuation">,</span><span class="token number">0x200802</span><span class="token punctuation">,</span><span class="token number">0x4200800</span><span class="token punctuation">,</span><span class="token number">0x802</span><span class="token punctuation">,</span><span class="token number">0x4000002</span><span class="token punctuation">,</span><span class="token number">0x4200802</span><span class="token punctuation">,</span><span class="token number">0x4200000</span><span class="token punctuation">,</span><span class="token number">0x200800</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x2</span><span class="token punctuation">,</span><span class="token number">0x4200802</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x200802</span><span class="token punctuation">,</span><span class="token number">0x4200000</span><span class="token punctuation">,</span><span class="token number">0x800</span><span class="token punctuation">,</span><span class="token number">0x4000002</span><span class="token punctuation">,</span><span class="token number">0x4000800</span><span class="token punctuation">,</span><span class="token number">0x800</span><span class="token punctuation">,</span><span class="token number">0x200002</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> spfunction8 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span> <span class="token punctuation">(</span><span class="token number">0x10001040</span><span class="token punctuation">,</span><span class="token number">0x1000</span><span class="token punctuation">,</span><span class="token number">0x40000</span><span class="token punctuation">,</span><span class="token number">0x10041040</span><span class="token punctuation">,</span><span class="token number">0x10000000</span><span class="token punctuation">,</span><span class="token number">0x10001040</span><span class="token punctuation">,</span><span class="token number">0x40</span><span class="token punctuation">,</span><span class="token number">0x10000000</span><span class="token punctuation">,</span><span class="token number">0x40040</span><span class="token punctuation">,</span><span class="token number">0x10040000</span><span class="token punctuation">,</span><span class="token number">0x10041040</span><span class="token punctuation">,</span><span class="token number">0x41000</span><span class="token punctuation">,</span><span class="token number">0x10041000</span><span class="token punctuation">,</span><span class="token number">0x41040</span><span class="token punctuation">,</span><span class="token number">0x1000</span><span class="token punctuation">,</span><span class="token number">0x40</span><span class="token punctuation">,</span><span class="token number">0x10040000</span><span class="token punctuation">,</span><span class="token number">0x10000040</span><span class="token punctuation">,</span><span class="token number">0x10001000</span><span class="token punctuation">,</span><span class="token number">0x1040</span><span class="token punctuation">,</span><span class="token number">0x41000</span><span class="token punctuation">,</span><span class="token number">0x40040</span><span class="token punctuation">,</span><span class="token number">0x10040040</span><span class="token punctuation">,</span><span class="token number">0x10041000</span><span class="token punctuation">,</span><span class="token number">0x1040</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x10040040</span><span class="token punctuation">,</span><span class="token number">0x10000040</span><span class="token punctuation">,</span><span class="token number">0x10001000</span><span class="token punctuation">,</span><span class="token number">0x41040</span><span class="token punctuation">,</span><span class="token number">0x40000</span><span class="token punctuation">,</span><span class="token number">0x41040</span><span class="token punctuation">,</span><span class="token number">0x40000</span><span class="token punctuation">,</span><span class="token number">0x10041000</span><span class="token punctuation">,</span><span class="token number">0x1000</span><span class="token punctuation">,</span><span class="token number">0x40</span><span class="token punctuation">,</span><span class="token number">0x10040040</span><span class="token punctuation">,</span><span class="token number">0x1000</span><span class="token punctuation">,</span><span class="token number">0x41040</span><span class="token punctuation">,</span><span class="token number">0x10001000</span><span class="token punctuation">,</span><span class="token number">0x40</span><span class="token punctuation">,</span><span class="token number">0x10000040</span><span class="token punctuation">,</span><span class="token number">0x10040000</span><span class="token punctuation">,</span><span class="token number">0x10040040</span><span class="token punctuation">,</span><span class="token number">0x10000000</span><span class="token punctuation">,</span><span class="token number">0x40000</span><span class="token punctuation">,</span><span class="token number">0x10001040</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x10041040</span><span class="token punctuation">,</span><span class="token number">0x40040</span><span class="token punctuation">,</span><span class="token number">0x10000040</span><span class="token punctuation">,</span><span class="token number">0x10040000</span><span class="token punctuation">,</span><span class="token number">0x10001000</span><span class="token punctuation">,</span><span class="token number">0x10001040</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x10041040</span><span class="token punctuation">,</span><span class="token number">0x41000</span><span class="token punctuation">,</span><span class="token number">0x41000</span><span class="token punctuation">,</span><span class="token number">0x1040</span><span class="token punctuation">,</span><span class="token number">0x1040</span><span class="token punctuation">,</span><span class="token number">0x40040</span><span class="token punctuation">,</span><span class="token number">0x10000000</span><span class="token punctuation">,</span><span class="token number">0x10041000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//create the 16 or 48 subkeys we will need</span>
    <span class="token comment">// 密钥生成</span>
    <span class="token keyword">var</span> keys <span class="token operator">=</span> <span class="token function">des_createKeys</span> <span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 用于控制加密过程中的循环和数据存储。m 是当前处理的字符索引，left 和 right 用于存储数据块的左右部分</span>
    <span class="token keyword">var</span> m<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> temp<span class="token punctuation">,</span> temp2<span class="token punctuation">,</span> right1<span class="token punctuation">,</span> right2<span class="token punctuation">,</span> left<span class="token punctuation">,</span> right<span class="token punctuation">,</span> looping<span class="token punctuation">;</span>
    <span class="token keyword">var</span> cbcleft<span class="token punctuation">,</span> cbcleft2<span class="token punctuation">,</span> cbcright<span class="token punctuation">,</span> cbcright2
    <span class="token keyword">var</span> endloop<span class="token punctuation">,</span> loopinc<span class="token punctuation">;</span>
    <span class="token keyword">var</span> len <span class="token operator">=</span> message<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">var</span> chunk <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token comment">//set up the loops for single and triple des</span>
    <span class="token comment">// 这里根据密钥的长度判断是使用单重 DES 还是三重 DES，并设置相应的循环顺序</span>
    <span class="token keyword">var</span> iterations <span class="token operator">=</span> keys<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">32</span> <span class="token operator">?</span> <span class="token number">3</span> <span class="token operator">:</span> <span class="token number">9</span><span class="token punctuation">;</span> <span class="token comment">//single or triple des</span>
    <span class="token function">f</span> <span class="token punctuation">(</span><span class="token parameter">iterations <span class="token operator">==</span> <span class="token number">3</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        looping <span class="token operator">=</span> encrypt <span class="token operator">?</span> <span class="token keyword">new</span> <span class="token class-name">Array</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Array</span> <span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        looping <span class="token operator">=</span> encrypt <span class="token operator">?</span> <span class="token keyword">new</span> <span class="token class-name">Array</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">96</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Array</span> <span class="token punctuation">(</span><span class="token number">94</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//pad the message depending on the padding parameter</span>
    <span class="token comment">// 填充消息</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>padding <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span>
        message <span class="token operator">+=</span> <span class="token string">&quot;        &quot;</span><span class="token punctuation">;</span> <span class="token comment">//pad the message with spaces</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>padding <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        temp <span class="token operator">=</span> <span class="token number">8</span><span class="token operator">-</span><span class="token punctuation">(</span>len<span class="token operator">%</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span> message <span class="token operator">+=</span> String<span class="token punctuation">.</span><span class="token function">fromCharCode</span> <span class="token punctuation">(</span>temp<span class="token punctuation">,</span>temp<span class="token punctuation">,</span>temp<span class="token punctuation">,</span>temp<span class="token punctuation">,</span>temp<span class="token punctuation">,</span>temp<span class="token punctuation">,</span>temp<span class="token punctuation">,</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>temp<span class="token operator">==</span><span class="token number">8</span><span class="token punctuation">)</span>
            len<span class="token operator">+=</span><span class="token number">8</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token comment">//PKCS7 padding 这里其实只是PKCS5 padding, PKCS5规定采用8位补全，而PKCS7则不确定位数</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>padding<span class="token punctuation">)</span>
        message <span class="token operator">+=</span> <span class="token string">&quot;\\0\\0\\0\\0\\0\\0\\0\\0&quot;</span><span class="token punctuation">;</span> <span class="token comment">//pad the message out with null bytes</span>

    <span class="token comment">//store the result here</span>
    result <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
    tempresult <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>

    <span class="token comment">// 如果选择了 CBC（Cipher Block Chaining）模式，从初始化向量（IV）中读取并构建 cbcleft 和 cbcright，用于与后续的消息块进行异或操作。</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>mode <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//CBC mode</span>
        cbcleft <span class="token operator">=</span> <span class="token punctuation">(</span>iv<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>m<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>iv<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>m<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>iv<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>m<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> iv<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>m<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cbcright <span class="token operator">=</span> <span class="token punctuation">(</span>iv<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>m<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>iv<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>m<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>iv<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>m<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> iv<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>m<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        m<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//loop through each 64 bit chunk of the message</span>
    <span class="token comment">// 循环处理每个 64 位块</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>m <span class="token operator">&lt;</span> len<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        left <span class="token operator">=</span> <span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>m<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>m<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>m<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> message<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>m<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        right <span class="token operator">=</span> <span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>m<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>m<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>m<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> message<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>m<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//for Cipher Block Chaining mode, xor the message with the previous result</span>
        <span class="token comment">// CBC 模式的异或操作</span>
        <span class="token comment">// 在 CBC 模式下，若是加密，则将当前块与前一个块进行异或；若是解密，则保存当前块以便下一轮使用。</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>mode <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>encrypt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                left <span class="token operator">^=</span> cbcleft<span class="token punctuation">;</span> right <span class="token operator">^=</span> cbcright<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                cbcleft2 <span class="token operator">=</span> cbcleft<span class="token punctuation">;</span> cbcright2 <span class="token operator">=</span> cbcright<span class="token punctuation">;</span> cbcleft <span class="token operator">=</span> left<span class="token punctuation">;</span> cbcright <span class="token operator">=</span> right<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//first each 64 but chunk of the message must be permuted according to IP</span>
        <span class="token comment">// 初始置换 对数据块进行初始置换，增加加密的复杂度</span>
        temp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>left <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">^</span> right<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x0f0f0f0f</span><span class="token punctuation">;</span> right <span class="token operator">^=</span> temp<span class="token punctuation">;</span> left <span class="token operator">^=</span> <span class="token punctuation">(</span>temp <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        temp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>left <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">^</span> right<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x0000ffff</span><span class="token punctuation">;</span> right <span class="token operator">^=</span> temp<span class="token punctuation">;</span> left <span class="token operator">^=</span> <span class="token punctuation">(</span>temp <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        temp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>right <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">^</span> left<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x33333333</span><span class="token punctuation">;</span> left <span class="token operator">^=</span> temp<span class="token punctuation">;</span> right <span class="token operator">^=</span> <span class="token punctuation">(</span>temp <span class="token operator">&lt;&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        temp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>right <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">^</span> left<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x00ff00ff</span><span class="token punctuation">;</span> left <span class="token operator">^=</span> temp<span class="token punctuation">;</span> right <span class="token operator">^=</span> <span class="token punctuation">(</span>temp <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        temp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>left <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">^</span> right<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x55555555</span><span class="token punctuation">;</span> right <span class="token operator">^=</span> temp<span class="token punctuation">;</span> left <span class="token operator">^=</span> <span class="token punctuation">(</span>temp <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        left <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>left <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>left <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        right <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>right <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>right <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//do this either 1 or 3 times for each chunk of the message</span>
        <span class="token comment">// 执行加密或解密操作。根据设定的 S-盒和子密钥，对左右数据块进行多轮变换</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span>iterations<span class="token punctuation">;</span> j<span class="token operator">+=</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            endloop <span class="token operator">=</span> looping<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            loopinc <span class="token operator">=</span> looping<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">//now go through and perform the encryption or decryption</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span>looping<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span> i<span class="token operator">!=</span>endloop<span class="token punctuation">;</span> i<span class="token operator">+=</span>loopinc<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//for efficiency</span>
                right1 <span class="token operator">=</span> right <span class="token operator">^</span> keys<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                right2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>right <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>right <span class="token operator">&lt;&lt;</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> keys<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token comment">//the result is attained by passing these bytes through the S selection functions</span>
                temp <span class="token operator">=</span> left<span class="token punctuation">;</span>
                left <span class="token operator">=</span> right<span class="token punctuation">;</span>
                right <span class="token operator">=</span> temp <span class="token operator">^</span> <span class="token punctuation">(</span>spfunction2<span class="token punctuation">[</span><span class="token punctuation">(</span>right1 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3f</span><span class="token punctuation">]</span> <span class="token operator">|</span> spfunction4<span class="token punctuation">[</span><span class="token punctuation">(</span>right1 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3f</span><span class="token punctuation">]</span>
                            <span class="token operator">|</span> spfunction6<span class="token punctuation">[</span><span class="token punctuation">(</span>right1 <span class="token operator">&gt;&gt;&gt;</span>  <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3f</span><span class="token punctuation">]</span> <span class="token operator">|</span> spfunction8<span class="token punctuation">[</span>right1 <span class="token operator">&amp;</span> <span class="token number">0x3f</span><span class="token punctuation">]</span>
                            <span class="token operator">|</span> spfunction1<span class="token punctuation">[</span><span class="token punctuation">(</span>right2 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3f</span><span class="token punctuation">]</span> <span class="token operator">|</span> spfunction3<span class="token punctuation">[</span><span class="token punctuation">(</span>right2 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3f</span><span class="token punctuation">]</span>
                            <span class="token operator">|</span> spfunction5<span class="token punctuation">[</span><span class="token punctuation">(</span>right2 <span class="token operator">&gt;&gt;&gt;</span>  <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3f</span><span class="token punctuation">]</span> <span class="token operator">|</span> spfunction7<span class="token punctuation">[</span>right2 <span class="token operator">&amp;</span> <span class="token number">0x3f</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            temp <span class="token operator">=</span> left<span class="token punctuation">;</span> left <span class="token operator">=</span> right<span class="token punctuation">;</span> right <span class="token operator">=</span> temp<span class="token punctuation">;</span> <span class="token comment">//unreverse left and right</span>
        <span class="token punctuation">}</span> <span class="token comment">//for either 1 or 3 iterations</span>

        <span class="token comment">//move then each one bit to the right</span>
        left <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>left <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>left <span class="token operator">&lt;&lt;</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        right <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>right <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>right <span class="token operator">&lt;&lt;</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//now perform IP-1, which is IP in the opposite direction</span>
        temp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>left <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">^</span> right<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x55555555</span><span class="token punctuation">;</span> right <span class="token operator">^=</span> temp<span class="token punctuation">;</span> left <span class="token operator">^=</span> <span class="token punctuation">(</span>temp <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        temp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>right <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">^</span> left<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x00ff00ff</span><span class="token punctuation">;</span> left <span class="token operator">^=</span> temp<span class="token punctuation">;</span> right <span class="token operator">^=</span> <span class="token punctuation">(</span>temp <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        temp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>right <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">^</span> left<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x33333333</span><span class="token punctuation">;</span> left <span class="token operator">^=</span> temp<span class="token punctuation">;</span> right <span class="token operator">^=</span> <span class="token punctuation">(</span>temp <span class="token operator">&lt;&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        temp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>left <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">^</span> right<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x0000ffff</span><span class="token punctuation">;</span> right <span class="token operator">^=</span> temp<span class="token punctuation">;</span> left <span class="token operator">^=</span> <span class="token punctuation">(</span>temp <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        temp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>left <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">^</span> right<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x0f0f0f0f</span><span class="token punctuation">;</span> right <span class="token operator">^=</span> temp<span class="token punctuation">;</span> left <span class="token operator">^=</span> <span class="token punctuation">(</span>temp <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//for Cipher Block Chaining mode, xor the message with the previous result</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>mode <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">if</span> <span class="token punctuation">(</span>encrypt<span class="token punctuation">)</span> <span class="token punctuation">{</span>cbcleft <span class="token operator">=</span> left<span class="token punctuation">;</span> cbcright <span class="token operator">=</span> right<span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>left <span class="token operator">^=</span> cbcleft2<span class="token punctuation">;</span> right <span class="token operator">^=</span> cbcright2<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
        tempresult <span class="token operator">+=</span> String<span class="token punctuation">.</span><span class="token function">fromCharCode</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>left<span class="token operator">&gt;&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>left<span class="token operator">&gt;&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>left<span class="token operator">&gt;&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>left <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>right<span class="token operator">&gt;&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>right<span class="token operator">&gt;&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>right<span class="token operator">&gt;&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>right <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        chunk <span class="token operator">+=</span> <span class="token number">8</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>chunk <span class="token operator">==</span> <span class="token number">512</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>result <span class="token operator">+=</span> tempresult<span class="token punctuation">;</span> tempresult <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span> chunk <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token comment">//for every 8 characters, or 64 bits in the message</span>

    <span class="token comment">//return the result as an array</span>
    <span class="token keyword">return</span> result <span class="token operator">+</span> tempresult<span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token comment">//end of des</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),x=n("h2",{id:"aes",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#aes","aria-hidden":"true"},"#"),s(" AES")],-1),y=n("blockquote",null,[n("p",null,"由于DES算法漏洞的发现及DESede的低效，诞生了AES（Advanced Encryption Standard 高级数据加密标准）算法。分组长度128位，密钥长度128位或192位或256位。"),n("p",null,"AES加密算法的实现成为了其他对称加密算法实现的参考模型，如RC2、RC4、IDEA等")],-1),f=a("<li><p>加密轮数：每个明文块，会进行指定轮数的加密</p><table><thead><tr><th>密钥位数</th><th>32位比特字</th><th>分组长度32位比特字</th><th>加密轮数</th></tr></thead><tbody><tr><td>128</td><td>4</td><td>4</td><td>10</td></tr><tr><td>192</td><td>6</td><td>4</td><td>12</td></tr><tr><td>256</td><td>8</td><td>4</td><td>14</td></tr></tbody></table></li>",1),w={href:"https://blog.csdn.net/qq_28205153/article/details/55798628",target:"_blank",rel:"noopener noreferrer"},h=a('<ul><li><p>准备工作</p><ul><li><p>128位（128/8=16字节）输入明文（在不同工作模式下，输入内容不一定是待加密原文，后续以“明文”简称）P的每一字节记做P0 P1 P2 ... P15。将明文分组按字节组成矩阵（即状态矩阵）</p><table><thead><tr><th>0x61 (P0 = a)</th><th>0x65 (P4 = e)</th><th>0x69 (P8 = i)</th><th>0x6D (P12 = m)</th></tr></thead><tbody><tr><td>0x62 (P1 = b)</td><td>0x66 (P5 = f)</td><td>0x6A (P9 = j)</td><td>0x6E (P13 = n)</td></tr><tr><td>0x63 (P2 = c)</td><td>0x67 (P6 = g)</td><td>0x6B (P10 = k)</td><td>0x6F (P14 = o)</td></tr><tr><td>0x64 (P3 = d)</td><td>0x68 (P7 = h)</td><td>0x6C (P11 = l)</td><td>0x70 (P15 = p)</td></tr></tbody></table></li><li><p>密钥K 128位可拆分16个字节，4个字。将其扩展成44个字（44 * 4 * 8=1408位）W[0] ... W[43]，其中W[0] - W[3]为原始密钥K。每4个字分为1组，共11组。第一组即原始密钥K用于初始加密，后面10组用于10轮加密运算的<strong>轮密钥加</strong></p></li><li><p>第一个明文块在开始进行第一次分组加密运算前，先对位与原始密钥进行异或（即先执行一次<strong>轮密钥加</strong>）后，将其作为分组加密的输入。即第一轮分组加密的开头处多了一次轮密钥加</p></li></ul></li><li><p>字节替代</p><ul><li><p>通过查表S盒与逆S盒进行字节代换。下表为S盒，从0-255共256个数字</p><table><thead><tr><th>行/列</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>A</th><th>B</th><th>C</th><th>D</th><th>E</th><th>F</th></tr></thead><tbody><tr><td>0</td><td>0x63</td><td>0x7c</td><td>0x77</td><td>0x7b</td><td>0xf2</td><td>0x6b</td><td>0x6f</td><td>0xc5</td><td>0x30</td><td>0x01</td><td>0x67</td><td>0x2b</td><td>0xfe</td><td>0xd7</td><td>0xab</td><td>0x76</td></tr><tr><td>1</td><td>0xca</td><td>0x82</td><td>0xc9</td><td>0x7d</td><td>0xfa</td><td>0x59</td><td>0x47</td><td>0xf0</td><td>0xad</td><td>0xd4</td><td>0xa2</td><td>0xaf</td><td>0x9c</td><td>0xa4</td><td>0x72</td><td>0xc0</td></tr><tr><td>2</td><td>0xb7</td><td>0xfd</td><td>0x93</td><td>0x26</td><td>0x36</td><td>0x3f</td><td>0xf7</td><td>0xcc</td><td>0x34</td><td>0xa5</td><td>0xe5</td><td>0xf1</td><td>0x71</td><td>0xd8</td><td>0x31</td><td>0x15</td></tr><tr><td>3</td><td>0x04</td><td>0xc7</td><td>0x23</td><td>0xc3</td><td>0x18</td><td>0x96</td><td>0x05</td><td>0x9a</td><td>0x07</td><td>0x12</td><td>0x80</td><td>0xe2</td><td>0xeb</td><td>0x27</td><td>0xb2</td><td>0x75</td></tr><tr><td>4</td><td>0x09</td><td>0x83</td><td>0x2c</td><td>0x1a</td><td>0x1b</td><td>0x6e</td><td>0x5a</td><td>0xa0</td><td>0x52</td><td>0x3b</td><td>0xd6</td><td>0xb3</td><td>0x29</td><td>0xe3</td><td>0x2f</td><td>0x84</td></tr><tr><td>5</td><td>0x53</td><td>0xd1</td><td>0x00</td><td>0xed</td><td>0x20</td><td>0xfc</td><td>0xb1</td><td>0x5b</td><td>0x6a</td><td>0xcb</td><td>0xbe</td><td>0x39</td><td>0x4a</td><td>0x4c</td><td>0x58</td><td>0xcf</td></tr><tr><td>6</td><td>0xd0</td><td>0xef</td><td>0xaa</td><td>0xfb</td><td>0x43</td><td>0x4d</td><td>0x33</td><td>0x85</td><td>0x45</td><td>0xf9</td><td>0x02</td><td>0x7f</td><td>0x50</td><td>0x3c</td><td>0x9f</td><td>0xa8</td></tr><tr><td>7</td><td>0x51</td><td>0xa3</td><td>0x40</td><td>0x8f</td><td>0x92</td><td>0x9d</td><td>0x38</td><td>0xf5</td><td>0xbc</td><td>0xb6</td><td>0xda</td><td>0x21</td><td>0x10</td><td>0xff</td><td>0xf3</td><td>0xd2</td></tr><tr><td>8</td><td>0xcd</td><td>0x0c</td><td>0x13</td><td>0xec</td><td>0x5f</td><td>0x97</td><td>0x44</td><td>0x17</td><td>0xc4</td><td>0xa7</td><td>0x7e</td><td>0x3d</td><td>0x64</td><td>0x5d</td><td>0x19</td><td>0x73</td></tr><tr><td>9</td><td>0x60</td><td>0x81</td><td>0x4f</td><td>0xdc</td><td>0x22</td><td>0x2a</td><td>0x90</td><td>0x88</td><td>0x46</td><td>0xee</td><td>0xb8</td><td>0x14</td><td>0xde</td><td>0x5e</td><td>0x0b</td><td>0xdb</td></tr><tr><td>A</td><td>0xe0</td><td>0x32</td><td>0x3a</td><td>0x0a</td><td>0x49</td><td>0x06</td><td>0x24</td><td>0x5c</td><td>0xc2</td><td>0xd3</td><td>0xac</td><td>0x62</td><td>0x91</td><td>0x95</td><td>0xe4</td><td>0x79</td></tr><tr><td>B</td><td>0xe7</td><td>0xc8</td><td>0x37</td><td>0x6d</td><td>0x8d</td><td>0xd5</td><td>0x4e</td><td>0xa9</td><td>0x6c</td><td>0x56</td><td>0xf4</td><td>0xea</td><td>0x65</td><td>0x7a</td><td>0xae</td><td>0x08</td></tr><tr><td>C</td><td>0xba</td><td>0x78</td><td>0x25</td><td>0x2e</td><td>0x1c</td><td>0xa6</td><td>0xb4</td><td>0xc6</td><td>0xe8</td><td>0xdd</td><td>0x74</td><td>0x1f</td><td>0x4b</td><td>0xbd</td><td>0x8b</td><td>0x8a</td></tr><tr><td>D</td><td>0x70</td><td>0x3e</td><td>0xb5</td><td>0x66</td><td>0x48</td><td>0x03</td><td>0xf6</td><td>0x0e</td><td>0x61</td><td>0x35</td><td>0x57</td><td>0xb9</td><td>0x86</td><td>0xc1</td><td>0x1d</td><td>0x9e</td></tr><tr><td>E</td><td>0xe1</td><td>0xf8</td><td>0x98</td><td>0x11</td><td>0x69</td><td>0xd9</td><td>0x8e</td><td>0x94</td><td>0x9b</td><td>0x1e</td><td>0x87</td><td>0xe9</td><td>0xce</td><td>0x55</td><td>0x28</td><td>0xdf</td></tr><tr><td>F</td><td>0x8c</td><td>0xa1</td><td>0x89</td><td>0x0d</td><td>0xbf</td><td>0xe6</td><td>0x42</td><td>0x68</td><td>0x41</td><td>0x99</td><td>0x2d</td><td>0x0f</td><td>0xb0</td><td>0x54</td><td>0xbb</td><td>0x16</td></tr></tbody></table></li><li><p>高4位作为行值，低4位作为列值，取出S盒或者逆S盒中对应的行的元素作为输出。例如，加密时，待操作字节为0x12,则查S盒的第0x01行和0x02列，得到值0xc9</p></li></ul></li><li><p>行位移：按行号左移指定字节，即第0行左移0字节，第1行左移1字节，第2行左移2字节，第3行左移3字节。逆运算则进行右移</p><table><thead><tr><th>S0</th><th>S4</th><th>S8</th><th>S12</th><th>不位移</th><th>S0</th><th>S4</th><th>S8</th><th>S12</th></tr></thead><tbody><tr><td>S1</td><td>S5</td><td>S9</td><td>S13</td><td>左移1</td><td>S5</td><td>S9</td><td>S13</td><td>S1</td></tr><tr><td>S2</td><td>S6</td><td>S10</td><td>S14</td><td>左移2</td><td>S10</td><td>S14</td><td>S2</td><td>S6</td></tr><tr><td>S3</td><td>S7</td><td>S11</td><td>S15</td><td>左移3</td><td>S15</td><td>S3</td><td>S7</td><td>S11</td></tr></tbody></table></li><li><p>列混淆：</p><ul><li><p>使用矩阵乘法（对应行与对应列的数字对应相乘后求和）进行运算</p><h1 id="left-begin-matrix-s-0-0-s-0-1-s-0-2-s-0-3-s-1-0-s-1-1-s-1-2-s-1-3-s-2-0-s-2-1-s-2-2-s-2-3-s-3-0-s-3-1-s-3-2-s-3-3-end-matrix-right" tabindex="-1"><a class="header-anchor" href="#left-begin-matrix-s-0-0-s-0-1-s-0-2-s-0-3-s-1-0-s-1-1-s-1-2-s-1-3-s-2-0-s-2-1-s-2-2-s-2-3-s-3-0-s-3-1-s-3-2-s-3-3-end-matrix-right" aria-hidden="true">#</a> $$ \\left[ \\begin{matrix} S&#39;<em>{0,0} &amp; S&#39;</em>{0,1} &amp; S&#39;<em>{0,2} &amp; S&#39;</em>{0,3}\\ S&#39;<em>{1,0} &amp; S&#39;</em>{1,1} &amp; S&#39;<em>{1,2} &amp; S&#39;</em>{1,3}\\ S&#39;<em>{2,0} &amp; S&#39;</em>{2,1} &amp; S&#39;<em>{2,2} &amp; S&#39;</em>{2,3}\\ S&#39;<em>{3,0} &amp; S&#39;</em>{3,1} &amp; S&#39;<em>{3,2} &amp; S&#39;</em>{3,3} \\end{matrix} \\right]</h1><p>\\left[ \\begin{matrix} 2 &amp; 3 &amp; 1 &amp; 1\\ 1 &amp; 2 &amp; 3 &amp; 1\\ 1 &amp; 1 &amp; 2 &amp; 3\\ 3 &amp; 1 &amp; 1 &amp; 2 \\end{matrix} \\right]</p><p>\\left[ \\begin{matrix} S_{0,0} &amp; S_{0,1} &amp; S_{0,2} &amp; S_{0,3}\\ S_{1,0} &amp; S_{1,1} &amp; S_{1,2} &amp; S_{1,3}\\ S_{2,0} &amp; S_{2,1} &amp; S_{2,2} &amp; S_{2,3}\\ S_{3,0} &amp; S_{3,1} &amp; S_{3,2} &amp; S_{3,3} \\end{matrix} \\right] $$</p></li><li><p>在计算时，加法用异或表示。乘2（0000 0010）即左移一位，低位补0。如果有溢出（即左移后丢失的高位为1），则将移位后结果在加上（异或）0001 1011为最终乘02的结果。乘03表示为乘02+本身，即乘02的结果再与本身异或，03 * A = 02 * A + A = (02 * A) $ \\oplus $ A</p></li><li><p>解密时逆混合矩阵，即正混合矩阵与逆混合矩阵相乘为单位矩阵 $$ \\left[ \\begin{matrix} S&#39;<em>{0,0} &amp; S&#39;</em>{0,1} &amp; S&#39;<em>{0,2} &amp; S&#39;</em>{0,3}\\ S&#39;<em>{1,0} &amp; S&#39;</em>{1,1} &amp; S&#39;<em>{1,2} &amp; S&#39;</em>{1,3}\\ S&#39;<em>{2,0} &amp; S&#39;</em>{2,1} &amp; S&#39;<em>{2,2} &amp; S&#39;</em>{2,3}\\ S&#39;<em>{3,0} &amp; S&#39;</em>{3,1} &amp; S&#39;<em>{3,2} &amp; S&#39;</em>{3,3} \\end{matrix} \\right] = \\left[ \\begin{matrix} 0x0E &amp; 0x0B &amp; 0x0D &amp; 0x09\\ 0x09 &amp; 0x0E &amp; 0x0B &amp; 0x0D\\ 0x0D &amp; 0x09 &amp; 0x0E &amp; 0x0B\\ 0x0B &amp; 0x0D &amp; 0x09 &amp; 0x0E \\end{matrix} \\right] \\left[ \\begin{matrix} S_{0,0} &amp; S_{0,1} &amp; S_{0,2} &amp; S_{0,3}\\ S_{1,0} &amp; S_{1,1} &amp; S_{1,2} &amp; S_{1,3}\\ S_{2,0} &amp; S_{2,1} &amp; S_{2,2} &amp; S_{2,3}\\ S_{3,0} &amp; S_{3,1} &amp; S_{3,2} &amp; S_{3,3} \\end{matrix} \\right] $$</p></li></ul></li><li><p>轮密钥加：将待处理的输入矩阵（16*8=128位）的每一位与该轮次密钥（128位）相加（异或）后，得到输出矩阵，即该轮运算的加密结果。如：第一轮结果与W[4]-W[7]异或</p></li></ul>',1),g=a(`<li><p>特征: 出现长度256数组，可能是S盒，可能是与S盒计算后的数组</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>// S-box 的直接输出 - 256
[
    99,124,119,123,242,107,111,197,48,1,103,43,99,215,171,118,
    202,130,201,125,250,89,71,240,173,212,162,175,254,164,114,192,
    183,253,147,38,54,63,247,204,52,165,229,241,173,216,49,21,
    4,199,35,195,24,150,5,154,7,18,128,226,54,39,178,117,
    9,131,44,26,27,110,90,160,82,59,214,179,4,227,47,132,
    83,209,0,237,32,252,177,91,106,203,190,57,235,76,88,207,
    208,239,170,251,67,77,51,133,69,249,2,127,82,60,159,168,
    81,163,64,143,146,157,56,245,188,182,218,33,32,255,243,210,
    205,12,19,236,95,151,68,23,196,167,126,61,208,93,25,115,
    96,129,79,220,34,42,144,136,70,238,184,20,80,94,11,219,
    224,50,58,10,73,6,36,92,194,211,172,98,188,149,228,121,
    231,200,55,109,141,213,78,169,108,86,244,234,95,122,174,8,
    186,120,37,46,28,166,180,198,232,221,116,31,96,189,139,138,
    112,62,181,102,72,3,246,14,97,53,87,185,222,193,29,158,
    225,248,152,17,105,217,142,148,155,30,135,233,194,85,40,223,
    140,161,137,13,191,230,66,104,65,153,45,15,141,84,187,22
]
// S-box每4个拼接一个字的输出 64
[1669101435,4067127237,805398315,4275546998,3397568893,4200155120,2916393647,2628022976,3086848806,910161868,883287537,1909993749,80159683,412485018,118653154,3945247349,159591450,460216992,1379653299,702754692,1406206189,553431387,1791737401,1246517455,3505367803,1129132933,1173947007,1346150312,1369653391,2459777269,3166100001,285209554,3440120812,1603748887,3299311165,1683822963,1619087324,573214856,1190049812,3730705371,3761388042,1225139292,3268652130,2442519673,3888658285,2379566761,1817638122,1702538760,3128436014,480687302,3906827295,1270713226,1883157862,1208219150,1630885817,2260802974,3791165457,1775865492,2602469353,3461687519,2359396621,3219538536,1100557583,2958342934]

// 逆S盒
[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p><strong>ecb模式</strong> 待加密前16位字节转成4个大端的int32，用于与密钥W[0]-W[3]的4个int32进行异或</p></li><li><p><strong>cbc模式</strong> 待加密前16位字节跟iv进行异或，再转转成4个大端的int32，与密钥W[0]-W[3]的4个int32进行异或</p></li></ul></li>`,1),S=n("p",null,"代码",-1),A={href:"https://blog.csdn.net/qq_28205153/article/details/55798628",target:"_blank",rel:"noopener noreferrer"},C=a(`<div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;aes.h&quot;</span></span>

<span class="token comment">/**
* S盒
*/</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">int</span> S<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0x63</span><span class="token punctuation">,</span> <span class="token number">0x7c</span><span class="token punctuation">,</span> <span class="token number">0x77</span><span class="token punctuation">,</span> <span class="token number">0x7b</span><span class="token punctuation">,</span> <span class="token number">0xf2</span><span class="token punctuation">,</span> <span class="token number">0x6b</span><span class="token punctuation">,</span> <span class="token number">0x6f</span><span class="token punctuation">,</span> <span class="token number">0xc5</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x67</span><span class="token punctuation">,</span> <span class="token number">0x2b</span><span class="token punctuation">,</span> <span class="token number">0xfe</span><span class="token punctuation">,</span> <span class="token number">0xd7</span><span class="token punctuation">,</span> <span class="token number">0xab</span><span class="token punctuation">,</span> <span class="token number">0x76</span><span class="token punctuation">,</span>
    <span class="token number">0xca</span><span class="token punctuation">,</span> <span class="token number">0x82</span><span class="token punctuation">,</span> <span class="token number">0xc9</span><span class="token punctuation">,</span> <span class="token number">0x7d</span><span class="token punctuation">,</span> <span class="token number">0xfa</span><span class="token punctuation">,</span> <span class="token number">0x59</span><span class="token punctuation">,</span> <span class="token number">0x47</span><span class="token punctuation">,</span> <span class="token number">0xf0</span><span class="token punctuation">,</span> <span class="token number">0xad</span><span class="token punctuation">,</span> <span class="token number">0xd4</span><span class="token punctuation">,</span> <span class="token number">0xa2</span><span class="token punctuation">,</span> <span class="token number">0xaf</span><span class="token punctuation">,</span> <span class="token number">0x9c</span><span class="token punctuation">,</span> <span class="token number">0xa4</span><span class="token punctuation">,</span> <span class="token number">0x72</span><span class="token punctuation">,</span> <span class="token number">0xc0</span><span class="token punctuation">,</span>
    <span class="token number">0xb7</span><span class="token punctuation">,</span> <span class="token number">0xfd</span><span class="token punctuation">,</span> <span class="token number">0x93</span><span class="token punctuation">,</span> <span class="token number">0x26</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0x3f</span><span class="token punctuation">,</span> <span class="token number">0xf7</span><span class="token punctuation">,</span> <span class="token number">0xcc</span><span class="token punctuation">,</span> <span class="token number">0x34</span><span class="token punctuation">,</span> <span class="token number">0xa5</span><span class="token punctuation">,</span> <span class="token number">0xe5</span><span class="token punctuation">,</span> <span class="token number">0xf1</span><span class="token punctuation">,</span> <span class="token number">0x71</span><span class="token punctuation">,</span> <span class="token number">0xd8</span><span class="token punctuation">,</span> <span class="token number">0x31</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">,</span>
    <span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token number">0xc7</span><span class="token punctuation">,</span> <span class="token number">0x23</span><span class="token punctuation">,</span> <span class="token number">0xc3</span><span class="token punctuation">,</span> <span class="token number">0x18</span><span class="token punctuation">,</span> <span class="token number">0x96</span><span class="token punctuation">,</span> <span class="token number">0x05</span><span class="token punctuation">,</span> <span class="token number">0x9a</span><span class="token punctuation">,</span> <span class="token number">0x07</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0xe2</span><span class="token punctuation">,</span> <span class="token number">0xeb</span><span class="token punctuation">,</span> <span class="token number">0x27</span><span class="token punctuation">,</span> <span class="token number">0xb2</span><span class="token punctuation">,</span> <span class="token number">0x75</span><span class="token punctuation">,</span>
    <span class="token number">0x09</span><span class="token punctuation">,</span> <span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0x2c</span><span class="token punctuation">,</span> <span class="token number">0x1a</span><span class="token punctuation">,</span> <span class="token number">0x1b</span><span class="token punctuation">,</span> <span class="token number">0x6e</span><span class="token punctuation">,</span> <span class="token number">0x5a</span><span class="token punctuation">,</span> <span class="token number">0xa0</span><span class="token punctuation">,</span> <span class="token number">0x52</span><span class="token punctuation">,</span> <span class="token number">0x3b</span><span class="token punctuation">,</span> <span class="token number">0xd6</span><span class="token punctuation">,</span> <span class="token number">0xb3</span><span class="token punctuation">,</span> <span class="token number">0x29</span><span class="token punctuation">,</span> <span class="token number">0xe3</span><span class="token punctuation">,</span> <span class="token number">0x2f</span><span class="token punctuation">,</span> <span class="token number">0x84</span><span class="token punctuation">,</span>
    <span class="token number">0x53</span><span class="token punctuation">,</span> <span class="token number">0xd1</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0xed</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0xfc</span><span class="token punctuation">,</span> <span class="token number">0xb1</span><span class="token punctuation">,</span> <span class="token number">0x5b</span><span class="token punctuation">,</span> <span class="token number">0x6a</span><span class="token punctuation">,</span> <span class="token number">0xcb</span><span class="token punctuation">,</span> <span class="token number">0xbe</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">,</span> <span class="token number">0x4a</span><span class="token punctuation">,</span> <span class="token number">0x4c</span><span class="token punctuation">,</span> <span class="token number">0x58</span><span class="token punctuation">,</span> <span class="token number">0xcf</span><span class="token punctuation">,</span>
    <span class="token number">0xd0</span><span class="token punctuation">,</span> <span class="token number">0xef</span><span class="token punctuation">,</span> <span class="token number">0xaa</span><span class="token punctuation">,</span> <span class="token number">0xfb</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0x4d</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x85</span><span class="token punctuation">,</span> <span class="token number">0x45</span><span class="token punctuation">,</span> <span class="token number">0xf9</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0x7f</span><span class="token punctuation">,</span> <span class="token number">0x50</span><span class="token punctuation">,</span> <span class="token number">0x3c</span><span class="token punctuation">,</span> <span class="token number">0x9f</span><span class="token punctuation">,</span> <span class="token number">0xa8</span><span class="token punctuation">,</span>
    <span class="token number">0x51</span><span class="token punctuation">,</span> <span class="token number">0xa3</span><span class="token punctuation">,</span> <span class="token number">0x40</span><span class="token punctuation">,</span> <span class="token number">0x8f</span><span class="token punctuation">,</span> <span class="token number">0x92</span><span class="token punctuation">,</span> <span class="token number">0x9d</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">0xf5</span><span class="token punctuation">,</span> <span class="token number">0xbc</span><span class="token punctuation">,</span> <span class="token number">0xb6</span><span class="token punctuation">,</span> <span class="token number">0xda</span><span class="token punctuation">,</span> <span class="token number">0x21</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0xff</span><span class="token punctuation">,</span> <span class="token number">0xf3</span><span class="token punctuation">,</span> <span class="token number">0xd2</span><span class="token punctuation">,</span>
    <span class="token number">0xcd</span><span class="token punctuation">,</span> <span class="token number">0x0c</span><span class="token punctuation">,</span> <span class="token number">0x13</span><span class="token punctuation">,</span> <span class="token number">0xec</span><span class="token punctuation">,</span> <span class="token number">0x5f</span><span class="token punctuation">,</span> <span class="token number">0x97</span><span class="token punctuation">,</span> <span class="token number">0x44</span><span class="token punctuation">,</span> <span class="token number">0x17</span><span class="token punctuation">,</span> <span class="token number">0xc4</span><span class="token punctuation">,</span> <span class="token number">0xa7</span><span class="token punctuation">,</span> <span class="token number">0x7e</span><span class="token punctuation">,</span> <span class="token number">0x3d</span><span class="token punctuation">,</span> <span class="token number">0x64</span><span class="token punctuation">,</span> <span class="token number">0x5d</span><span class="token punctuation">,</span> <span class="token number">0x19</span><span class="token punctuation">,</span> <span class="token number">0x73</span><span class="token punctuation">,</span>
    <span class="token number">0x60</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0x4f</span><span class="token punctuation">,</span> <span class="token number">0xdc</span><span class="token punctuation">,</span> <span class="token number">0x22</span><span class="token punctuation">,</span> <span class="token number">0x2a</span><span class="token punctuation">,</span> <span class="token number">0x90</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0x46</span><span class="token punctuation">,</span> <span class="token number">0xee</span><span class="token punctuation">,</span> <span class="token number">0xb8</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">,</span> <span class="token number">0xde</span><span class="token punctuation">,</span> <span class="token number">0x5e</span><span class="token punctuation">,</span> <span class="token number">0x0b</span><span class="token punctuation">,</span> <span class="token number">0xdb</span><span class="token punctuation">,</span>
    <span class="token number">0xe0</span><span class="token punctuation">,</span> <span class="token number">0x32</span><span class="token punctuation">,</span> <span class="token number">0x3a</span><span class="token punctuation">,</span> <span class="token number">0x0a</span><span class="token punctuation">,</span> <span class="token number">0x49</span><span class="token punctuation">,</span> <span class="token number">0x06</span><span class="token punctuation">,</span> <span class="token number">0x24</span><span class="token punctuation">,</span> <span class="token number">0x5c</span><span class="token punctuation">,</span> <span class="token number">0xc2</span><span class="token punctuation">,</span> <span class="token number">0xd3</span><span class="token punctuation">,</span> <span class="token number">0xac</span><span class="token punctuation">,</span> <span class="token number">0x62</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0x95</span><span class="token punctuation">,</span> <span class="token number">0xe4</span><span class="token punctuation">,</span> <span class="token number">0x79</span><span class="token punctuation">,</span>
    <span class="token number">0xe7</span><span class="token punctuation">,</span> <span class="token number">0xc8</span><span class="token punctuation">,</span> <span class="token number">0x37</span><span class="token punctuation">,</span> <span class="token number">0x6d</span><span class="token punctuation">,</span> <span class="token number">0x8d</span><span class="token punctuation">,</span> <span class="token number">0xd5</span><span class="token punctuation">,</span> <span class="token number">0x4e</span><span class="token punctuation">,</span> <span class="token number">0xa9</span><span class="token punctuation">,</span> <span class="token number">0x6c</span><span class="token punctuation">,</span> <span class="token number">0x56</span><span class="token punctuation">,</span> <span class="token number">0xf4</span><span class="token punctuation">,</span> <span class="token number">0xea</span><span class="token punctuation">,</span> <span class="token number">0x65</span><span class="token punctuation">,</span> <span class="token number">0x7a</span><span class="token punctuation">,</span> <span class="token number">0xae</span><span class="token punctuation">,</span> <span class="token number">0x08</span><span class="token punctuation">,</span>
    <span class="token number">0xba</span><span class="token punctuation">,</span> <span class="token number">0x78</span><span class="token punctuation">,</span> <span class="token number">0x25</span><span class="token punctuation">,</span> <span class="token number">0x2e</span><span class="token punctuation">,</span> <span class="token number">0x1c</span><span class="token punctuation">,</span> <span class="token number">0xa6</span><span class="token punctuation">,</span> <span class="token number">0xb4</span><span class="token punctuation">,</span> <span class="token number">0xc6</span><span class="token punctuation">,</span> <span class="token number">0xe8</span><span class="token punctuation">,</span> <span class="token number">0xdd</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0x1f</span><span class="token punctuation">,</span> <span class="token number">0x4b</span><span class="token punctuation">,</span> <span class="token number">0xbd</span><span class="token punctuation">,</span> <span class="token number">0x8b</span><span class="token punctuation">,</span> <span class="token number">0x8a</span><span class="token punctuation">,</span>
    <span class="token number">0x70</span><span class="token punctuation">,</span> <span class="token number">0x3e</span><span class="token punctuation">,</span> <span class="token number">0xb5</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0x48</span><span class="token punctuation">,</span> <span class="token number">0x03</span><span class="token punctuation">,</span> <span class="token number">0xf6</span><span class="token punctuation">,</span> <span class="token number">0x0e</span><span class="token punctuation">,</span> <span class="token number">0x61</span><span class="token punctuation">,</span> <span class="token number">0x35</span><span class="token punctuation">,</span> <span class="token number">0x57</span><span class="token punctuation">,</span> <span class="token number">0xb9</span><span class="token punctuation">,</span> <span class="token number">0x86</span><span class="token punctuation">,</span> <span class="token number">0xc1</span><span class="token punctuation">,</span> <span class="token number">0x1d</span><span class="token punctuation">,</span> <span class="token number">0x9e</span><span class="token punctuation">,</span>
    <span class="token number">0xe1</span><span class="token punctuation">,</span> <span class="token number">0xf8</span><span class="token punctuation">,</span> <span class="token number">0x98</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0x69</span><span class="token punctuation">,</span> <span class="token number">0xd9</span><span class="token punctuation">,</span> <span class="token number">0x8e</span><span class="token punctuation">,</span> <span class="token number">0x94</span><span class="token punctuation">,</span> <span class="token number">0x9b</span><span class="token punctuation">,</span> <span class="token number">0x1e</span><span class="token punctuation">,</span> <span class="token number">0x87</span><span class="token punctuation">,</span> <span class="token number">0xe9</span><span class="token punctuation">,</span> <span class="token number">0xce</span><span class="token punctuation">,</span> <span class="token number">0x55</span><span class="token punctuation">,</span> <span class="token number">0x28</span><span class="token punctuation">,</span> <span class="token number">0xdf</span><span class="token punctuation">,</span>
    <span class="token number">0x8c</span><span class="token punctuation">,</span> <span class="token number">0xa1</span><span class="token punctuation">,</span> <span class="token number">0x89</span><span class="token punctuation">,</span> <span class="token number">0x0d</span><span class="token punctuation">,</span> <span class="token number">0xbf</span><span class="token punctuation">,</span> <span class="token number">0xe6</span><span class="token punctuation">,</span> <span class="token number">0x42</span><span class="token punctuation">,</span> <span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token number">0x41</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0x2d</span><span class="token punctuation">,</span> <span class="token number">0x0f</span><span class="token punctuation">,</span> <span class="token number">0xb0</span><span class="token punctuation">,</span> <span class="token number">0x54</span><span class="token punctuation">,</span> <span class="token number">0xbb</span><span class="token punctuation">,</span> <span class="token number">0x16</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">/**
* 逆S盒
*/</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">int</span> S2<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0x52</span><span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">,</span> <span class="token number">0x6a</span><span class="token punctuation">,</span> <span class="token number">0xd5</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0xa5</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">0xbf</span><span class="token punctuation">,</span> <span class="token number">0x40</span><span class="token punctuation">,</span> <span class="token number">0xa3</span><span class="token punctuation">,</span> <span class="token number">0x9e</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0xf3</span><span class="token punctuation">,</span> <span class="token number">0xd7</span><span class="token punctuation">,</span> <span class="token number">0xfb</span><span class="token punctuation">,</span>
    <span class="token number">0x7c</span><span class="token punctuation">,</span> <span class="token number">0xe3</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">,</span> <span class="token number">0x82</span><span class="token punctuation">,</span> <span class="token number">0x9b</span><span class="token punctuation">,</span> <span class="token number">0x2f</span><span class="token punctuation">,</span> <span class="token number">0xff</span><span class="token punctuation">,</span> <span class="token number">0x87</span><span class="token punctuation">,</span> <span class="token number">0x34</span><span class="token punctuation">,</span> <span class="token number">0x8e</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0x44</span><span class="token punctuation">,</span> <span class="token number">0xc4</span><span class="token punctuation">,</span> <span class="token number">0xde</span><span class="token punctuation">,</span> <span class="token number">0xe9</span><span class="token punctuation">,</span> <span class="token number">0xcb</span><span class="token punctuation">,</span>
    <span class="token number">0x54</span><span class="token punctuation">,</span> <span class="token number">0x7b</span><span class="token punctuation">,</span> <span class="token number">0x94</span><span class="token punctuation">,</span> <span class="token number">0x32</span><span class="token punctuation">,</span> <span class="token number">0xa6</span><span class="token punctuation">,</span> <span class="token number">0xc2</span><span class="token punctuation">,</span> <span class="token number">0x23</span><span class="token punctuation">,</span> <span class="token number">0x3d</span><span class="token punctuation">,</span> <span class="token number">0xee</span><span class="token punctuation">,</span> <span class="token number">0x4c</span><span class="token punctuation">,</span> <span class="token number">0x95</span><span class="token punctuation">,</span> <span class="token number">0x0b</span><span class="token punctuation">,</span> <span class="token number">0x42</span><span class="token punctuation">,</span> <span class="token number">0xfa</span><span class="token punctuation">,</span> <span class="token number">0xc3</span><span class="token punctuation">,</span> <span class="token number">0x4e</span><span class="token punctuation">,</span>
    <span class="token number">0x08</span><span class="token punctuation">,</span> <span class="token number">0x2e</span><span class="token punctuation">,</span> <span class="token number">0xa1</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0x28</span><span class="token punctuation">,</span> <span class="token number">0xd9</span><span class="token punctuation">,</span> <span class="token number">0x24</span><span class="token punctuation">,</span> <span class="token number">0xb2</span><span class="token punctuation">,</span> <span class="token number">0x76</span><span class="token punctuation">,</span> <span class="token number">0x5b</span><span class="token punctuation">,</span> <span class="token number">0xa2</span><span class="token punctuation">,</span> <span class="token number">0x49</span><span class="token punctuation">,</span> <span class="token number">0x6d</span><span class="token punctuation">,</span> <span class="token number">0x8b</span><span class="token punctuation">,</span> <span class="token number">0xd1</span><span class="token punctuation">,</span> <span class="token number">0x25</span><span class="token punctuation">,</span>
    <span class="token number">0x72</span><span class="token punctuation">,</span> <span class="token number">0xf8</span><span class="token punctuation">,</span> <span class="token number">0xf6</span><span class="token punctuation">,</span> <span class="token number">0x64</span><span class="token punctuation">,</span> <span class="token number">0x86</span><span class="token punctuation">,</span> <span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token number">0x98</span><span class="token punctuation">,</span> <span class="token number">0x16</span><span class="token punctuation">,</span> <span class="token number">0xd4</span><span class="token punctuation">,</span> <span class="token number">0xa4</span><span class="token punctuation">,</span> <span class="token number">0x5c</span><span class="token punctuation">,</span> <span class="token number">0xcc</span><span class="token punctuation">,</span> <span class="token number">0x5d</span><span class="token punctuation">,</span> <span class="token number">0x65</span><span class="token punctuation">,</span> <span class="token number">0xb6</span><span class="token punctuation">,</span> <span class="token number">0x92</span><span class="token punctuation">,</span>
    <span class="token number">0x6c</span><span class="token punctuation">,</span> <span class="token number">0x70</span><span class="token punctuation">,</span> <span class="token number">0x48</span><span class="token punctuation">,</span> <span class="token number">0x50</span><span class="token punctuation">,</span> <span class="token number">0xfd</span><span class="token punctuation">,</span> <span class="token number">0xed</span><span class="token punctuation">,</span> <span class="token number">0xb9</span><span class="token punctuation">,</span> <span class="token number">0xda</span><span class="token punctuation">,</span> <span class="token number">0x5e</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">,</span> <span class="token number">0x46</span><span class="token punctuation">,</span> <span class="token number">0x57</span><span class="token punctuation">,</span> <span class="token number">0xa7</span><span class="token punctuation">,</span> <span class="token number">0x8d</span><span class="token punctuation">,</span> <span class="token number">0x9d</span><span class="token punctuation">,</span> <span class="token number">0x84</span><span class="token punctuation">,</span>
    <span class="token number">0x90</span><span class="token punctuation">,</span> <span class="token number">0xd8</span><span class="token punctuation">,</span> <span class="token number">0xab</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x8c</span><span class="token punctuation">,</span> <span class="token number">0xbc</span><span class="token punctuation">,</span> <span class="token number">0xd3</span><span class="token punctuation">,</span> <span class="token number">0x0a</span><span class="token punctuation">,</span> <span class="token number">0xf7</span><span class="token punctuation">,</span> <span class="token number">0xe4</span><span class="token punctuation">,</span> <span class="token number">0x58</span><span class="token punctuation">,</span> <span class="token number">0x05</span><span class="token punctuation">,</span> <span class="token number">0xb8</span><span class="token punctuation">,</span> <span class="token number">0xb3</span><span class="token punctuation">,</span> <span class="token number">0x45</span><span class="token punctuation">,</span> <span class="token number">0x06</span><span class="token punctuation">,</span>
    <span class="token number">0xd0</span><span class="token punctuation">,</span> <span class="token number">0x2c</span><span class="token punctuation">,</span> <span class="token number">0x1e</span><span class="token punctuation">,</span> <span class="token number">0x8f</span><span class="token punctuation">,</span> <span class="token number">0xca</span><span class="token punctuation">,</span> <span class="token number">0x3f</span><span class="token punctuation">,</span> <span class="token number">0x0f</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0xc1</span><span class="token punctuation">,</span> <span class="token number">0xaf</span><span class="token punctuation">,</span> <span class="token number">0xbd</span><span class="token punctuation">,</span> <span class="token number">0x03</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x13</span><span class="token punctuation">,</span> <span class="token number">0x8a</span><span class="token punctuation">,</span> <span class="token number">0x6b</span><span class="token punctuation">,</span>
    <span class="token number">0x3a</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0x41</span><span class="token punctuation">,</span> <span class="token number">0x4f</span><span class="token punctuation">,</span> <span class="token number">0x67</span><span class="token punctuation">,</span> <span class="token number">0xdc</span><span class="token punctuation">,</span> <span class="token number">0xea</span><span class="token punctuation">,</span> <span class="token number">0x97</span><span class="token punctuation">,</span> <span class="token number">0xf2</span><span class="token punctuation">,</span> <span class="token number">0xcf</span><span class="token punctuation">,</span> <span class="token number">0xce</span><span class="token punctuation">,</span> <span class="token number">0xf0</span><span class="token punctuation">,</span> <span class="token number">0xb4</span><span class="token punctuation">,</span> <span class="token number">0xe6</span><span class="token punctuation">,</span> <span class="token number">0x73</span><span class="token punctuation">,</span>
    <span class="token number">0x96</span><span class="token punctuation">,</span> <span class="token number">0xac</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0x22</span><span class="token punctuation">,</span> <span class="token number">0xe7</span><span class="token punctuation">,</span> <span class="token number">0xad</span><span class="token punctuation">,</span> <span class="token number">0x35</span><span class="token punctuation">,</span> <span class="token number">0x85</span><span class="token punctuation">,</span> <span class="token number">0xe2</span><span class="token punctuation">,</span> <span class="token number">0xf9</span><span class="token punctuation">,</span> <span class="token number">0x37</span><span class="token punctuation">,</span> <span class="token number">0xe8</span><span class="token punctuation">,</span> <span class="token number">0x1c</span><span class="token punctuation">,</span> <span class="token number">0x75</span><span class="token punctuation">,</span> <span class="token number">0xdf</span><span class="token punctuation">,</span> <span class="token number">0x6e</span><span class="token punctuation">,</span>
    <span class="token number">0x47</span><span class="token punctuation">,</span> <span class="token number">0xf1</span><span class="token punctuation">,</span> <span class="token number">0x1a</span><span class="token punctuation">,</span> <span class="token number">0x71</span><span class="token punctuation">,</span> <span class="token number">0x1d</span><span class="token punctuation">,</span> <span class="token number">0x29</span><span class="token punctuation">,</span> <span class="token number">0xc5</span><span class="token punctuation">,</span> <span class="token number">0x89</span><span class="token punctuation">,</span> <span class="token number">0x6f</span><span class="token punctuation">,</span> <span class="token number">0xb7</span><span class="token punctuation">,</span> <span class="token number">0x62</span><span class="token punctuation">,</span> <span class="token number">0x0e</span><span class="token punctuation">,</span> <span class="token number">0xaa</span><span class="token punctuation">,</span> <span class="token number">0x18</span><span class="token punctuation">,</span> <span class="token number">0xbe</span><span class="token punctuation">,</span> <span class="token number">0x1b</span><span class="token punctuation">,</span>
    <span class="token number">0xfc</span><span class="token punctuation">,</span> <span class="token number">0x56</span><span class="token punctuation">,</span> <span class="token number">0x3e</span><span class="token punctuation">,</span> <span class="token number">0x4b</span><span class="token punctuation">,</span> <span class="token number">0xc6</span><span class="token punctuation">,</span> <span class="token number">0xd2</span><span class="token punctuation">,</span> <span class="token number">0x79</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0x9a</span><span class="token punctuation">,</span> <span class="token number">0xdb</span><span class="token punctuation">,</span> <span class="token number">0xc0</span><span class="token punctuation">,</span> <span class="token number">0xfe</span><span class="token punctuation">,</span> <span class="token number">0x78</span><span class="token punctuation">,</span> <span class="token number">0xcd</span><span class="token punctuation">,</span> <span class="token number">0x5a</span><span class="token punctuation">,</span> <span class="token number">0xf4</span><span class="token punctuation">,</span>
    <span class="token number">0x1f</span><span class="token punctuation">,</span> <span class="token number">0xdd</span><span class="token punctuation">,</span> <span class="token number">0xa8</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0x07</span><span class="token punctuation">,</span> <span class="token number">0xc7</span><span class="token punctuation">,</span> <span class="token number">0x31</span><span class="token punctuation">,</span> <span class="token number">0xb1</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x59</span><span class="token punctuation">,</span> <span class="token number">0x27</span><span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0xec</span><span class="token punctuation">,</span> <span class="token number">0x5f</span><span class="token punctuation">,</span>
    <span class="token number">0x60</span><span class="token punctuation">,</span> <span class="token number">0x51</span><span class="token punctuation">,</span> <span class="token number">0x7f</span><span class="token punctuation">,</span> <span class="token number">0xa9</span><span class="token punctuation">,</span> <span class="token number">0x19</span><span class="token punctuation">,</span> <span class="token number">0xb5</span><span class="token punctuation">,</span> <span class="token number">0x4a</span><span class="token punctuation">,</span> <span class="token number">0x0d</span><span class="token punctuation">,</span> <span class="token number">0x2d</span><span class="token punctuation">,</span> <span class="token number">0xe5</span><span class="token punctuation">,</span> <span class="token number">0x7a</span><span class="token punctuation">,</span> <span class="token number">0x9f</span><span class="token punctuation">,</span> <span class="token number">0x93</span><span class="token punctuation">,</span> <span class="token number">0xc9</span><span class="token punctuation">,</span> <span class="token number">0x9c</span><span class="token punctuation">,</span> <span class="token number">0xef</span><span class="token punctuation">,</span>
    <span class="token number">0xa0</span><span class="token punctuation">,</span> <span class="token number">0xe0</span><span class="token punctuation">,</span> <span class="token number">0x3b</span><span class="token punctuation">,</span> <span class="token number">0x4d</span><span class="token punctuation">,</span> <span class="token number">0xae</span><span class="token punctuation">,</span> <span class="token number">0x2a</span><span class="token punctuation">,</span> <span class="token number">0xf5</span><span class="token punctuation">,</span> <span class="token number">0xb0</span><span class="token punctuation">,</span> <span class="token number">0xc8</span><span class="token punctuation">,</span> <span class="token number">0xeb</span><span class="token punctuation">,</span> <span class="token number">0xbb</span><span class="token punctuation">,</span> <span class="token number">0x3c</span><span class="token punctuation">,</span> <span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0x53</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0x61</span><span class="token punctuation">,</span>
    <span class="token number">0x17</span><span class="token punctuation">,</span> <span class="token number">0x2b</span><span class="token punctuation">,</span> <span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token number">0x7e</span><span class="token punctuation">,</span> <span class="token number">0xba</span><span class="token punctuation">,</span> <span class="token number">0x77</span><span class="token punctuation">,</span> <span class="token number">0xd6</span><span class="token punctuation">,</span> <span class="token number">0x26</span><span class="token punctuation">,</span> <span class="token number">0xe1</span><span class="token punctuation">,</span> <span class="token number">0x69</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">,</span> <span class="token number">0x63</span><span class="token punctuation">,</span> <span class="token number">0x55</span><span class="token punctuation">,</span> <span class="token number">0x21</span><span class="token punctuation">,</span> <span class="token number">0x0c</span><span class="token punctuation">,</span> <span class="token number">0x7d</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">/**
* 获取整形数据的低8位的左4个位
*/</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">getLeft4Bit</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> left <span class="token operator">=</span> num <span class="token operator">&amp;</span> <span class="token number">0x000000f0</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> left <span class="token operator">&gt;&gt;</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 获取整形数据的低8位的右4个位
*/</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">getRight4Bit</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> num <span class="token operator">&amp;</span> <span class="token number">0x0000000f</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token comment">/**
* 根据索引，从S盒中获得元素
*/</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">getNumFromSBox</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> row <span class="token operator">=</span> <span class="token function">getLeft4Bit</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> col <span class="token operator">=</span> <span class="token function">getRight4Bit</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> S<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 把一个字符转变成整型
*/</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">getIntFromChar</span><span class="token punctuation">(</span><span class="token keyword">char</span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> result <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> c<span class="token punctuation">;</span>
    <span class="token keyword">return</span> result <span class="token operator">&amp;</span> <span class="token number">0x000000ff</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 把16个字符转变成4X4的数组，
* 该矩阵中字节的排列顺序为从上到下，
* 从左到右依次排列。
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">convertToIntArray</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">,</span> <span class="token keyword">int</span> pa<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            pa<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getIntFromChar</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            k<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 打印4X4的数组
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">printArray</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;a[%d][%d] = 0x%x &quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;\\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;\\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 打印字符串的ASSCI，
* 以十六进制显示。
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">printASSCI</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;0x%x &quot;</span><span class="token punctuation">,</span> <span class="token function">getIntFromChar</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;\\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 把连续的4个字符合并成一个4字节的整型
*/</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">getWordFromStr</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> one <span class="token operator">=</span> <span class="token function">getIntFromChar</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    one <span class="token operator">=</span> one <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> two <span class="token operator">=</span> <span class="token function">getIntFromChar</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    two <span class="token operator">=</span> two <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> three <span class="token operator">=</span> <span class="token function">getIntFromChar</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    three <span class="token operator">=</span> three <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> four <span class="token operator">=</span> <span class="token function">getIntFromChar</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> one <span class="token operator">|</span> two <span class="token operator">|</span> three <span class="token operator">|</span> four<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 把一个4字节的数的第一、二、三、四个字节取出，
* 入进一个4个元素的整型数组里面。
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">splitIntToArray</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">,</span> <span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> one <span class="token operator">=</span> num <span class="token operator">&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">;</span>
    array<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> one <span class="token operator">&amp;</span> <span class="token number">0x000000ff</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> two <span class="token operator">=</span> num <span class="token operator">&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">;</span>
    array<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> two <span class="token operator">&amp;</span> <span class="token number">0x000000ff</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> three <span class="token operator">=</span> num <span class="token operator">&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">;</span>
    array<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> three <span class="token operator">&amp;</span> <span class="token number">0x000000ff</span><span class="token punctuation">;</span>
    array<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> num <span class="token operator">&amp;</span> <span class="token number">0x000000ff</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 将数组中的元素循环左移step位
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">leftLoop4int</span><span class="token punctuation">(</span><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> step<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> temp<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        temp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> index <span class="token operator">=</span> step <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> step <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        array<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
        index<span class="token operator">++</span><span class="token punctuation">;</span>
        index <span class="token operator">=</span> index <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 把数组中的第一、二、三和四元素分别作为
* 4字节整型的第一、二、三和四字节，合并成一个4字节整型
*/</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">mergeArrayToInt</span><span class="token punctuation">(</span><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> one <span class="token operator">=</span> array<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> two <span class="token operator">=</span> array<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> three <span class="token operator">=</span> array<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> four <span class="token operator">=</span> array<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> one <span class="token operator">|</span> two <span class="token operator">|</span> three <span class="token operator">|</span> four<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 常量轮值表
*/</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">int</span> Rcon<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0x01000000</span><span class="token punctuation">,</span> <span class="token number">0x02000000</span><span class="token punctuation">,</span>
    <span class="token number">0x04000000</span><span class="token punctuation">,</span> <span class="token number">0x08000000</span><span class="token punctuation">,</span>
    <span class="token number">0x10000000</span><span class="token punctuation">,</span> <span class="token number">0x20000000</span><span class="token punctuation">,</span>
    <span class="token number">0x40000000</span><span class="token punctuation">,</span> <span class="token number">0x80000000</span><span class="token punctuation">,</span>
    <span class="token number">0x1b000000</span><span class="token punctuation">,</span> <span class="token number">0x36000000</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">/**
* 密钥扩展中的T函数
*/</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">T</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">,</span> <span class="token keyword">int</span> round<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> numArray<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">splitIntToArray</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span> numArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">leftLoop4int</span><span class="token punctuation">(</span>numArray<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//字循环</span>

    <span class="token comment">//字节代换</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        numArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getNumFromSBox</span><span class="token punctuation">(</span>numArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> result <span class="token operator">=</span> <span class="token function">mergeArrayToInt</span><span class="token punctuation">(</span>numArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result <span class="token operator">^</span> Rcon<span class="token punctuation">[</span>round<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//密钥对应的扩展数组</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> w<span class="token punctuation">[</span><span class="token number">44</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">/**
* 扩展密钥，结果是把w[44]中的每个元素初始化
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">extendKey</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        w<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getWordFromStr</span><span class="token punctuation">(</span>key <span class="token operator">+</span> i <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">44</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span> i <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            w<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> w<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token function">T</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span>
            j<span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment">//下一轮</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
            w<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> w<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">^</span> w<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 轮密钥加
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">addRoundKey</span><span class="token punctuation">(</span><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> round<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> warray<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token function">splitIntToArray</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span> round <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> i<span class="token punctuation">]</span><span class="token punctuation">,</span> warray<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            array<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> warray<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 字节代换
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">subBytes</span><span class="token punctuation">(</span><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
            array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getNumFromSBox</span><span class="token punctuation">(</span>array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 行移位
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">shiftRows</span><span class="token punctuation">(</span><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> rowTwo<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> rowThree<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> rowFour<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">//复制状态矩阵的第2,3,4行</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        rowTwo<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        rowThree<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        rowFour<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//循环左移相应的位数</span>
    <span class="token function">leftLoop4int</span><span class="token punctuation">(</span>rowTwo<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">leftLoop4int</span><span class="token punctuation">(</span>rowThree<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">leftLoop4int</span><span class="token punctuation">(</span>rowFour<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//把左移后的行复制回状态矩阵中</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        array<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> rowTwo<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        array<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> rowThree<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        array<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> rowFour<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 列混合要用到的矩阵
*/</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">int</span> colM<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">GFMul2</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> result <span class="token operator">=</span> s <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> a7 <span class="token operator">=</span> result <span class="token operator">&amp;</span> <span class="token number">0x00000100</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>a7 <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        result <span class="token operator">=</span> result <span class="token operator">&amp;</span> <span class="token number">0x000000ff</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> result <span class="token operator">^</span> <span class="token number">0x1b</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">GFMul3</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">GFMul2</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">^</span> s<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">GFMul4</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">GFMul2</span><span class="token punctuation">(</span><span class="token function">GFMul2</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">GFMul8</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">GFMul2</span><span class="token punctuation">(</span><span class="token function">GFMul4</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">GFMul9</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">GFMul8</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">^</span> s<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">GFMul11</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">GFMul9</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">GFMul2</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">GFMul12</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">GFMul8</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">GFMul4</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">GFMul13</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">GFMul12</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">^</span> s<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">GFMul14</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">GFMul12</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">GFMul2</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* GF上的二元运算
*/</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">GFMul</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span> <span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> result<span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
        result <span class="token operator">=</span> s<span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span>
        result <span class="token operator">=</span> <span class="token function">GFMul2</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span>
        result <span class="token operator">=</span> <span class="token function">GFMul3</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0x9</span><span class="token punctuation">)</span>
        result <span class="token operator">=</span> <span class="token function">GFMul9</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0xb</span><span class="token punctuation">)</span><span class="token comment">//11</span>
        result <span class="token operator">=</span> <span class="token function">GFMul11</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0xd</span><span class="token punctuation">)</span><span class="token comment">//13</span>
        result <span class="token operator">=</span> <span class="token function">GFMul13</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0xe</span><span class="token punctuation">)</span><span class="token comment">//14</span>
        result <span class="token operator">=</span> <span class="token function">GFMul14</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/**
* 列混合
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">mixColumns</span><span class="token punctuation">(</span><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">int</span> tempArray<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
            tempArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">GFMul</span><span class="token punctuation">(</span>colM<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>tempArray<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">GFMul</span><span class="token punctuation">(</span>colM<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>tempArray<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> 
                <span class="token operator">^</span> <span class="token function">GFMul</span><span class="token punctuation">(</span>colM<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>tempArray<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">GFMul</span><span class="token punctuation">(</span>colM<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> tempArray<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">/**
* 把4X4数组转回字符串
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">convertArrayToStr</span><span class="token punctuation">(</span><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token operator">*</span>str<span class="token operator">++</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span>array<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>	
<span class="token punctuation">}</span>
<span class="token comment">/**
* 检查密钥长度
*/</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">checkKeyLen</span><span class="token punctuation">(</span><span class="token keyword">int</span> len<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>len <span class="token operator">==</span> <span class="token number">16</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 参数 p: 明文的字符串数组。
* 参数 plen: 明文的长度。
* 参数 key: 密钥的字符串数组。
*/</span>
<span class="token keyword">void</span> <span class="token function">aes</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>p<span class="token punctuation">,</span> <span class="token keyword">int</span> plen<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>key<span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token keyword">int</span> keylen <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>plen <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> plen <span class="token operator">%</span> <span class="token number">16</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;明文字符长度必须为16的倍数！\\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">checkKeyLen</span><span class="token punctuation">(</span>keylen<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;密钥字符长度错误！长度必须为16、24和32。当前长度为%d\\n&quot;</span><span class="token punctuation">,</span>keylen<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">extendKey</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//扩展密钥</span>
    <span class="token keyword">int</span> pArray<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> plen<span class="token punctuation">;</span> k <span class="token operator">+=</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>	
        <span class="token function">convertToIntArray</span><span class="token punctuation">(</span>p <span class="token operator">+</span> k<span class="token punctuation">,</span> pArray<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">addRoundKey</span><span class="token punctuation">(</span>pArray<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//一开始的轮密钥加</span>

        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//前9轮</span>

            <span class="token function">subBytes</span><span class="token punctuation">(</span>pArray<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//字节代换</span>

            <span class="token function">shiftRows</span><span class="token punctuation">(</span>pArray<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//行移位</span>

            <span class="token function">mixColumns</span><span class="token punctuation">(</span>pArray<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//列混合</span>

            <span class="token function">addRoundKey</span><span class="token punctuation">(</span>pArray<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span>

        <span class="token comment">//第10轮</span>
        <span class="token function">subBytes</span><span class="token punctuation">(</span>pArray<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//字节代换</span>

        <span class="token function">shiftRows</span><span class="token punctuation">(</span>pArray<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//行移位</span>

        <span class="token function">addRoundKey</span><span class="token punctuation">(</span>pArray<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">convertArrayToStr</span><span class="token punctuation">(</span>pArray<span class="token punctuation">,</span> p <span class="token operator">+</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">/**
* 根据索引从逆S盒中获取值
*/</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">getNumFromS1Box</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> row <span class="token operator">=</span> <span class="token function">getLeft4Bit</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> col <span class="token operator">=</span> <span class="token function">getRight4Bit</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> S2<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/**
* 逆字节变换
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">deSubBytes</span><span class="token punctuation">(</span><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
            array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getNumFromS1Box</span><span class="token punctuation">(</span>array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/**
* 把4个元素的数组循环右移step位
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">rightLoop4int</span><span class="token punctuation">(</span><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> step<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> temp<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        temp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> index <span class="token operator">=</span> step <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> step <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">;</span>
    index <span class="token operator">=</span> <span class="token number">3</span> <span class="token operator">-</span> index<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        array<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
        index<span class="token operator">--</span><span class="token punctuation">;</span>
        index <span class="token operator">=</span> index <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">?</span> <span class="token number">3</span> <span class="token operator">:</span> index<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 逆行移位
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">deShiftRows</span><span class="token punctuation">(</span><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> rowTwo<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> rowThree<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> rowFour<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        rowTwo<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        rowThree<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        rowFour<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">rightLoop4int</span><span class="token punctuation">(</span>rowTwo<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">rightLoop4int</span><span class="token punctuation">(</span>rowThree<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">rightLoop4int</span><span class="token punctuation">(</span>rowFour<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        array<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> rowTwo<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        array<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> rowThree<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        array<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> rowFour<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">/**
* 逆列混合用到的矩阵
*/</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">int</span> deColM<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0xe</span><span class="token punctuation">,</span> <span class="token number">0xb</span><span class="token punctuation">,</span> <span class="token number">0xd</span><span class="token punctuation">,</span> <span class="token number">0x9</span><span class="token punctuation">,</span>
    <span class="token number">0x9</span><span class="token punctuation">,</span> <span class="token number">0xe</span><span class="token punctuation">,</span> <span class="token number">0xb</span><span class="token punctuation">,</span> <span class="token number">0xd</span><span class="token punctuation">,</span>
    <span class="token number">0xd</span><span class="token punctuation">,</span> <span class="token number">0x9</span><span class="token punctuation">,</span> <span class="token number">0xe</span><span class="token punctuation">,</span> <span class="token number">0xb</span><span class="token punctuation">,</span>
    <span class="token number">0xb</span><span class="token punctuation">,</span> <span class="token number">0xd</span><span class="token punctuation">,</span> <span class="token number">0x9</span><span class="token punctuation">,</span> <span class="token number">0xe</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">/**
* 逆列混合
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">deMixColumns</span><span class="token punctuation">(</span><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> tempArray<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
            tempArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">GFMul</span><span class="token punctuation">(</span>deColM<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>tempArray<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">GFMul</span><span class="token punctuation">(</span>deColM<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>tempArray<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> 
                <span class="token operator">^</span> <span class="token function">GFMul</span><span class="token punctuation">(</span>deColM<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>tempArray<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">GFMul</span><span class="token punctuation">(</span>deColM<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> tempArray<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">/**
* 把两个4X4数组进行异或
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">addRoundTowArray</span><span class="token punctuation">(</span><span class="token keyword">int</span> aArray<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">int</span> bArray<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
            aArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> aArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">^</span> bArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/**
* 从4个32位的密钥字中获得4X4数组，
* 用于进行逆列混合
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">getArrayFrom4W</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> index <span class="token operator">=</span> i <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> colOne<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> colTwo<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> colThree<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> colFour<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">splitIntToArray</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">,</span> colOne<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">splitIntToArray</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span>index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> colTwo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">splitIntToArray</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span>index <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> colThree<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">splitIntToArray</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span>index <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> colFour<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> colOne<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> colTwo<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> colThree<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> colFour<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 参数 c: 密文的字符串数组。
* 参数 clen: 密文的长度。
* 参数 key: 密钥的字符串数组。
*/</span>
<span class="token keyword">void</span> <span class="token function">deAes</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>c<span class="token punctuation">,</span> <span class="token keyword">int</span> clen<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>key<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">int</span> keylen <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>clen <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> clen <span class="token operator">%</span> <span class="token number">16</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;密文字符长度必须为16的倍数！现在的长度为%d\\n&quot;</span><span class="token punctuation">,</span>clen<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">checkKeyLen</span><span class="token punctuation">(</span>keylen<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;密钥字符长度错误！长度必须为16、24和32。当前长度为%d\\n&quot;</span><span class="token punctuation">,</span>keylen<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">extendKey</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//扩展密钥</span>
    <span class="token keyword">int</span> cArray<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> clen<span class="token punctuation">;</span> k <span class="token operator">+=</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">convertToIntArray</span><span class="token punctuation">(</span>c <span class="token operator">+</span> k<span class="token punctuation">,</span> cArray<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">addRoundKey</span><span class="token punctuation">(</span>cArray<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">int</span> wArray<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">deSubBytes</span><span class="token punctuation">(</span>cArray<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token function">deShiftRows</span><span class="token punctuation">(</span>cArray<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token function">deMixColumns</span><span class="token punctuation">(</span>cArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">getArrayFrom4W</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> wArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">deMixColumns</span><span class="token punctuation">(</span>wArray<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token function">addRoundTowArray</span><span class="token punctuation">(</span>cArray<span class="token punctuation">,</span> wArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token function">deSubBytes</span><span class="token punctuation">(</span>cArray<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">deShiftRows</span><span class="token punctuation">(</span>cArray<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">addRoundKey</span><span class="token punctuation">(</span>cArray<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">convertArrayToStr</span><span class="token punctuation">(</span>cArray<span class="token punctuation">,</span> c <span class="token operator">+</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),_=a(`<h2 id="peb" tabindex="-1"><a class="header-anchor" href="#peb" aria-hidden="true">#</a> PEB</h2><blockquote><p>在PEB（Password Based Encryption基于口令加密）算法中使用口令（系统登陆时的密码）而不是密钥。口令由用户自己掌管，采用随机数（加盐）杂凑多重加密等方法保证数据安全。将盐附加口令，通过消息摘要（MD5等）构建出密钥/IV</p><p>PBE算法是对称加密算法的综合性算法（已知的对称加密算法做包装，并没有构建新的加密算法）。如PBEWithMD5AndDES，使用了MD5与DES构建PBE算法</p></blockquote><p>PBE通常使用摘要算法（MD，SHA）将口令与盐计算出key作为密钥，通过该密钥进行对称加密（DES、AES）得到密文。进行对称加密时一般使用CBC模式</p><ul><li><p>消息传递流程</p><ul><li>消息传递双方同步口令（单方生成 或 协商生成 等，生成后向未知方公布口令）</li><li>发送方构建盐（通过随机方式构建8字节的盐）</li><li>发送方使用口令、盐进行数据加密</li><li>将盐、加密数据发送给接收方</li><li>接收方使用盐、口令对数据解密</li></ul></li><li><p>代码</p><ul><li><p>Java API</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// 生成盐</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">initSalt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token class-name">SecureRandom</span> random <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SecureRandom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> random<span class="token punctuation">.</span><span class="token function">generateSeed</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 加密</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data<span class="token punctuation">,</span> <span class="token class-name">String</span> pwd<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> salt<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token comment">// 转换密钥 String类型 转 密钥类型</span>
    <span class="token class-name">Key</span> key <span class="token operator">=</span> <span class="token constant">PBE</span><span class="token punctuation">.</span><span class="token function">toKey</span><span class="token punctuation">(</span>pwd<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 实例化参数</span>
    <span class="token class-name">PBEParameterSpec</span> paramSpec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PBEParameterSpec</span><span class="token punctuation">(</span>salt<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 盐 + 迭代次数</span>
    <span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;PBEWITHMD5andDES&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token constant">ENCRYPT_MODE</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> paramSpec<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> cipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li></ul>`,4);function E(F,j){const p=o("ExternalLinkIcon");return c(),u("div",null,[i,n("p",null,[s("对称加密算法工作模式（分组模式）：其中最常用ECB与CBC。图片源自"),n("a",k,[s("wikipedia - 分组密码工作模式"),t(p)]),s("，图示说明：分组加密需要两个输入，其中一个为密钥，得到一个输出块")]),r,n("ul",null,[d,n("li",null,[m,n("ul",null,[n("li",null,[n("p",null,[s("Js实现 参考"),n("a",b,[s("https://gist.github.com/dragonwong/1af215e8ca6ef4b11af51d65432f65c4"),t(p)])]),v])])])]),x,y,n("ul",null,[f,n("li",null,[n("p",null,[s("分组加密流程：下面说明128位密钥的一轮分组加密中的操作。参考"),n("a",w,[s("https://blog.csdn.net/qq_28205153/article/details/55798628"),t(p)])]),h]),g,n("li",null,[S,n("ul",null,[n("li",null,[n("p",null,[s("C语言实现，同样参考文章"),n("a",A,[s("https://blog.csdn.net/qq_28205153/article/details/55798628"),t(p)])]),C])])])]),_])}const B=e(l,[["render",E],["__file","015.html.vue"]]);export{B as default};
