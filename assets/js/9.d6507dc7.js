(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{281:function(a,s,t){"use strict";t.r(s);var r=t(10),e=Object(r.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h2",{attrs:{id:"文件向手机传输"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#文件向手机传输"}},[a._v("#")]),a._v(" 文件向手机传输")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("推荐使用安卓官方的"),s("a",{attrs:{href:"%60https://www.android.com/filetransfer/%60"}},[a._v("文件传输工具")]),a._v("(大陆需良好的网络情况才可访问)。数据线连接电脑即可进行文件传输。")])]),a._v(" "),s("li",[s("p",[a._v("或者使用adb进行传输。需要预先安装"),s("code",[a._v("androidsdk")])])])]),a._v(" "),s("div",{staticClass:"language-bash macos line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("adb push C:"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Users"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Test"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Downloads"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(".pem /sdcard/1.pem\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h2",{attrs:{id:"系统wifi配置charles进行抓包"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#系统wifi配置charles进行抓包"}},[a._v("#")]),a._v(" 系统Wifi配置Charles进行抓包")]),a._v(" "),s("ul",[s("li",[a._v("保证运行Charles的客户端与安卓手机在同一局域网内，手机在wifi设置中配置代理为charles的ip与端口（此时charles无需打开系统代理，系统代理用于抓取charles宿主机的包）")]),a._v(" "),s("li",[a._v("浏览器打开"),s("code",[a._v("chls.pro/ssl")]),a._v("下载证书  或者 电脑charles打开Help -> Save Charles Root Certi... 将证书传入手机")]),a._v(" "),s("li",[a._v("手机在设置中搜索“证书”安装或者文件管理器直接打开安装")]),a._v(" "),s("li",[a._v("charles中对https的包右键开启ssl代理，对需要关注的host进行右键关注方便筛选")])]),a._v(" "),s("p",[s("strong",[a._v("注意：")]),a._v("\n通过手机安装的证书为用户级别证书。对大多数app的ssl包无法生效，需要系统级别的证书。")]),a._v(" "),s("p",[a._v("经root手机可通过面具插件"),s("code",[a._v("movecert")]),a._v("将用户级证书更改为系统级证书从而成功抓包。或是安装xpose插件"),s("code",[a._v("TrustMeAlready")]),a._v("免证书抓取https数据包。")]),a._v(" "),s("p",[a._v("未root手机安装"),s("code",[a._v("virtualxposed")]),a._v("在系统中模拟一个拥有root权限的安卓系统，将目标app安装在该环境中只需用户级别证书即可抓取。")]),a._v(" "),s("h2",{attrs:{id:"使用postern通过socks5协议进行抓包"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用postern通过socks5协议进行抓包"}},[a._v("#")]),a._v(" 使用postern通过socks5协议进行抓包")]),a._v(" "),s("p",[a._v("如果App检测了是否走系统代理，则wifi代理无效，需要配合Postern\n与使用系统wifi代理流程大致相同，而系统wifi代理通过http协议进行抓包。以下是几个不同点")]),a._v(" "),s("ul",[s("li",[a._v("在charlse设置中启用socks代理并设置端口")]),a._v(" "),s("li",[a._v("安装并打开postern，"),s("em",[a._v("配置代理")]),a._v("中添加一个代理服务器，输入charles所在的ip与端口，代理类型选择"),s("code",[a._v("socks5")])]),a._v(" "),s("li",[s("em",[a._v("配置规则")]),a._v("中删除软件默认规则，新建规则：匹配所有地址 - 通过代理连接 - 选择上一步中建立的socks5代理保存")]),a._v(" "),s("li",[a._v("通过"),s("em",[a._v("打开/关闭VPN")]),a._v("进行是否通过charles的控制")])]),a._v(" "),s("h2",{attrs:{id:"r0capture抓包"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#r0capture抓包"}},[a._v("#")]),a._v(" r0capture抓包")]),a._v(" "),s("p",[a._v("基于frida的抓包工具，抓包支持协议更广。\n"),s("strong",[a._v("注意：需要手机进行root。")]),a._v("\n参考"),s("a",{attrs:{href:"https://juejin.cn/post/7081295665170481165",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://juejin.cn/post/7081295665170481165"),s("OutboundLink")],1)]),a._v(" "),s("h3",{attrs:{id:"电脑端抓包环境"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#电脑端抓包环境"}},[a._v("#")]),a._v(" 电脑端抓包环境")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("从github拉取"),s("a",{attrs:{href:"https://github.com/r0ysue/r0capture",target:"_blank",rel:"noopener noreferrer"}},[a._v("r0capture"),s("OutboundLink")],1)])]),a._v(" "),s("li",[s("p",[a._v("安装r0capture的依赖")])])]),a._v(" "),s("div",{staticClass:"language-bash macos line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("pip "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" frida-tools\npip "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" loguru\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("h3",{attrs:{id:"手机端抓包环境"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#手机端抓包环境"}},[a._v("#")]),a._v(" 手机端抓包环境")]),a._v(" "),s("h4",{attrs:{id:"手机安装frida服务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#手机安装frida服务"}},[a._v("#")]),a._v(" 手机安装frida服务")]),a._v(" "),s("ul",[s("li",[a._v("查看手机处理器架构（arm or x86, 32 or 64） "),s("code",[a._v("adb shell getprop ro.product.cpu.abi")])]),a._v(" "),s("li",[a._v("根据架构下载对应的压缩包，解压得到可执行文件frida-server")])]),a._v(" "),s("h3",{attrs:{id:"手机端启动frida服务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#手机端启动frida服务"}},[a._v("#")]),a._v(" 手机端启动frida服务")]),a._v(" "),s("p",[a._v("shell里运行上一步得到的可执行文件")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ adb shell\nbullhead:/ $ "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("su")]),a._v(" \nbullhead:/ "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# whoami")]),a._v("\nroot\nbullhead:/ "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# cd /data/local/tmp/")]),a._v("\nbullhead:/data/local/tmp "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# chmod 777 /data/local/tmp/frida-server")]),a._v("\nbullhead:/data/local/tmp "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ./frida-server &")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("6669")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br")])]),s("h3",{attrs:{id:"电脑端抓包"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#电脑端抓包"}},[a._v("#")]),a._v(" 电脑端抓包")]),a._v(" "),s("div",{staticClass:"language-bash macos line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 参数：-f 在包未运行时自动启动目标应用 测试小红书会闪退")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# spawn 模式")]),a._v("\npython r0capture.py "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-U")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" 包名\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Attach 模式")]),a._v("\npython r0capture.py "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-U")]),a._v(" 包名 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" 文件名.pcap\npython r0capture.py "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-U")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" 包名 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-v")]),a._v("  "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">>")]),a._v(" 文件名.txt\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br")])]),s("h3",{attrs:{id:"补充-如何获取应用的包名"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#补充-如何获取应用的包名"}},[a._v("#")]),a._v(" 补充：如何获取应用的包名")]),a._v(" "),s("p",[a._v("启动使用adb获取包名：先使用"),s("code",[a._v("adb shell am monitor")]),a._v("，再启动目标app即可获取")]),a._v(" "),s("p",[a._v("例如：小红书包名"),s("code",[a._v("com.xingin.xhs")])]),a._v(" "),s("h2",{attrs:{id:"参考文档"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考文档"}},[a._v("#")]),a._v(" 参考文档")]),a._v(" "),s("p",[a._v("r0capture "),s("a",{attrs:{href:"https://juejin.cn/post/7081295665170481165",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://juejin.cn/post/7081295665170481165"),s("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=e.exports}}]);