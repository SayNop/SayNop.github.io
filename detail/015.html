<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.68">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <meta property="og:url" content="https://saynop.github.io/detail/015.html"><meta property="og:title" content="对称加密算法"><meta property="og:description" content="简介 双方使用相同的密钥对明文进行加解密。常见算法DES，DESede（3DES），AES，IDEA等。优点：计算量小，速度快，效率高。缺点：双方使用相同密钥，安全性难以保证；每对用户使用不同密钥时，在分布式等场景下的密钥管理难度高，使用成本高 填充方式 DES算法以64位（8字节）进行分组加密，对最后一组不足64位的内容，可进行填充处理使其为8字节。常见填充方式如下 NoPadding：不填充 ZerosPadding：0填充 PKCS5Padding：以填充字节数为值对目标字符串进行填充，如 F9 需填充7字节，填充后 F9 07 07 07 07 07 07 07）。如果明文最后一组刚好为64位，则需填充一组 08 08 08 08 08 08 08 08 ，且明文长度需要 +8 字节"><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="article:tag" content="Cryptography"><meta property="article:tag" content="DES"><meta property="article:tag" content="AES"><meta property="article:published_time" content="2024-04-13T00:00:00.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"对称加密算法","image":[""],"datePublished":"2024-04-13T00:00:00.000Z","dateModified":null,"author":[]}</script><link rel="icon" href="/favicon.ico"><title>对称加密算法</title><meta name="description" content="简介 双方使用相同的密钥对明文进行加解密。常见算法DES，DESede（3DES），AES，IDEA等。优点：计算量小，速度快，效率高。缺点：双方使用相同密钥，安全性难以保证；每对用户使用不同密钥时，在分布式等场景下的密钥管理难度高，使用成本高 填充方式 DES算法以64位（8字节）进行分组加密，对最后一组不足64位的内容，可进行填充处理使其为8字节。常见填充方式如下 NoPadding：不填充 ZerosPadding：0填充 PKCS5Padding：以填充字节数为值对目标字符串进行填充，如 F9 需填充7字节，填充后 F9 07 07 07 07 07 07 07）。如果明文最后一组刚好为64位，则需填充一组 08 08 08 08 08 08 08 08 ，且明文长度需要 +8 字节">
    <link rel="preload" href="/assets/style-3253bf1b.css" as="style"><link rel="stylesheet" href="/assets/style-3253bf1b.css">
    <link rel="modulepreload" href="/assets/app-da04b297.js"><link rel="modulepreload" href="/assets/015.html-627d6665.js"><link rel="modulepreload" href="/assets/015.html-d4fa28b4.js">
    <link rel="prefetch" href="/assets/index.html-f33fda43.js" as="script"><link rel="prefetch" href="/assets/001.html-12451cc3.js" as="script"><link rel="prefetch" href="/assets/002.html-a6d5828c.js" as="script"><link rel="prefetch" href="/assets/003.html-3e8b49c2.js" as="script"><link rel="prefetch" href="/assets/004.html-689926d8.js" as="script"><link rel="prefetch" href="/assets/005.html-d6b96039.js" as="script"><link rel="prefetch" href="/assets/006.html-5b50a542.js" as="script"><link rel="prefetch" href="/assets/007.html-d3b6ddc8.js" as="script"><link rel="prefetch" href="/assets/008.html-988b3dab.js" as="script"><link rel="prefetch" href="/assets/009.html-7d1574d7.js" as="script"><link rel="prefetch" href="/assets/010.html-f1724340.js" as="script"><link rel="prefetch" href="/assets/011.html-10672fd1.js" as="script"><link rel="prefetch" href="/assets/012.html-5e7aa08e.js" as="script"><link rel="prefetch" href="/assets/013.html-ca52b138.js" as="script"><link rel="prefetch" href="/assets/014.html-4158ea15.js" as="script"><link rel="prefetch" href="/assets/404.html-a0fec2a7.js" as="script"><link rel="prefetch" href="/assets/index.html-75381ff5.js" as="script"><link rel="prefetch" href="/assets/index.html-c95ce669.js" as="script"><link rel="prefetch" href="/assets/index.html-2c56dc8e.js" as="script"><link rel="prefetch" href="/assets/index.html-98874abd.js" as="script"><link rel="prefetch" href="/assets/index.html-b2308fb7.js" as="script"><link rel="prefetch" href="/assets/index.html-10e703b4.js" as="script"><link rel="prefetch" href="/assets/index.html-5f3af54d.js" as="script"><link rel="prefetch" href="/assets/index.html-56349a98.js" as="script"><link rel="prefetch" href="/assets/index.html-a7c2713a.js" as="script"><link rel="prefetch" href="/assets/index.html-2e96c3d2.js" as="script"><link rel="prefetch" href="/assets/index.html-9f1eff22.js" as="script"><link rel="prefetch" href="/assets/index.html-16b34053.js" as="script"><link rel="prefetch" href="/assets/index.html-4e233464.js" as="script"><link rel="prefetch" href="/assets/index.html-d90f0ec9.js" as="script"><link rel="prefetch" href="/assets/index.html-3202320f.js" as="script"><link rel="prefetch" href="/assets/index.html-c3fe2c85.js" as="script"><link rel="prefetch" href="/assets/index.html-f3052411.js" as="script"><link rel="prefetch" href="/assets/index.html-5485bfc3.js" as="script"><link rel="prefetch" href="/assets/index.html-a7568890.js" as="script"><link rel="prefetch" href="/assets/index.html-9d25f5f2.js" as="script"><link rel="prefetch" href="/assets/index.html-ff33d682.js" as="script"><link rel="prefetch" href="/assets/index.html-3bce843e.js" as="script"><link rel="prefetch" href="/assets/index.html-09b9da96.js" as="script"><link rel="prefetch" href="/assets/index.html-750acad1.js" as="script"><link rel="prefetch" href="/assets/index.html-1c1e573d.js" as="script"><link rel="prefetch" href="/assets/index.html-8eb4570b.js" as="script"><link rel="prefetch" href="/assets/index.html-7dd1db94.js" as="script"><link rel="prefetch" href="/assets/index.html-32048506.js" as="script"><link rel="prefetch" href="/assets/index.html-a4e9e805.js" as="script"><link rel="prefetch" href="/assets/index.html-df3e534f.js" as="script"><link rel="prefetch" href="/assets/index.html-cb3cc9f5.js" as="script"><link rel="prefetch" href="/assets/index.html-0994fca8.js" as="script"><link rel="prefetch" href="/assets/index.html-a902e771.js" as="script"><link rel="prefetch" href="/assets/index.html-76fbbff6.js" as="script"><link rel="prefetch" href="/assets/index.html-7bc29919.js" as="script"><link rel="prefetch" href="/assets/index.html-b97b6348.js" as="script"><link rel="prefetch" href="/assets/001.html-5831bdd2.js" as="script"><link rel="prefetch" href="/assets/002.html-316bb4b8.js" as="script"><link rel="prefetch" href="/assets/003.html-8819a399.js" as="script"><link rel="prefetch" href="/assets/004.html-12474d0a.js" as="script"><link rel="prefetch" href="/assets/005.html-86e5190f.js" as="script"><link rel="prefetch" href="/assets/006.html-a40fed9b.js" as="script"><link rel="prefetch" href="/assets/007.html-ebf30059.js" as="script"><link rel="prefetch" href="/assets/008.html-d49242f2.js" as="script"><link rel="prefetch" href="/assets/009.html-c61a57be.js" as="script"><link rel="prefetch" href="/assets/010.html-459afc6d.js" as="script"><link rel="prefetch" href="/assets/011.html-78e9b257.js" as="script"><link rel="prefetch" href="/assets/012.html-7851f8ef.js" as="script"><link rel="prefetch" href="/assets/013.html-927e9292.js" as="script"><link rel="prefetch" href="/assets/014.html-890b28ef.js" as="script"><link rel="prefetch" href="/assets/404.html-51f4369b.js" as="script"><link rel="prefetch" href="/assets/index.html-5f5c793b.js" as="script"><link rel="prefetch" href="/assets/index.html-ab7dc14e.js" as="script"><link rel="prefetch" href="/assets/index.html-72450881.js" as="script"><link rel="prefetch" href="/assets/index.html-831b78aa.js" as="script"><link rel="prefetch" href="/assets/index.html-12484e0d.js" as="script"><link rel="prefetch" href="/assets/index.html-e6cd9ccb.js" as="script"><link rel="prefetch" href="/assets/index.html-3a0f2112.js" as="script"><link rel="prefetch" href="/assets/index.html-88897afc.js" as="script"><link rel="prefetch" href="/assets/index.html-4d4ac949.js" as="script"><link rel="prefetch" href="/assets/index.html-49843a8b.js" as="script"><link rel="prefetch" href="/assets/index.html-3ab115bb.js" as="script"><link rel="prefetch" href="/assets/index.html-000fbeeb.js" as="script"><link rel="prefetch" href="/assets/index.html-01c550e5.js" as="script"><link rel="prefetch" href="/assets/index.html-2a5702cf.js" as="script"><link rel="prefetch" href="/assets/index.html-32812306.js" as="script"><link rel="prefetch" href="/assets/index.html-ce1aecab.js" as="script"><link rel="prefetch" href="/assets/index.html-5b75f036.js" as="script"><link rel="prefetch" href="/assets/index.html-43349dfe.js" as="script"><link rel="prefetch" href="/assets/index.html-e5892be5.js" as="script"><link rel="prefetch" href="/assets/index.html-99c526bc.js" as="script"><link rel="prefetch" href="/assets/index.html-6b96e08f.js" as="script"><link rel="prefetch" href="/assets/index.html-adfce603.js" as="script"><link rel="prefetch" href="/assets/index.html-ddea9c57.js" as="script"><link rel="prefetch" href="/assets/index.html-aec5ce2c.js" as="script"><link rel="prefetch" href="/assets/index.html-5943638e.js" as="script"><link rel="prefetch" href="/assets/index.html-80def6ed.js" as="script"><link rel="prefetch" href="/assets/index.html-ec313804.js" as="script"><link rel="prefetch" href="/assets/index.html-99a52116.js" as="script"><link rel="prefetch" href="/assets/index.html-e33a35cc.js" as="script"><link rel="prefetch" href="/assets/index.html-1db48ad6.js" as="script"><link rel="prefetch" href="/assets/index.html-1c38d624.js" as="script"><link rel="prefetch" href="/assets/index.html-45de1bba.js" as="script"><link rel="prefetch" href="/assets/index.html-46e23a3e.js" as="script"><link rel="prefetch" href="/assets/index.html-62df135f.js" as="script"><link rel="prefetch" href="/assets/index.html-34997e36.js" as="script"><link rel="prefetch" href="/assets/giscus-0b7adcf8.js" as="script"><link rel="prefetch" href="/assets/SearchResult-eb0b7f0f.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div data-v-77edf713><header class="header" style="opacity:0;" data-v-90176301><div class="header_container" data-v-90176301><div data-v-90176301><a class="header_title" href="/" data-v-90176301>Leopold&#39;s Blog</a></div><div class="appearance" data-v-90176301><!--[--><button type="button" class="search-pro-button" role="search" aria-label="搜索"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">搜索</div><!----></button><!--]--><button class="switch" data-v-90176301><span class="icon" style="display:block;" data-v-90176301><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" style="" data-v-90176301><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" style="display:none;" data-v-90176301><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg></span></button><button class="switch mobile_list_btn" type="button" data-v-90176301><span class="btn_top" data-v-90176301></span><span class="btn_middle" data-v-90176301></span><span class="btn_bottom" data-v-90176301></span></button></div></div></header><div class="main"><div class="background" data-v-fee8de4c><svg class="pull_down" viewbox="0 0 1026 1024" xmlns="http://www.w3.org/2000/svg" data-v-fee8de4c data-v-3c8412b0><path d="M857.088 224.256q28.672-28.672 69.12-28.672t69.12 28.672q29.696 28.672 29.696 68.608t-29.696 68.608l-382.976 380.928q-12.288 14.336-30.72 19.968t-38.912 4.608-40.448-8.704-34.304-22.016l-376.832-374.784q-29.696-28.672-29.696-68.608t29.696-68.608q14.336-14.336 32.256-21.504t36.864-7.168 37.376 7.168 32.768 21.504l313.344 309.248z" data-v-3c8412b0></path></svg></div><div style="display:flex;"><div class="sider_keeper" data-v-e01a06ce><div class="folding" data-v-e01a06ce><!-- <div class="folding"> --><div class="sidebar_top card_border" style="min-height:1rem" data-v-e01a06ce><div class="tags_brand" data-v-e01a06ce>本文大纲</div><section class="article_sidebar" data-v-e01a06ce data-v-905b99e1><ul data-v-905b99e1><!--[--><li class="level2" data-v-905b99e1><a class="sidebar-link" href="#简介" data-v-905b99e1>简介</a><ul class="level3" data-v-905b99e1><!--[--><!--]--></ul></li><li class="level2" data-v-905b99e1><a class="sidebar-link" href="#填充方式" data-v-905b99e1>填充方式</a><ul class="level3" data-v-905b99e1><!--[--><!--]--></ul></li><li class="level2" data-v-905b99e1><a class="sidebar-link" href="#工作模式" data-v-905b99e1>工作模式</a><ul class="level3" data-v-905b99e1><!--[--><!--]--></ul></li><li class="level2" data-v-905b99e1><a class="sidebar-link" href="#des" data-v-905b99e1>DES</a><ul class="level3" data-v-905b99e1><!--[--><!--]--></ul></li><li class="level2" data-v-905b99e1><a class="sidebar-link" href="#desede" data-v-905b99e1>DESede</a><ul class="level3" data-v-905b99e1><!--[--><!--]--></ul></li><li class="level2" data-v-905b99e1><a class="sidebar-link" href="#aes" data-v-905b99e1>AES</a><ul class="level3" data-v-905b99e1><!--[--><!--]--></ul></li><li class="level2" data-v-905b99e1><a class="sidebar-link" href="#peb" data-v-905b99e1>PEB</a><ul class="level3" data-v-905b99e1><!--[--><!--]--></ul></li><!--]--></ul></section></div><div class="sidebar_bottom card_border" data-v-e01a06ce><div class="avatar" style="background-image:url(/assets/imgs/avatar.jpg);" data-v-e01a06ce></div><div class="author" data-v-e01a06ce>Leopold</div><div class="summary" data-v-e01a06ce><div data-v-e01a06ce><p data-v-e01a06ce>文章</p></div><div data-v-e01a06ce><p data-v-e01a06ce>分类</p></div><div data-v-e01a06ce><p data-v-e01a06ce>标签</p></div><div data-v-e01a06ce><p data-v-e01a06ce>15</p></div><div data-v-e01a06ce><p data-v-e01a06ce>9</p></div><div data-v-e01a06ce><p data-v-e01a06ce>24</p></div></div><div class="connection" data-v-e01a06ce><div class="grid_icon" data-v-e01a06ce><svg viewbox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon" data-v-e01a06ce><path d="M1023.560892 524.587752c0 114.331752-32.549236 217.148443-97.647709 308.450075-65.047295 91.301632-149.132822 154.455339-252.205404 189.512299-11.975662 2.303012-20.778286 0.716493-26.305515-4.759558a27.584966 27.584966 0 0 1-8.342021-20.471218V853.150798c0-44.166653-11.566238-76.511177-34.647536-96.982394a446.272549 446.272549 0 0 0 68.32269-12.282731c20.16415-5.476051 41.044792-14.329852 62.590748-26.612583a187.311643 187.311643 0 0 0 53.992837-45.446104c14.432209-18.014672 26.203159-41.914819 35.312851-71.751618 9.109692-29.8368 13.664538-64.074912 13.664538-102.765514 0-55.118754-17.554069-102.049021-52.61103-140.739623 16.376974-41.454216 14.636921-87.872703-5.373695-139.357815-12.436265-4.094244-30.399759-1.535341-53.941659 7.523172a355.17563 355.17563 0 0 0-61.311297 30.041513l-25.333132 16.376974a462.137743 462.137743 0 0 0-127.945112-17.707604 462.137743 462.137743 0 0 0-127.945111 17.758782 589.571074 589.571074 0 0 0-28.301459-18.424096c-11.77095-7.31846-30.34858-16.069906-55.681713-26.305515-25.281954-10.235609-44.422543-13.306292-57.31941-9.212048-19.498835 51.433935-21.085354 97.852421-4.606024 139.306637-35.108139 38.690602-52.713386 85.620869-52.713386 140.739623 0 38.690602 4.606024 72.826357 13.715716 102.458445 9.109692 29.58091 20.778286 53.481057 34.954605 71.700441a180.658498 180.658498 0 0 0 53.634591 45.753172c21.545957 12.282731 42.477777 21.18771 62.641926 26.612583 20.215328 5.527229 42.989557 9.621472 68.32269 12.333909-17.758781 16.376974-28.659705 39.867697-32.651593 70.369811a129.941055 129.941055 0 0 1-29.990334 10.235609 184.087426 184.087426 0 0 1-37.974109 3.428929c-14.688099 0-29.171485-4.913092-43.654872-14.688099-14.432209-9.826185-26.766117-24.053681-37.001726-42.682489a109.162769 109.162769 0 0 0-32.293346-35.517563c-13.101579-9.109692-24.104859-14.585743-33.009839-16.376974l-13.306292-2.047122c-9.314404 0-15.762838 1.023561-19.345301 3.070683-3.582463 2.047122-4.606024 4.606024-3.326572 7.83024a37.769397 37.769397 0 0 0 5.987831 9.570295 49.182101 49.182101 0 0 0 8.700267 8.188487l4.606024 3.377751c9.826185 4.606024 19.447657 13.255114 29.017952 25.998447 9.570294 12.743333 16.581686 24.360749 20.982998 34.80107l6.653146 15.71166c5.783119 17.298179 15.558126 31.320963 29.376197 42.017174 13.766894 10.747389 28.659705 17.554069 44.627255 20.471218 15.96755 2.968327 31.423319 4.606024 46.316131 4.810736 14.841633 0.204712 27.22672-0.562958 37.001726-2.405368l15.302235-2.712436c0 17.298179 0.102356 37.564685 0.358247 60.799517l0.307068 36.848192c0 8.188487-2.86597 15.046345-8.700268 20.471218-5.731941 5.527229-14.636921 7.113748-26.612583 4.810736-103.072582-35.056961-187.158109-98.261846-252.205404-189.512299C32.549236 741.736195 0 638.919504 0 524.587752c0-95.191163 22.876586-182.910331 68.629758-263.31104a516.028224 516.028224 0 0 1 186.288082-190.894106A491.309228 491.309228 0 0 1 511.780446 0.012795a491.309228 491.309228 0 0 1 256.913784 70.369811 516.028224 516.028224 0 0 1 186.236905 190.894106C1000.684306 341.626242 1023.560892 429.447767 1023.560892 524.587752z"></path></svg></div><div data-v-e01a06ce><span data-v-e01a06ce>github.com/SayNop</span></div><div class="grid_icon" data-v-e01a06ce><svg viewbox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon" data-v-e01a06ce><path d="M512 1024C229.222 1024 0 794.778 0 512S229.222 0 512 0s512 229.222 512 512-229.222 512-512 512z m259.149-568.883h-290.74a25.293 25.293 0 0 0-25.292 25.293l-0.026 63.206c0 13.952 11.315 25.293 25.267 25.293h177.024c13.978 0 25.293 11.315 25.293 25.267v12.646a75.853 75.853 0 0 1-75.853 75.853h-240.23a25.293 25.293 0 0 1-25.267-25.293V417.203a75.853 75.853 0 0 1 75.827-75.853h353.946a25.293 25.293 0 0 0 25.267-25.292l0.077-63.207a25.293 25.293 0 0 0-25.268-25.293H417.152a189.62 189.62 0 0 0-189.62 189.645V771.15c0 13.977 11.316 25.293 25.294 25.293h372.94a170.65 170.65 0 0 0 170.65-170.65V480.384a25.293 25.293 0 0 0-25.293-25.267z"></path></svg></div><div data-v-e01a06ce><span data-v-e01a06ce>gitee.com/WhenTimeGoesBy</span></div><!-- <div class="grid_icon"><mail_icon class="icon" /></div><div><span @click="open_link(themeData.connection_link.mail)">{{ themeData.connection_link.mail }}</span></div> --><div class="grid_icon" data-v-e01a06ce><svg viewbox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon" data-v-e01a06ce><path d="M874.666667 181.333333H149.333333c-40.533333 0-74.666667 34.133333-74.666666 74.666667v512c0 40.533333 34.133333 74.666667 74.666666 74.666667h725.333334c40.533333 0 74.666667-34.133333 74.666666-74.666667V256c0-40.533333-34.133333-74.666667-74.666666-74.666667z m-725.333334 64h725.333334c6.4 0 10.666667 4.266667 10.666666 10.666667v25.6L512 516.266667l-373.333333-234.666667V256c0-6.4 4.266667-10.666667 10.666666-10.666667z m725.333334 533.333334H149.333333c-6.4 0-10.666667-4.266667-10.666666-10.666667V356.266667l356.266666 224c4.266667 4.266667 10.666667 4.266667 17.066667 4.266666s12.8-2.133333 17.066667-4.266666l356.266666-224V768c0 6.4-4.266667 10.666667-10.666666 10.666667z"></path></svg></div><div data-v-e01a06ce><a href="mailto:fur999immer@gmail.com" data-v-e01a06ce>fur999immer@gmail.com</a></div></div></div></div></div><div class="content_container"><!--[--><div class="card_border article_container" data-v-77edf713><div class="frontmatter_info" data-v-77edf713><h1 data-v-77edf713>对称加密算法</h1><div data-v-77edf713>2024-04-13</div><div class="card_tag frontmatter_tags" data-v-77edf713><span class="icon" data-v-77edf713><svg viewbox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" data-v-77edf713><path d="M896 682.666667a42.666667 42.666667 0 0 0-42.666667-42.666667h-85.333333v-85.333333a85.333333 85.333333 0 0 0-85.333333-85.333334h-128V384h85.333333a42.666667 42.666667 0 0 0 42.666667-42.666667V170.666667a42.666667 42.666667 0 0 0-42.666667-42.666667H384a42.666667 42.666667 0 0 0-42.666667 42.666667v170.666666a42.666667 42.666667 0 0 0 42.666667 42.666667h85.333333v85.333333H341.333333a85.333333 85.333333 0 0 0-85.333333 85.333334v85.333333H170.666667a42.666667 42.666667 0 0 0-42.666667 42.666667v170.666666a42.666667 42.666667 0 0 0 42.666667 42.666667h256a42.666667 42.666667 0 0 0 42.666666-42.666667v-170.666666a42.666667 42.666667 0 0 0-42.666666-42.666667H341.333333v-85.333333h341.333334v85.333333h-85.333334a42.666667 42.666667 0 0 0-42.666666 42.666667v170.666666a42.666667 42.666667 0 0 0 42.666666 42.666667h256a42.666667 42.666667 0 0 0 42.666667-42.666667z"></path></svg></span><!--[--><!-- 使用冒泡stop，阻止父组件的跳转覆盖子组件 --><span class="article_category" data-v-77edf713 data-v-c2920afd>Cryptography</span><!--]--><span class="icon" style="margin-right:5px;" data-v-77edf713><svg viewbox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" data-v-77edf713><path d="M985.6 473.6 985.6 473.6l-256 256-256 256 0 0C454.4 1011.2 422.4 1024 384 1024c-38.4 0-70.4-12.8-89.6-38.4l0 0-256-256 0 0C12.8 710.4 0 678.4 0 640c0-38.4 12.8-70.4 38.4-89.6l0 0 256-256 256-256 0 0C569.6 12.8 601.6 0 640 0l256 0c70.4 0 128 57.6 128 128l0 256C1024 422.4 1011.2 454.4 985.6 473.6zM768 128c-70.4 0-128 57.6-128 128 0 70.4 57.6 128 128 128 70.4 0 128-57.6 128-128C896 185.6 838.4 128 768 128z"></path></svg></span><!--[--><!--[--><!-- 使用冒泡stop，阻止父组件的跳转覆盖子组件 --><span class="article_tag" data-v-77edf713 data-v-15d5095d>Cryptography</span><!--]--><!--[--><!-- 使用冒泡stop，阻止父组件的跳转覆盖子组件 --><span class="article_tag" data-v-77edf713 data-v-15d5095d>DES</span><!--]--><!--[--><!-- 使用冒泡stop，阻止父组件的跳转覆盖子组件 --><span class="article_tag" data-v-77edf713 data-v-15d5095d>AES</span><!--]--><!--]--></div></div><div data-v-77edf713><h2 id="简介" tabindex="-1"><a class="header-anchor" href="#简介" aria-hidden="true">#</a> 简介</h2><p>双方使用相同的密钥对明文进行加解密。常见算法DES，DESede（3DES），AES，IDEA等。优点：计算量小，速度快，效率高。缺点：双方使用相同密钥，安全性难以保证；每对用户使用不同密钥时，在分布式等场景下的密钥管理难度高，使用成本高</p><h2 id="填充方式" tabindex="-1"><a class="header-anchor" href="#填充方式" aria-hidden="true">#</a> 填充方式</h2><p>DES算法以64位（8字节）进行分组加密，对最后一组不足64位的内容，可进行填充处理使其为8字节。常见填充方式如下</p><ul><li>NoPadding：不填充</li><li>ZerosPadding：0填充</li><li>PKCS5Padding：以填充字节数为值对目标字符串进行填充，如 <code>F9</code> 需填充7字节，填充后 <code>F9 07 07 07 07 07 07 07</code>）。如果明文最后一组刚好为64位，则需填充一组 <code>08 08 08 08 08 08 08 08</code> ，且明文长度需要 +8 字节</li></ul><h2 id="工作模式" tabindex="-1"><a class="header-anchor" href="#工作模式" aria-hidden="true">#</a> 工作模式</h2><p>对称加密算法工作模式（分组模式）：其中最常用ECB与CBC。图片源自<a href="https://zh.wikipedia.org/wiki/%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F" target="_blank" rel="noopener noreferrer">wikipedia - 分组密码工作模式<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>，图示说明：分组加密需要两个输入，其中一个为密钥，得到一个输出块</p><ul><li><p>ECB模式（Electronic Code Book 电子密码本）：明文分为固定大小的块，每块独立进行分组加密</p><img src="https://upload.wikimedia.org/wikipedia/commons/c/c4/Ecb_encryption.png"></li><li><p>CBC模式（Cipher-block Chaining 密码块链）：每个明文块与前一轮输出块进行异或后再进行分组加密，加密块作为输出块。由于第一个块没有前一轮的输出，需要一个初始向量 (IV) 进行异或</p><img src="https://upload.wikimedia.org/wikipedia/commons/d/d3/Cbc_encryption.png"></li><li><p>CFB模式（Cipher Feedback 密码反馈）：将前一轮输出块进行分组加密，加密块再与当前明文块进行异或，作为本轮的输出块。由于第一个块没有前一轮的输出，也需要一个初始向量 (IV) 进行异或</p><img src="https://upload.wikimedia.org/wikipedia/commons/f/fd/Cfb_encryption.png"></li><li><p>OFB模式（Output Feedback 输出反馈）：将IV直接进行分组加密，得到新的密钥作为下一轮的输入。每轮输出内容是加密块与明文块异或的结果作为密文块</p><img src="https://upload.wikimedia.org/wikipedia/commons/a/a9/Ofb_encryption.png"></li><li><p>CTR模式（Counter 计数器）：将计数器通过密钥进行分组加密，结果再与明文异或作为输出</p><img src="https://upload.wikimedia.org/wikipedia/commons/3/3f/Ctr_encryption.png"></li><li><p>GCM模式（Galois/Counter Mode）</p></li></ul><h2 id="des" tabindex="-1"><a class="header-anchor" href="#des" aria-hidden="true">#</a> DES</h2><p>DES，即数据加密标准（Data Encrypt Standard），密钥长度56位，由于密钥的每个第八位需为奇偶校验位，因此密钥对外展现的长度为64位</p><ul><li><p>DES算法消息传递流程</p><ul><li>消息传递双方同步密钥（单方生成 或 协商生成 等，生成后向未知方公布密钥）</li><li>发送者使用密钥对消息加密得到密文</li><li>发送者发送加密数据</li><li>接受者使用密钥对密文解密得到明文</li></ul></li><li><p>实现流程：将64位明文块通过64位密钥转变成64位密文块</p><ul><li><p>初始置换（IP）：64位分组数据块，通过一定规则对位的顺序进行对调，并拆成两个32位子分组：左32位 - L0、右32位- R0（input64bit = D1D2D3...D64 -&gt; L0 = D58D50...D8; R0 = D57D49...D7）</p><table><tr><th></th><th colspan="8">IP置换表</th></tr><tr><th rowspan="4">左32位</th><td>58</td><td>50</td><td>42</td><td>34</td><td>26</td><td>18</td><td>10</td><td>02</td></tr><tr><td>60</td><td>52</td><td>44</td><td>36</td><td>28</td><td>20</td><td>12</td><td>04</td></tr><tr><td>62</td><td>54</td><td>46</td><td>38</td><td>30</td><td>22</td><td>14</td><td>06</td></tr><tr><td>64</td><td>56</td><td>48</td><td>40</td><td>32</td><td>24</td><td>16</td><td>08</td></tr><tr><th rowspan="4">右32位</th><td>57</td><td>49</td><td>41</td><td>33</td><td>25</td><td>17</td><td>09</td><td>01</td></tr><tr><td>59</td><td>51</td><td>43</td><td>35</td><td>27</td><td>19</td><td>11</td><td>03</td></tr><tr><td>61</td><td>53</td><td>45</td><td>37</td><td>29</td><td>21</td><td>13</td><td>05</td></tr><tr><td>63</td><td>55</td><td>47</td><td>39</td><td>31</td><td>23</td><td>15</td><td>07</td></tr></table></li><li><p>生成子密钥：DES加密共执行16次迭代，每次迭代过程的数据长度为48位，因此需要计算出16个48位的子密钥</p><ul><li>密钥初始化：通过密钥转换表PC-1对初始密钥进行转换，并进行28位分出2组C0, D0 <table><tr><th></th><th colspan="7">PC-1</th></tr><tr><th rowspan="4">C0</th><td>57</td><td>49</td><td>41</td><td>33</td><td>25</td><td>17</td><td>09</td></tr><tr><td>01</td><td>58</td><td>50</td><td>42</td><td>34</td><td>26</td><td>18</td></tr><tr><td>10</td><td>02</td><td>59</td><td>51</td><td>43</td><td>35</td><td>27</td></tr><tr><td>19</td><td>11</td><td>03</td><td>60</td><td>52</td><td>44</td><td>36</td></tr><tr><th rowspan="4">D0</th><td>63</td><td>55</td><td>47</td><td>39</td><td>31</td><td>23</td><td>15</td></tr><tr><td>07</td><td>62</td><td>54</td><td>46</td><td>38</td><td>30</td><td>22</td></tr><tr><td>14</td><td>06</td><td>61</td><td>53</td><td>45</td><td>37</td><td>29</td></tr><tr><td>21</td><td>13</td><td>05</td><td>28</td><td>20</td><td>12</td><td>04</td></tr></table></li><li>左旋：根据子密钥将参与的计算轮数，对 <!----> 和 <!----> 进行指定位数的左旋（循环左移）得到 <!----> 和 <!----> <table><tr><th>Round</th><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td><td>11</td><td>12</td><td>13</td><td>14</td><td>15</td><td>16</td></tr><tr><th>Rotations</th><td>1</td><td>1</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>1</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>1</td></tr></table></li><li>计算子密钥，合并 <!----> <!---->，后，通过置换选择表PC-2得到第n轮的密钥。其中置换表会丢弃掉9，18，22，25，35，38，43，54位，从而得到置顶轮数的48位密钥 <!----> <table><tr><th colspan="6">PC-2</th></tr><tr><td>14</td><td>17</td><td>11</td><td>24</td><td>01</td><td>05</td></tr><tr><td>03</td><td>28</td><td>15</td><td>06</td><td>21</td><td>10</td></tr><tr><td>23</td><td>19</td><td>12</td><td>04</td><td>26</td><td>08</td></tr><tr><td>16</td><td>07</td><td>27</td><td>20</td><td>13</td><td>02</td></tr><tr><td>41</td><td>52</td><td>31</td><td>37</td><td>47</td><td>55</td></tr><tr><td>30</td><td>40</td><td>51</td><td>45</td><td>33</td><td>48</td></tr><tr><td>44</td><td>49</td><td>39</td><td>56</td><td>34</td><td>53</td></tr><tr><td>46</td><td>42</td><td>50</td><td>36</td><td>29</td><td>32</td></tr></table></li></ul></li><li><p>迭代：迭代需要进行16次，数据长度为48位。通过初始置换的L0，R0作为输入，最终得到L16，R16。其中三个关键步骤：扩展置换，S-盒替换，P-盒替换，合称为F函数。R直接赋值给下一轮的L，R经过F函数的结果与L异或作为下一轮的R，流程如图</p><img style="width:30%;" src="https://upload.wikimedia.org/wikipedia/commons/6/6a/DES-main-network.png"><ul><li><p>扩展置换：将数据 <!----> 通过 扩展置换表E ，将32位扩展为48位得到 <!----> ,用于与密钥 <!----> 进行异或，得到 <!----></p><table><tr><th>扩展位</th><th colspan="4"></th><th>扩展位</th></tr><tr><td>32</td><td>01</td><td>02</td><td>03</td><td>04</td><td>05</td></tr><tr><td>04</td><td>05</td><td>06</td><td>07</td><td>08</td><td>09</td></tr><tr><td>08</td><td>09</td><td>10</td><td>11</td><td>12</td><td>13</td></tr><tr><td>12</td><td>13</td><td>14</td><td>15</td><td>16</td><td>17</td></tr><tr><td>16</td><td>17</td><td>18</td><td>19</td><td>20</td><td>21</td></tr><tr><td>20</td><td>21</td><td>22</td><td>23</td><td>24</td><td>25</td></tr><tr><td>24</td><td>25</td><td>26</td><td>27</td><td>28</td><td>29</td></tr><tr><td>28</td><td>29</td><td>30</td><td>31</td><td>32</td><td>01</td></tr></table></li><li><p>S盒替换：将48位 <!----> 数据按照每6位切分，共8组。经过8个S盒，每个S盒6位输入，4位输出，得到32位数据。6位数据第一位与最后一位组成行索引，其余4位组成列索引。例如 <code>110111</code> 得到行号 <code>11</code> 即3，列号 <code>1011</code> 即11，以S-Box1为例 <code>[3][11]</code> 得到14，即S盒输出<code>1110</code></p><table><tr><th>Col</th><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td><td>11</td><td>12</td><td>13</td><td>14</td><td>15</td></tr><tr><th rowspan="4">S-Box1</th><td>14</td><td>04</td><td>13</td><td>01</td><td>02</td><td>15</td><td>11</td><td>08</td><td>03</td><td>10</td><td>06</td><td>12</td><td>05</td><td>09</td><td>00</td><td>07</td></tr><tr><td>00</td><td>15</td><td>07</td><td>04</td><td>14</td><td>02</td><td>13</td><td>01</td><td>10</td><td>06</td><td>12</td><td>11</td><td>09</td><td>05</td><td>03</td><td>08</td></tr><tr><td>04</td><td>01</td><td>14</td><td>08</td><td>13</td><td>06</td><td>02</td><td>11</td><td>15</td><td>12</td><td>09</td><td>07</td><td>03</td><td>10</td><td>05</td><td>00</td></tr><tr><td>15</td><td>12</td><td>08</td><td>02</td><td>04</td><td>09</td><td>01</td><td>07</td><td>05</td><td>11</td><td>03</td><td>14</td><td>10</td><td>00</td><td>06</td><td>13</td></tr><tr><th rowspan="4">S-Box2</th><td>15</td><td>01</td><td>08</td><td>14</td><td>06</td><td>11</td><td>03</td><td>04</td><td>09</td><td>07</td><td>02</td><td>13</td><td>12</td><td>00</td><td>05</td><td>10</td></tr><tr><td>03</td><td>13</td><td>04</td><td>07</td><td>15</td><td>02</td><td>08</td><td>14</td><td>12</td><td>00</td><td>01</td><td>10</td><td>06</td><td>09</td><td>11</td><td>05</td></tr><tr><td>00</td><td>14</td><td>07</td><td>11</td><td>10</td><td>04</td><td>13</td><td>01</td><td>05</td><td>08</td><td>12</td><td>06</td><td>09</td><td>03</td><td>02</td><td>15</td></tr><tr><td>13</td><td>08</td><td>10</td><td>01</td><td>03</td><td>15</td><td>04</td><td>02</td><td>11</td><td>06</td><td>07</td><td>12</td><td>00</td><td>05</td><td>14</td><td>09</td></tr><tr><th rowspan="4">S-Box3</th><td>10</td><td>00</td><td>09</td><td>14</td><td>06</td><td>03</td><td>15</td><td>05</td><td>01</td><td>13</td><td>12</td><td>07</td><td>11</td><td>04</td><td>02</td><td>08</td></tr><tr><td>13</td><td>07</td><td>00</td><td>09</td><td>03</td><td>04</td><td>06</td><td>10</td><td>02</td><td>08</td><td>05</td><td>14</td><td>12</td><td>11</td><td>15</td><td>01</td></tr><tr><td>13</td><td>06</td><td>04</td><td>09</td><td>08</td><td>15</td><td>03</td><td>00</td><td>11</td><td>01</td><td>02</td><td>12</td><td>05</td><td>10</td><td>14</td><td>07</td></tr><tr><td>01</td><td>10</td><td>13</td><td>00</td><td>06</td><td>09</td><td>08</td><td>07</td><td>04</td><td>15</td><td>14</td><td>03</td><td>11</td><td>05</td><td>02</td><td>12</td></tr><tr><th rowspan="4">S-Box4</th><td>07</td><td>13</td><td>14</td><td>03</td><td>00</td><td>06</td><td>09</td><td>10</td><td>01</td><td>02</td><td>08</td><td>05</td><td>11</td><td>12</td><td>04</td><td>15</td></tr><tr><td>13</td><td>08</td><td>11</td><td>05</td><td>06</td><td>15</td><td>00</td><td>03</td><td>04</td><td>07</td><td>02</td><td>12</td><td>01</td><td>10</td><td>14</td><td>09</td></tr><tr><td>10</td><td>06</td><td>09</td><td>00</td><td>12</td><td>11</td><td>07</td><td>13</td><td>15</td><td>01</td><td>03</td><td>14</td><td>05</td><td>02</td><td>08</td><td>04</td></tr><tr><td>03</td><td>15</td><td>00</td><td>06</td><td>10</td><td>01</td><td>13</td><td>08</td><td>09</td><td>04</td><td>05</td><td>11</td><td>12</td><td>07</td><td>02</td><td>14</td></tr><tr><th rowspan="4">S-Box5</th><td>02</td><td>12</td><td>04</td><td>01</td><td>07</td><td>10</td><td>11</td><td>06</td><td>08</td><td>05</td><td>03</td><td>15</td><td>13</td><td>00</td><td>14</td><td>09</td></tr><tr><td>14</td><td>11</td><td>02</td><td>12</td><td>04</td><td>07</td><td>13</td><td>01</td><td>05</td><td>00</td><td>15</td><td>10</td><td>03</td><td>09</td><td>08</td><td>06</td></tr><tr><td>04</td><td>02</td><td>01</td><td>11</td><td>10</td><td>13</td><td>07</td><td>08</td><td>15</td><td>09</td><td>12</td><td>05</td><td>06</td><td>03</td><td>00</td><td>14</td></tr><tr><td>11</td><td>08</td><td>12</td><td>07</td><td>01</td><td>14</td><td>02</td><td>13</td><td>06</td><td>15</td><td>00</td><td>09</td><td>10</td><td>04</td><td>05</td><td>03</td></tr><tr><th rowspan="4">S-Box6</th><td>12</td><td>01</td><td>10</td><td>15</td><td>09</td><td>02</td><td>06</td><td>08</td><td>00</td><td>13</td><td>03</td><td>04</td><td>14</td><td>07</td><td>05</td><td>11</td></tr><tr><td>10</td><td>15</td><td>04</td><td>02</td><td>07</td><td>12</td><td>09</td><td>05</td><td>06</td><td>01</td><td>13</td><td>14</td><td>00</td><td>11</td><td>03</td><td>08</td></tr><tr><td>09</td><td>14</td><td>15</td><td>05</td><td>02</td><td>08</td><td>12</td><td>03</td><td>07</td><td>00</td><td>04</td><td>10</td><td>01</td><td>13</td><td>11</td><td>06</td></tr><tr><td>04</td><td>03</td><td>02</td><td>12</td><td>09</td><td>05</td><td>15</td><td>10</td><td>11</td><td>14</td><td>01</td><td>07</td><td>06</td><td>00</td><td>08</td><td>13</td></tr><tr><th rowspan="4">S-Box7</th><td>04</td><td>11</td><td>02</td><td>14</td><td>15</td><td>00</td><td>08</td><td>13</td><td>03</td><td>12</td><td>09</td><td>07</td><td>05</td><td>10</td><td>06</td><td>01</td></tr><tr><td>13</td><td>00</td><td>11</td><td>07</td><td>04</td><td>09</td><td>01</td><td>10</td><td>14</td><td>03</td><td>05</td><td>12</td><td>02</td><td>15</td><td>08</td><td>06</td></tr><tr><td>01</td><td>04</td><td>11</td><td>13</td><td>12</td><td>03</td><td>07</td><td>14</td><td>10</td><td>15</td><td>06</td><td>08</td><td>00</td><td>05</td><td>09</td><td>02</td></tr><tr><td>06</td><td>11</td><td>13</td><td>08</td><td>01</td><td>04</td><td>10</td><td>07</td><td>09</td><td>05</td><td>00</td><td>15</td><td>14</td><td>02</td><td>03</td><td>12</td></tr><tr><th rowspan="4">S-Box8</th><td>13</td><td>02</td><td>08</td><td>04</td><td>06</td><td>15</td><td>11</td><td>01</td><td>10</td><td>09</td><td>03</td><td>14</td><td>05</td><td>00</td><td>12</td><td>07</td></tr><tr><td>01</td><td>15</td><td>13</td><td>08</td><td>10</td><td>03</td><td>07</td><td>04</td><td>12</td><td>05</td><td>06</td><td>11</td><td>00</td><td>14</td><td>09</td><td>02</td></tr><tr><td>07</td><td>11</td><td>04</td><td>01</td><td>09</td><td>12</td><td>14</td><td>02</td><td>00</td><td>06</td><td>10</td><td>13</td><td>15</td><td>03</td><td>05</td><td>08</td></tr><tr><td>02</td><td>01</td><td>14</td><td>07</td><td>04</td><td>10</td><td>08</td><td>13</td><td>15</td><td>12</td><td>09</td><td>00</td><td>03</td><td>05</td><td>06</td><td>11</td></tr></table></li><li><p>P盒替换：将S盒替换的结果在参照 P盒置换表 <code>16,07,20,21,29,12,28,17,01,15,23,26,05,18,31,10,02,08,24,14,32,27,03,09,19,13,30,06,22,11,04,25</code> 得到新的32位数据，此时结果即为该轮（轮数n）下F函数的输出 <!----> 。本轮计算结果即为 <!----></p></li></ul></li><li><p>逆置换：将L16，R16进行逆置换（初始置换的逆运算）<code>40,08,48,16,56,24,64,32,39,07,47,15,55,23,63,31,38,06,46,14,54,22,62,30,37,05,45,13,53,21,61,29,36,04,44,12,52,20,60,28,35,03,43,11,51,19,59,27,34,02,42,10,50,18,58 26,33,01,41,09,49,17,57,25</code>，得到该轮密文块</p></li></ul></li><li><p>特征常量</p><ul><li>S-box: 8个长度64数组, 以下以S-box1为例<div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">]</span>
<span class="token comment"># [hex(num)[2:].upper() for num in numbers]</span>
<span class="token punctuation">[</span><span class="token string">&#39;0xe&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;0x4&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;0xd&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x1&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x2&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0xf&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0xb&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x8&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x3&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0xa&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x6&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0xc&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x5&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x9&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x0&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x7&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x0&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0xf&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x7&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x4&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0xe&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x2&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0xd&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x1&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0xa&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x6&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0xc&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0xb&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x9&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x5&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x3&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x8&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x4&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x1&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0xe&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x8&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0xd&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x6&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x2&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0xb&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0xf&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0xc&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x9&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x7&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x3&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0xa&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x5&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x0&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0xf&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0xc&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x8&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x2&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x4&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x9&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x1&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x7&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x5&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0xb&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x3&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0xe&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0xa&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x0&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0x6&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;0xd&#39;</span><span class="token punctuation">]</span>
<span class="token comment"># hex_values = [format(num, &#39;x&#39;) for num in numbers]</span>
<span class="token comment"># [&#39;&#39;.join(hex_values[i:i+8]) for i in range(0, len(hex_values), 8)]</span>
<span class="token punctuation">[</span><span class="token number">0xe4d12fb8</span><span class="token punctuation">,</span> <span class="token number">0x3a6c5907</span><span class="token punctuation">,</span> <span class="token number">0x0f74e2d1</span><span class="token punctuation">,</span> <span class="token number">0xa6cb9538</span><span class="token punctuation">,</span> <span class="token number">0x41e8d62b</span><span class="token punctuation">,</span> <span class="token number">0xfc973a50</span><span class="token punctuation">,</span> <span class="token number">0xfc824917</span><span class="token punctuation">,</span> <span class="token number">0x5b3ea06d</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token number">3838914488</span><span class="token punctuation">,</span> <span class="token number">980179207</span><span class="token punctuation">,</span> <span class="token number">259318481</span><span class="token punctuation">,</span> <span class="token number">2798359864</span><span class="token punctuation">,</span> <span class="token number">1105778219</span><span class="token punctuation">,</span> <span class="token number">4237769296</span><span class="token punctuation">,</span> <span class="token number">4236396823</span><span class="token punctuation">,</span> <span class="token number">1530830957</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li>P-box: 长度32数组<div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">26</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">31</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">27</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">]</span>
<span class="token comment"># [hex(num)[2:].upper().zfill(2) for num in numbers]</span>
<span class="token punctuation">[</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0x07</span><span class="token punctuation">,</span><span class="token number">0x14</span><span class="token punctuation">,</span><span class="token number">0x15</span><span class="token punctuation">,</span><span class="token number">0x1d</span><span class="token punctuation">,</span><span class="token number">0x0c</span><span class="token punctuation">,</span><span class="token number">0x1c</span><span class="token punctuation">,</span><span class="token number">0x11</span><span class="token punctuation">,</span><span class="token number">0x01</span><span class="token punctuation">,</span><span class="token number">0x0f</span><span class="token punctuation">,</span><span class="token number">0x17</span><span class="token punctuation">,</span><span class="token number">0x1a</span><span class="token punctuation">,</span><span class="token number">0x05</span><span class="token punctuation">,</span><span class="token number">0x12</span><span class="token punctuation">,</span><span class="token number">0x1f</span><span class="token punctuation">,</span><span class="token number">0x0a</span><span class="token punctuation">,</span><span class="token number">0x02</span><span class="token punctuation">,</span><span class="token number">0x08</span><span class="token punctuation">,</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token number">0x0e</span><span class="token punctuation">,</span><span class="token number">0x20</span><span class="token punctuation">,</span><span class="token number">0x1b</span><span class="token punctuation">,</span><span class="token number">0x03</span><span class="token punctuation">,</span><span class="token number">0x09</span><span class="token punctuation">,</span><span class="token number">0x13</span><span class="token punctuation">,</span><span class="token number">0x0d</span><span class="token punctuation">,</span><span class="token number">0x1e</span><span class="token punctuation">,</span><span class="token number">0x06</span><span class="token punctuation">,</span><span class="token number">0x16</span><span class="token punctuation">,</span><span class="token number">0x0b</span><span class="token punctuation">,</span><span class="token number">0x04</span><span class="token punctuation">,</span><span class="token number">0x19</span><span class="token punctuation">]</span>
<span class="token comment"># hex_values = [hex(num)[2:].upper().zfill(2) for num in numbers]</span>
<span class="token comment"># [&#39;&#39;.join(hex_values[i:i+4]) for i in range(0, len(hex_values), 4)]</span>
<span class="token punctuation">[</span><span class="token number">0x10071415</span><span class="token punctuation">,</span><span class="token number">0x1d0c1c11</span><span class="token punctuation">,</span><span class="token number">0x010f171a</span><span class="token punctuation">,</span><span class="token number">0x05121f0a</span><span class="token punctuation">,</span><span class="token number">0x0208180e</span><span class="token punctuation">,</span><span class="token number">0x201b0309</span><span class="token punctuation">,</span><span class="token number">0x130d1e06</span><span class="token punctuation">,</span><span class="token number">0x160b0419</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token number">268899349</span><span class="token punctuation">,</span><span class="token number">487332881</span><span class="token punctuation">,</span><span class="token number">17766170</span><span class="token punctuation">,</span><span class="token number">85073674</span><span class="token punctuation">,</span><span class="token number">34084878</span><span class="token punctuation">,</span><span class="token number">538641161</span><span class="token punctuation">,</span><span class="token number">319626758</span><span class="token punctuation">,</span><span class="token number">369820697</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li>逆S-box<div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">56</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">64</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">39</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">55</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">63</span><span class="token punctuation">,</span><span class="token number">31</span><span class="token punctuation">,</span><span class="token number">38</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">54</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">62</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">37</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">45</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">53</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">61</span><span class="token punctuation">,</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token number">36</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">44</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">52</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">35</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">43</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">51</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">59</span><span class="token punctuation">,</span><span class="token number">27</span><span class="token punctuation">,</span><span class="token number">34</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">42</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">58</span><span class="token punctuation">,</span><span class="token number">26</span><span class="token punctuation">,</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">41</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">57</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">]</span>
<span class="token comment"># [hex(num)[2:].upper().zfill(2) for num in numbers]</span>
<span class="token punctuation">[</span><span class="token number">0x28</span><span class="token punctuation">,</span><span class="token number">0x08</span><span class="token punctuation">,</span><span class="token number">0x30</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0x38</span><span class="token punctuation">,</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token number">0x40</span><span class="token punctuation">,</span><span class="token number">0x20</span><span class="token punctuation">,</span><span class="token number">0x27</span><span class="token punctuation">,</span><span class="token number">0x07</span><span class="token punctuation">,</span><span class="token number">0x2f</span><span class="token punctuation">,</span><span class="token number">0x0f</span><span class="token punctuation">,</span><span class="token number">0x37</span><span class="token punctuation">,</span><span class="token number">0x17</span><span class="token punctuation">,</span><span class="token number">0x3f</span><span class="token punctuation">,</span><span class="token number">0x1f</span><span class="token punctuation">,</span><span class="token number">0x26</span><span class="token punctuation">,</span><span class="token number">0x06</span><span class="token punctuation">,</span><span class="token number">0x2e</span><span class="token punctuation">,</span><span class="token number">0x0e</span><span class="token punctuation">,</span><span class="token number">0x36</span><span class="token punctuation">,</span><span class="token number">0x16</span><span class="token punctuation">,</span><span class="token number">0x3e</span><span class="token punctuation">,</span><span class="token number">0x1e</span><span class="token punctuation">,</span><span class="token number">0x25</span><span class="token punctuation">,</span><span class="token number">0x05</span><span class="token punctuation">,</span><span class="token number">0x2d</span><span class="token punctuation">,</span><span class="token number">0x0d</span><span class="token punctuation">,</span><span class="token number">0x35</span><span class="token punctuation">,</span><span class="token number">0x15</span><span class="token punctuation">,</span><span class="token number">0x3d</span><span class="token punctuation">,</span><span class="token number">0x1d</span><span class="token punctuation">,</span><span class="token number">0x24</span><span class="token punctuation">,</span><span class="token number">0x04</span><span class="token punctuation">,</span><span class="token number">0x2c</span><span class="token punctuation">,</span><span class="token number">0x0c</span><span class="token punctuation">,</span><span class="token number">0x34</span><span class="token punctuation">,</span><span class="token number">0x14</span><span class="token punctuation">,</span><span class="token number">0x3c</span><span class="token punctuation">,</span><span class="token number">0x1c</span><span class="token punctuation">,</span><span class="token number">0x23</span><span class="token punctuation">,</span><span class="token number">0x03</span><span class="token punctuation">,</span><span class="token number">0x2b</span><span class="token punctuation">,</span><span class="token number">0x0b</span><span class="token punctuation">,</span><span class="token number">0x33</span><span class="token punctuation">,</span><span class="token number">0x13</span><span class="token punctuation">,</span><span class="token number">0x3b</span><span class="token punctuation">,</span><span class="token number">0x1b</span><span class="token punctuation">,</span><span class="token number">0x22</span><span class="token punctuation">,</span><span class="token number">0x02</span><span class="token punctuation">,</span><span class="token number">0x2a</span><span class="token punctuation">,</span><span class="token number">0x0a</span><span class="token punctuation">,</span><span class="token number">0x32</span><span class="token punctuation">,</span><span class="token number">0x12</span><span class="token punctuation">,</span><span class="token number">0x3a</span><span class="token punctuation">,</span><span class="token number">0x1a</span><span class="token punctuation">,</span><span class="token number">0x21</span><span class="token punctuation">,</span><span class="token number">0x01</span><span class="token punctuation">,</span><span class="token number">0x29</span><span class="token punctuation">,</span><span class="token number">0x09</span><span class="token punctuation">,</span><span class="token number">0x31</span><span class="token punctuation">,</span><span class="token number">0x11</span><span class="token punctuation">,</span><span class="token number">0x39</span><span class="token punctuation">,</span><span class="token number">0x19</span><span class="token punctuation">]</span>
<span class="token comment"># hex_values = [hex(num)[2:].upper().zfill(2) for num in numbers]</span>
<span class="token comment"># [&#39;&#39;.join(hex_values[i:i+4]) for i in range(0, len(hex_values), 4)]</span>
<span class="token punctuation">[</span><span class="token number">0x28083010</span><span class="token punctuation">,</span><span class="token number">0x38184020</span><span class="token punctuation">,</span><span class="token number">0x27072f0f</span><span class="token punctuation">,</span><span class="token number">0x37173f1f</span><span class="token punctuation">,</span><span class="token number">0x26062e0e</span><span class="token punctuation">,</span><span class="token number">0x36163e1e</span><span class="token punctuation">,</span><span class="token number">0x25052d0d</span><span class="token punctuation">,</span><span class="token number">0x35153d1d</span><span class="token punctuation">,</span><span class="token number">0x24042c0c</span><span class="token punctuation">,</span><span class="token number">0x34143c1c</span><span class="token punctuation">,</span><span class="token number">0x23032b0b</span><span class="token punctuation">,</span><span class="token number">0x33133b1b</span><span class="token punctuation">,</span><span class="token number">0x22022a0a</span><span class="token punctuation">,</span><span class="token number">0x32123a1a</span><span class="token punctuation">,</span><span class="token number">0x21012909</span><span class="token punctuation">,</span><span class="token number">0x31113919</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token number">671625232</span><span class="token punctuation">,</span><span class="token number">941113376</span><span class="token punctuation">,</span><span class="token number">654782223</span><span class="token punctuation">,</span><span class="token number">924270367</span><span class="token punctuation">,</span><span class="token number">637939214</span><span class="token punctuation">,</span><span class="token number">907427358</span><span class="token punctuation">,</span><span class="token number">621096205</span><span class="token punctuation">,</span><span class="token number">890584349</span><span class="token punctuation">,</span><span class="token number">604253196</span><span class="token punctuation">,</span><span class="token number">873741340</span><span class="token punctuation">,</span><span class="token number">587410187</span><span class="token punctuation">,</span><span class="token number">856898331</span><span class="token punctuation">,</span><span class="token number">570567178</span><span class="token punctuation">,</span><span class="token number">840055322</span><span class="token punctuation">,</span><span class="token number">553724169</span><span class="token punctuation">,</span><span class="token number">823212313</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li><li><p>代码</p><ul><li><p>Java API</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span><span class="token class-name">Key</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DES</span> <span class="token punctuation">{</span>  
    <span class="token comment">// 生成二进制密钥</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">initkey</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">{</span>
        <span class="token comment">// 实例化密钥生成器 - 需指定为哪种算法的密钥</span>
        <span class="token class-name">KeyGenerator</span> kg <span class="token operator">=</span> <span class="token class-name">KeyGenerator</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;DES&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        kg<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token number">56</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 初始化密钥长度</span>
        <span class="token class-name">SecretKey</span> secretKey <span class="token operator">=</span> kg<span class="token punctuation">.</span><span class="token function">generateKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 生成密钥</span>
        <span class="token keyword">return</span> secretKey<span class="token punctuation">.</span><span class="token function">getEncoded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 返回二进制编码</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 转换密钥 加解密时调用，将二进制密钥转换为可用密钥</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Key</span> <span class="token function">toKey</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> key<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">// 实例化密钥</span>
        <span class="token class-name">DESKeySpec</span> dks <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DESKeySpec</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 实例化密钥工厂</span>
        <span class="token class-name">SecretKeyFactory</span> keyFactory <span class="token operator">=</span> <span class="token class-name">SecretKeyFactory</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;DES&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 生成密钥</span>
        <span class="token class-name">SecretKey</span> secretKey <span class="token operator">=</span> keyFactory<span class="token punctuation">.</span><span class="token function">generateSecret</span><span class="token punctuation">(</span>dks<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> secretKey<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 加密</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> key<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;DES/ECB/PKCS5Padding&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// &lt;加解密算法&gt;/&lt;工作模式&gt;/&lt;填充方式&gt;</span>
        cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token constant">ENCRYPT_MODE</span><span class="token punctuation">,</span> <span class="token function">toKey</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 初始化，加密模式</span>
        <span class="token keyword">return</span> cipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 解密</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">decrypt</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> key<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;DES/ECB/PKCS5Padding&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// &lt;加解密算法&gt;/&lt;工作模式&gt;/&lt;填充方式&gt;</span>
        cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token constant">DECRYPT_MODE</span><span class="token punctuation">,</span> <span class="token function">toKey</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 初始化，解密模式</span>
        <span class="token keyword">return</span> cipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li></ul><h2 id="desede" tabindex="-1"><a class="header-anchor" href="#desede" aria-hidden="true">#</a> DESede</h2><p>DESede，即三重DES，又称3DES、Triple DES。用于克服DES算法密钥短等因素导致的安全性问题。密钥长度112位或168位（2倍3倍DES密钥长度），提高了安全性，但处理速度慢，计算时间长，效率不高</p><ul><li><p>流程</p><ul><li>DESede3 168位密钥：将密钥拆成3个DES密钥，明文通过三个子密钥进行 <strong>DES加密 -&gt;DES解密 -&gt; DES加密</strong> 得到密文。如果前两个密钥相等，则只有最后一次加密有效，实现了对DES的向下兼容性</li><li>DESede2 112位密钥：将密钥拆成2个DES密钥，明文通过 <strong>密钥1DES加密 -&gt; 密钥2DES解密 -&gt; 密钥1DES加密</strong> 得到密文</li></ul></li><li><p>特征常量</p><ul><li><p>S-box: 8个长度64数组</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756

-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344

520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584

8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928

256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080

536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312

2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154

268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li><li><p>代码</p><ul><li><p>Js实现 参考<a href="https://gist.github.com/dragonwong/1af215e8ca6ef4b11af51d65432f65c4" target="_blank" rel="noopener noreferrer">https://gist.github.com/dragonwong/1af215e8ca6ef4b11af51d65432f65c4<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">des</span> <span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> message<span class="token punctuation">,</span> encrypt<span class="token punctuation">,</span> mode<span class="token punctuation">,</span> iv<span class="token punctuation">,</span> padding</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//declaring this locally speeds things up a bit</span>
    <span class="token comment">// 定义变量 S-盒初始化</span>
    <span class="token keyword">var</span> spfunction1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span> <span class="token punctuation">(</span><span class="token number">0x1010400</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x10000</span><span class="token punctuation">,</span><span class="token number">0x1010404</span><span class="token punctuation">,</span><span class="token number">0x1010004</span><span class="token punctuation">,</span><span class="token number">0x10404</span><span class="token punctuation">,</span><span class="token number">0x4</span><span class="token punctuation">,</span><span class="token number">0x10000</span><span class="token punctuation">,</span><span class="token number">0x400</span><span class="token punctuation">,</span><span class="token number">0x1010400</span><span class="token punctuation">,</span><span class="token number">0x1010404</span><span class="token punctuation">,</span><span class="token number">0x400</span><span class="token punctuation">,</span><span class="token number">0x1000404</span><span class="token punctuation">,</span><span class="token number">0x1010004</span><span class="token punctuation">,</span><span class="token number">0x1000000</span><span class="token punctuation">,</span><span class="token number">0x4</span><span class="token punctuation">,</span><span class="token number">0x404</span><span class="token punctuation">,</span><span class="token number">0x1000400</span><span class="token punctuation">,</span><span class="token number">0x1000400</span><span class="token punctuation">,</span><span class="token number">0x10400</span><span class="token punctuation">,</span><span class="token number">0x10400</span><span class="token punctuation">,</span><span class="token number">0x1010000</span><span class="token punctuation">,</span><span class="token number">0x1010000</span><span class="token punctuation">,</span><span class="token number">0x1000404</span><span class="token punctuation">,</span><span class="token number">0x10004</span><span class="token punctuation">,</span><span class="token number">0x1000004</span><span class="token punctuation">,</span><span class="token number">0x1000004</span><span class="token punctuation">,</span><span class="token number">0x10004</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x404</span><span class="token punctuation">,</span><span class="token number">0x10404</span><span class="token punctuation">,</span><span class="token number">0x1000000</span><span class="token punctuation">,</span><span class="token number">0x10000</span><span class="token punctuation">,</span><span class="token number">0x1010404</span><span class="token punctuation">,</span><span class="token number">0x4</span><span class="token punctuation">,</span><span class="token number">0x1010000</span><span class="token punctuation">,</span><span class="token number">0x1010400</span><span class="token punctuation">,</span><span class="token number">0x1000000</span><span class="token punctuation">,</span><span class="token number">0x1000000</span><span class="token punctuation">,</span><span class="token number">0x400</span><span class="token punctuation">,</span><span class="token number">0x1010004</span><span class="token punctuation">,</span><span class="token number">0x10000</span><span class="token punctuation">,</span><span class="token number">0x10400</span><span class="token punctuation">,</span><span class="token number">0x1000004</span><span class="token punctuation">,</span><span class="token number">0x400</span><span class="token punctuation">,</span><span class="token number">0x4</span><span class="token punctuation">,</span><span class="token number">0x1000404</span><span class="token punctuation">,</span><span class="token number">0x10404</span><span class="token punctuation">,</span><span class="token number">0x1010404</span><span class="token punctuation">,</span><span class="token number">0x10004</span><span class="token punctuation">,</span><span class="token number">0x1010000</span><span class="token punctuation">,</span><span class="token number">0x1000404</span><span class="token punctuation">,</span><span class="token number">0x1000004</span><span class="token punctuation">,</span><span class="token number">0x404</span><span class="token punctuation">,</span><span class="token number">0x10404</span><span class="token punctuation">,</span><span class="token number">0x1010400</span><span class="token punctuation">,</span><span class="token number">0x404</span><span class="token punctuation">,</span><span class="token number">0x1000400</span><span class="token punctuation">,</span><span class="token number">0x1000400</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x10004</span><span class="token punctuation">,</span><span class="token number">0x10400</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x1010004</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> spfunction2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0x7fef7fe0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fff8000</span><span class="token punctuation">,</span><span class="token number">0x8000</span><span class="token punctuation">,</span><span class="token number">0x108020</span><span class="token punctuation">,</span><span class="token number">0x100000</span><span class="token punctuation">,</span><span class="token number">0x20</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fefffe0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fff7fe0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fffffe0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fef7fe0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fef8000</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x80000000</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fff8000</span><span class="token punctuation">,</span><span class="token number">0x100000</span><span class="token punctuation">,</span><span class="token number">0x20</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fefffe0</span><span class="token punctuation">,</span><span class="token number">0x108000</span><span class="token punctuation">,</span><span class="token number">0x100020</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fff7fe0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x80000000</span><span class="token punctuation">,</span><span class="token number">0x8000</span><span class="token punctuation">,</span><span class="token number">0x108020</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7ff00000</span><span class="token punctuation">,</span><span class="token number">0x100020</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fffffe0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x108000</span><span class="token punctuation">,</span><span class="token number">0x8020</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fef8000</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7ff00000</span><span class="token punctuation">,</span><span class="token number">0x8020</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x108020</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fefffe0</span><span class="token punctuation">,</span><span class="token number">0x100000</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fff7fe0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7ff00000</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fef8000</span><span class="token punctuation">,</span><span class="token number">0x8000</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7ff00000</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fff8000</span><span class="token punctuation">,</span><span class="token number">0x20</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fef7fe0</span><span class="token punctuation">,</span><span class="token number">0x108020</span><span class="token punctuation">,</span><span class="token number">0x20</span><span class="token punctuation">,</span><span class="token number">0x8000</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x80000000</span><span class="token punctuation">,</span><span class="token number">0x8020</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fef8000</span><span class="token punctuation">,</span><span class="token number">0x100000</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fffffe0</span><span class="token punctuation">,</span><span class="token number">0x100020</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fff7fe0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fffffe0</span><span class="token punctuation">,</span><span class="token number">0x100020</span><span class="token punctuation">,</span><span class="token number">0x108000</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fff8000</span><span class="token punctuation">,</span><span class="token number">0x8020</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x80000000</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fefffe0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0x7fef7fe0</span><span class="token punctuation">,</span><span class="token number">0x108000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> spfunction3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span> <span class="token punctuation">(</span><span class="token number">0x208</span><span class="token punctuation">,</span><span class="token number">0x8020200</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x8020008</span><span class="token punctuation">,</span><span class="token number">0x8000200</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x20208</span><span class="token punctuation">,</span><span class="token number">0x8000200</span><span class="token punctuation">,</span><span class="token number">0x20008</span><span class="token punctuation">,</span><span class="token number">0x8000008</span><span class="token punctuation">,</span><span class="token number">0x8000008</span><span class="token punctuation">,</span><span class="token number">0x20000</span><span class="token punctuation">,</span><span class="token number">0x8020208</span><span class="token punctuation">,</span><span class="token number">0x20008</span><span class="token punctuation">,</span><span class="token number">0x8020000</span><span class="token punctuation">,</span><span class="token number">0x208</span><span class="token punctuation">,</span><span class="token number">0x8000000</span><span class="token punctuation">,</span><span class="token number">0x8</span><span class="token punctuation">,</span><span class="token number">0x8020200</span><span class="token punctuation">,</span><span class="token number">0x200</span><span class="token punctuation">,</span><span class="token number">0x20200</span><span class="token punctuation">,</span><span class="token number">0x8020000</span><span class="token punctuation">,</span><span class="token number">0x8020008</span><span class="token punctuation">,</span><span class="token number">0x20208</span><span class="token punctuation">,</span><span class="token number">0x8000208</span><span class="token punctuation">,</span><span class="token number">0x20200</span><span class="token punctuation">,</span><span class="token number">0x20000</span><span class="token punctuation">,</span><span class="token number">0x8000208</span><span class="token punctuation">,</span><span class="token number">0x8</span><span class="token punctuation">,</span><span class="token number">0x8020208</span><span class="token punctuation">,</span><span class="token number">0x200</span><span class="token punctuation">,</span><span class="token number">0x8000000</span><span class="token punctuation">,</span><span class="token number">0x8020200</span><span class="token punctuation">,</span><span class="token number">0x8000000</span><span class="token punctuation">,</span><span class="token number">0x20008</span><span class="token punctuation">,</span><span class="token number">0x208</span><span class="token punctuation">,</span><span class="token number">0x20000</span><span class="token punctuation">,</span><span class="token number">0x8020200</span><span class="token punctuation">,</span><span class="token number">0x8000200</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x200</span><span class="token punctuation">,</span><span class="token number">0x20008</span><span class="token punctuation">,</span><span class="token number">0x8020208</span><span class="token punctuation">,</span><span class="token number">0x8000200</span><span class="token punctuation">,</span><span class="token number">0x8000008</span><span class="token punctuation">,</span><span class="token number">0x200</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x8020008</span><span class="token punctuation">,</span><span class="token number">0x8000208</span><span class="token punctuation">,</span><span class="token number">0x20000</span><span class="token punctuation">,</span><span class="token number">0x8000000</span><span class="token punctuation">,</span><span class="token number">0x8020208</span><span class="token punctuation">,</span><span class="token number">0x8</span><span class="token punctuation">,</span><span class="token number">0x20208</span><span class="token punctuation">,</span><span class="token number">0x20200</span><span class="token punctuation">,</span><span class="token number">0x8000008</span><span class="token punctuation">,</span><span class="token number">0x8020000</span><span class="token punctuation">,</span><span class="token number">0x8000208</span><span class="token punctuation">,</span><span class="token number">0x208</span><span class="token punctuation">,</span><span class="token number">0x8020000</span><span class="token punctuation">,</span><span class="token number">0x20208</span><span class="token punctuation">,</span><span class="token number">0x8</span><span class="token punctuation">,</span><span class="token number">0x8020008</span><span class="token punctuation">,</span><span class="token number">0x20200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> spfunction4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span> <span class="token punctuation">(</span><span class="token number">0x802001</span><span class="token punctuation">,</span><span class="token number">0x2081</span><span class="token punctuation">,</span><span class="token number">0x2081</span><span class="token punctuation">,</span><span class="token number">0x80</span><span class="token punctuation">,</span><span class="token number">0x802080</span><span class="token punctuation">,</span><span class="token number">0x800081</span><span class="token punctuation">,</span><span class="token number">0x800001</span><span class="token punctuation">,</span><span class="token number">0x2001</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x802000</span><span class="token punctuation">,</span><span class="token number">0x802000</span><span class="token punctuation">,</span><span class="token number">0x802081</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x800080</span><span class="token punctuation">,</span><span class="token number">0x800001</span><span class="token punctuation">,</span><span class="token number">0x1</span><span class="token punctuation">,</span><span class="token number">0x2000</span><span class="token punctuation">,</span><span class="token number">0x800000</span><span class="token punctuation">,</span><span class="token number">0x802001</span><span class="token punctuation">,</span><span class="token number">0x80</span><span class="token punctuation">,</span><span class="token number">0x800000</span><span class="token punctuation">,</span><span class="token number">0x2001</span><span class="token punctuation">,</span><span class="token number">0x2080</span><span class="token punctuation">,</span><span class="token number">0x800081</span><span class="token punctuation">,</span><span class="token number">0x1</span><span class="token punctuation">,</span><span class="token number">0x2080</span><span class="token punctuation">,</span><span class="token number">0x800080</span><span class="token punctuation">,</span><span class="token number">0x2000</span><span class="token punctuation">,</span><span class="token number">0x802080</span><span class="token punctuation">,</span><span class="token number">0x802081</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0x800080</span><span class="token punctuation">,</span><span class="token number">0x800001</span><span class="token punctuation">,</span><span class="token number">0x802000</span><span class="token punctuation">,</span><span class="token number">0x802081</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x802000</span><span class="token punctuation">,</span><span class="token number">0x2080</span><span class="token punctuation">,</span><span class="token number">0x800080</span><span class="token punctuation">,</span><span class="token number">0x800081</span><span class="token punctuation">,</span><span class="token number">0x1</span><span class="token punctuation">,</span><span class="token number">0x802001</span><span class="token punctuation">,</span><span class="token number">0x2081</span><span class="token punctuation">,</span><span class="token number">0x2081</span><span class="token punctuation">,</span><span class="token number">0x80</span><span class="token punctuation">,</span><span class="token number">0x802081</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0x1</span><span class="token punctuation">,</span><span class="token number">0x2000</span><span class="token punctuation">,</span><span class="token number">0x800001</span><span class="token punctuation">,</span><span class="token number">0x2001</span><span class="token punctuation">,</span><span class="token number">0x802080</span><span class="token punctuation">,</span><span class="token number">0x800081</span><span class="token punctuation">,</span><span class="token number">0x2001</span><span class="token punctuation">,</span><span class="token number">0x2080</span><span class="token punctuation">,</span><span class="token number">0x800000</span><span class="token punctuation">,</span><span class="token number">0x802001</span><span class="token punctuation">,</span><span class="token number">0x80</span><span class="token punctuation">,</span><span class="token number">0x800000</span><span class="token punctuation">,</span><span class="token number">0x2000</span><span class="token punctuation">,</span><span class="token number">0x802080</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> spfunction5 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span> <span class="token punctuation">(</span><span class="token number">0x100</span><span class="token punctuation">,</span><span class="token number">0x2080100</span><span class="token punctuation">,</span><span class="token number">0x2080000</span><span class="token punctuation">,</span><span class="token number">0x42000100</span><span class="token punctuation">,</span><span class="token number">0x80000</span><span class="token punctuation">,</span><span class="token number">0x100</span><span class="token punctuation">,</span><span class="token number">0x40000000</span><span class="token punctuation">,</span><span class="token number">0x2080000</span><span class="token punctuation">,</span><span class="token number">0x40080100</span><span class="token punctuation">,</span><span class="token number">0x80000</span><span class="token punctuation">,</span><span class="token number">0x2000100</span><span class="token punctuation">,</span><span class="token number">0x40080100</span><span class="token punctuation">,</span><span class="token number">0x42000100</span><span class="token punctuation">,</span><span class="token number">0x42080000</span><span class="token punctuation">,</span><span class="token number">0x80100</span><span class="token punctuation">,</span><span class="token number">0x40000000</span><span class="token punctuation">,</span><span class="token number">0x2000000</span><span class="token punctuation">,</span><span class="token number">0x40080000</span><span class="token punctuation">,</span><span class="token number">0x40080000</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x40000100</span><span class="token punctuation">,</span><span class="token number">0x42080100</span><span class="token punctuation">,</span><span class="token number">0x42080100</span><span class="token punctuation">,</span><span class="token number">0x2000100</span><span class="token punctuation">,</span><span class="token number">0x42080000</span><span class="token punctuation">,</span><span class="token number">0x40000100</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x42000000</span><span class="token punctuation">,</span><span class="token number">0x2080100</span><span class="token punctuation">,</span><span class="token number">0x2000000</span><span class="token punctuation">,</span><span class="token number">0x42000000</span><span class="token punctuation">,</span><span class="token number">0x80100</span><span class="token punctuation">,</span><span class="token number">0x80000</span><span class="token punctuation">,</span><span class="token number">0x42000100</span><span class="token punctuation">,</span><span class="token number">0x100</span><span class="token punctuation">,</span><span class="token number">0x2000000</span><span class="token punctuation">,</span><span class="token number">0x40000000</span><span class="token punctuation">,</span><span class="token number">0x2080000</span><span class="token punctuation">,</span><span class="token number">0x42000100</span><span class="token punctuation">,</span><span class="token number">0x40080100</span><span class="token punctuation">,</span><span class="token number">0x2000100</span><span class="token punctuation">,</span><span class="token number">0x40000000</span><span class="token punctuation">,</span><span class="token number">0x42080000</span><span class="token punctuation">,</span><span class="token number">0x2080100</span><span class="token punctuation">,</span><span class="token number">0x40080100</span><span class="token punctuation">,</span><span class="token number">0x100</span><span class="token punctuation">,</span><span class="token number">0x2000000</span><span class="token punctuation">,</span><span class="token number">0x42080000</span><span class="token punctuation">,</span><span class="token number">0x42080100</span><span class="token punctuation">,</span><span class="token number">0x80100</span><span class="token punctuation">,</span><span class="token number">0x42000000</span><span class="token punctuation">,</span><span class="token number">0x42080100</span><span class="token punctuation">,</span><span class="token number">0x2080000</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x40080000</span><span class="token punctuation">,</span><span class="token number">0x42000000</span><span class="token punctuation">,</span><span class="token number">0x80100</span><span class="token punctuation">,</span><span class="token number">0x2000100</span><span class="token punctuation">,</span><span class="token number">0x40000100</span><span class="token punctuation">,</span><span class="token number">0x80000</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x40080000</span><span class="token punctuation">,</span><span class="token number">0x2080100</span><span class="token punctuation">,</span><span class="token number">0x40000100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> spfunction6 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span> <span class="token punctuation">(</span><span class="token number">0x20000010</span><span class="token punctuation">,</span><span class="token number">0x20400000</span><span class="token punctuation">,</span><span class="token number">0x4000</span><span class="token punctuation">,</span><span class="token number">0x20404010</span><span class="token punctuation">,</span><span class="token number">0x20400000</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0x20404010</span><span class="token punctuation">,</span><span class="token number">0x400000</span><span class="token punctuation">,</span><span class="token number">0x20004000</span><span class="token punctuation">,</span><span class="token number">0x404010</span><span class="token punctuation">,</span><span class="token number">0x400000</span><span class="token punctuation">,</span><span class="token number">0x20000010</span><span class="token punctuation">,</span><span class="token number">0x400010</span><span class="token punctuation">,</span><span class="token number">0x20004000</span><span class="token punctuation">,</span><span class="token number">0x20000000</span><span class="token punctuation">,</span><span class="token number">0x4010</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x400010</span><span class="token punctuation">,</span><span class="token number">0x20004010</span><span class="token punctuation">,</span><span class="token number">0x4000</span><span class="token punctuation">,</span><span class="token number">0x404000</span><span class="token punctuation">,</span><span class="token number">0x20004010</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0x20400010</span><span class="token punctuation">,</span><span class="token number">0x20400010</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x404010</span><span class="token punctuation">,</span><span class="token number">0x20404000</span><span class="token punctuation">,</span><span class="token number">0x4010</span><span class="token punctuation">,</span><span class="token number">0x404000</span><span class="token punctuation">,</span><span class="token number">0x20404000</span><span class="token punctuation">,</span><span class="token number">0x20000000</span><span class="token punctuation">,</span><span class="token number">0x20004000</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0x20400010</span><span class="token punctuation">,</span><span class="token number">0x404000</span><span class="token punctuation">,</span><span class="token number">0x20404010</span><span class="token punctuation">,</span><span class="token number">0x400000</span><span class="token punctuation">,</span><span class="token number">0x4010</span><span class="token punctuation">,</span><span class="token number">0x20000010</span><span class="token punctuation">,</span><span class="token number">0x400000</span><span class="token punctuation">,</span><span class="token number">0x20004000</span><span class="token punctuation">,</span><span class="token number">0x20000000</span><span class="token punctuation">,</span><span class="token number">0x4010</span><span class="token punctuation">,</span><span class="token number">0x20000010</span><span class="token punctuation">,</span><span class="token number">0x20404010</span><span class="token punctuation">,</span><span class="token number">0x404000</span><span class="token punctuation">,</span><span class="token number">0x20400000</span><span class="token punctuation">,</span><span class="token number">0x404010</span><span class="token punctuation">,</span><span class="token number">0x20404000</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x20400010</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0x4000</span><span class="token punctuation">,</span><span class="token number">0x20400000</span><span class="token punctuation">,</span><span class="token number">0x404010</span><span class="token punctuation">,</span><span class="token number">0x4000</span><span class="token punctuation">,</span><span class="token number">0x400010</span><span class="token punctuation">,</span><span class="token number">0x20004010</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x20404000</span><span class="token punctuation">,</span><span class="token number">0x20000000</span><span class="token punctuation">,</span><span class="token number">0x400010</span><span class="token punctuation">,</span><span class="token number">0x20004010</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> spfunction7 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span> <span class="token punctuation">(</span><span class="token number">0x200000</span><span class="token punctuation">,</span><span class="token number">0x4200002</span><span class="token punctuation">,</span><span class="token number">0x4000802</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x800</span><span class="token punctuation">,</span><span class="token number">0x4000802</span><span class="token punctuation">,</span><span class="token number">0x200802</span><span class="token punctuation">,</span><span class="token number">0x4200800</span><span class="token punctuation">,</span><span class="token number">0x4200802</span><span class="token punctuation">,</span><span class="token number">0x200000</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x4000002</span><span class="token punctuation">,</span><span class="token number">0x2</span><span class="token punctuation">,</span><span class="token number">0x4000000</span><span class="token punctuation">,</span><span class="token number">0x4200002</span><span class="token punctuation">,</span><span class="token number">0x802</span><span class="token punctuation">,</span><span class="token number">0x4000800</span><span class="token punctuation">,</span><span class="token number">0x200802</span><span class="token punctuation">,</span><span class="token number">0x200002</span><span class="token punctuation">,</span><span class="token number">0x4000800</span><span class="token punctuation">,</span><span class="token number">0x4000002</span><span class="token punctuation">,</span><span class="token number">0x4200000</span><span class="token punctuation">,</span><span class="token number">0x4200800</span><span class="token punctuation">,</span><span class="token number">0x200002</span><span class="token punctuation">,</span><span class="token number">0x4200000</span><span class="token punctuation">,</span><span class="token number">0x800</span><span class="token punctuation">,</span><span class="token number">0x802</span><span class="token punctuation">,</span><span class="token number">0x4200802</span><span class="token punctuation">,</span><span class="token number">0x200800</span><span class="token punctuation">,</span><span class="token number">0x2</span><span class="token punctuation">,</span><span class="token number">0x4000000</span><span class="token punctuation">,</span><span class="token number">0x200800</span><span class="token punctuation">,</span><span class="token number">0x4000000</span><span class="token punctuation">,</span><span class="token number">0x200800</span><span class="token punctuation">,</span><span class="token number">0x200000</span><span class="token punctuation">,</span><span class="token number">0x4000802</span><span class="token punctuation">,</span><span class="token number">0x4000802</span><span class="token punctuation">,</span><span class="token number">0x4200002</span><span class="token punctuation">,</span><span class="token number">0x4200002</span><span class="token punctuation">,</span><span class="token number">0x2</span><span class="token punctuation">,</span><span class="token number">0x200002</span><span class="token punctuation">,</span><span class="token number">0x4000000</span><span class="token punctuation">,</span><span class="token number">0x4000800</span><span class="token punctuation">,</span><span class="token number">0x200000</span><span class="token punctuation">,</span><span class="token number">0x4200800</span><span class="token punctuation">,</span><span class="token number">0x802</span><span class="token punctuation">,</span><span class="token number">0x200802</span><span class="token punctuation">,</span><span class="token number">0x4200800</span><span class="token punctuation">,</span><span class="token number">0x802</span><span class="token punctuation">,</span><span class="token number">0x4000002</span><span class="token punctuation">,</span><span class="token number">0x4200802</span><span class="token punctuation">,</span><span class="token number">0x4200000</span><span class="token punctuation">,</span><span class="token number">0x200800</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x2</span><span class="token punctuation">,</span><span class="token number">0x4200802</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x200802</span><span class="token punctuation">,</span><span class="token number">0x4200000</span><span class="token punctuation">,</span><span class="token number">0x800</span><span class="token punctuation">,</span><span class="token number">0x4000002</span><span class="token punctuation">,</span><span class="token number">0x4000800</span><span class="token punctuation">,</span><span class="token number">0x800</span><span class="token punctuation">,</span><span class="token number">0x200002</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> spfunction8 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span> <span class="token punctuation">(</span><span class="token number">0x10001040</span><span class="token punctuation">,</span><span class="token number">0x1000</span><span class="token punctuation">,</span><span class="token number">0x40000</span><span class="token punctuation">,</span><span class="token number">0x10041040</span><span class="token punctuation">,</span><span class="token number">0x10000000</span><span class="token punctuation">,</span><span class="token number">0x10001040</span><span class="token punctuation">,</span><span class="token number">0x40</span><span class="token punctuation">,</span><span class="token number">0x10000000</span><span class="token punctuation">,</span><span class="token number">0x40040</span><span class="token punctuation">,</span><span class="token number">0x10040000</span><span class="token punctuation">,</span><span class="token number">0x10041040</span><span class="token punctuation">,</span><span class="token number">0x41000</span><span class="token punctuation">,</span><span class="token number">0x10041000</span><span class="token punctuation">,</span><span class="token number">0x41040</span><span class="token punctuation">,</span><span class="token number">0x1000</span><span class="token punctuation">,</span><span class="token number">0x40</span><span class="token punctuation">,</span><span class="token number">0x10040000</span><span class="token punctuation">,</span><span class="token number">0x10000040</span><span class="token punctuation">,</span><span class="token number">0x10001000</span><span class="token punctuation">,</span><span class="token number">0x1040</span><span class="token punctuation">,</span><span class="token number">0x41000</span><span class="token punctuation">,</span><span class="token number">0x40040</span><span class="token punctuation">,</span><span class="token number">0x10040040</span><span class="token punctuation">,</span><span class="token number">0x10041000</span><span class="token punctuation">,</span><span class="token number">0x1040</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x10040040</span><span class="token punctuation">,</span><span class="token number">0x10000040</span><span class="token punctuation">,</span><span class="token number">0x10001000</span><span class="token punctuation">,</span><span class="token number">0x41040</span><span class="token punctuation">,</span><span class="token number">0x40000</span><span class="token punctuation">,</span><span class="token number">0x41040</span><span class="token punctuation">,</span><span class="token number">0x40000</span><span class="token punctuation">,</span><span class="token number">0x10041000</span><span class="token punctuation">,</span><span class="token number">0x1000</span><span class="token punctuation">,</span><span class="token number">0x40</span><span class="token punctuation">,</span><span class="token number">0x10040040</span><span class="token punctuation">,</span><span class="token number">0x1000</span><span class="token punctuation">,</span><span class="token number">0x41040</span><span class="token punctuation">,</span><span class="token number">0x10001000</span><span class="token punctuation">,</span><span class="token number">0x40</span><span class="token punctuation">,</span><span class="token number">0x10000040</span><span class="token punctuation">,</span><span class="token number">0x10040000</span><span class="token punctuation">,</span><span class="token number">0x10040040</span><span class="token punctuation">,</span><span class="token number">0x10000000</span><span class="token punctuation">,</span><span class="token number">0x40000</span><span class="token punctuation">,</span><span class="token number">0x10001040</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x10041040</span><span class="token punctuation">,</span><span class="token number">0x40040</span><span class="token punctuation">,</span><span class="token number">0x10000040</span><span class="token punctuation">,</span><span class="token number">0x10040000</span><span class="token punctuation">,</span><span class="token number">0x10001000</span><span class="token punctuation">,</span><span class="token number">0x10001040</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0x10041040</span><span class="token punctuation">,</span><span class="token number">0x41000</span><span class="token punctuation">,</span><span class="token number">0x41000</span><span class="token punctuation">,</span><span class="token number">0x1040</span><span class="token punctuation">,</span><span class="token number">0x1040</span><span class="token punctuation">,</span><span class="token number">0x40040</span><span class="token punctuation">,</span><span class="token number">0x10000000</span><span class="token punctuation">,</span><span class="token number">0x10041000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//create the 16 or 48 subkeys we will need</span>
    <span class="token comment">// 密钥生成</span>
    <span class="token keyword">var</span> keys <span class="token operator">=</span> <span class="token function">des_createKeys</span> <span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 用于控制加密过程中的循环和数据存储。m 是当前处理的字符索引，left 和 right 用于存储数据块的左右部分</span>
    <span class="token keyword">var</span> m<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> temp<span class="token punctuation">,</span> temp2<span class="token punctuation">,</span> right1<span class="token punctuation">,</span> right2<span class="token punctuation">,</span> left<span class="token punctuation">,</span> right<span class="token punctuation">,</span> looping<span class="token punctuation">;</span>
    <span class="token keyword">var</span> cbcleft<span class="token punctuation">,</span> cbcleft2<span class="token punctuation">,</span> cbcright<span class="token punctuation">,</span> cbcright2
    <span class="token keyword">var</span> endloop<span class="token punctuation">,</span> loopinc<span class="token punctuation">;</span>
    <span class="token keyword">var</span> len <span class="token operator">=</span> message<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">var</span> chunk <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token comment">//set up the loops for single and triple des</span>
    <span class="token comment">// 这里根据密钥的长度判断是使用单重 DES 还是三重 DES，并设置相应的循环顺序</span>
    <span class="token keyword">var</span> iterations <span class="token operator">=</span> keys<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">32</span> <span class="token operator">?</span> <span class="token number">3</span> <span class="token operator">:</span> <span class="token number">9</span><span class="token punctuation">;</span> <span class="token comment">//single or triple des</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>iterations <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        looping <span class="token operator">=</span> encrypt <span class="token operator">?</span> <span class="token keyword">new</span> <span class="token class-name">Array</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Array</span> <span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        looping <span class="token operator">=</span> encrypt <span class="token operator">?</span> <span class="token keyword">new</span> <span class="token class-name">Array</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">96</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Array</span> <span class="token punctuation">(</span><span class="token number">94</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//pad the message depending on the padding parameter</span>
    <span class="token comment">// 填充消息</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>padding <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span>
        message <span class="token operator">+=</span> <span class="token string">&quot;        &quot;</span><span class="token punctuation">;</span> <span class="token comment">//pad the message with spaces</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>padding <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        temp <span class="token operator">=</span> <span class="token number">8</span><span class="token operator">-</span><span class="token punctuation">(</span>len<span class="token operator">%</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span> message <span class="token operator">+=</span> String<span class="token punctuation">.</span><span class="token function">fromCharCode</span> <span class="token punctuation">(</span>temp<span class="token punctuation">,</span>temp<span class="token punctuation">,</span>temp<span class="token punctuation">,</span>temp<span class="token punctuation">,</span>temp<span class="token punctuation">,</span>temp<span class="token punctuation">,</span>temp<span class="token punctuation">,</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>temp<span class="token operator">==</span><span class="token number">8</span><span class="token punctuation">)</span>
            len<span class="token operator">+=</span><span class="token number">8</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token comment">//PKCS7 padding 这里其实只是PKCS5 padding, PKCS5规定采用8位补全，而PKCS7则不确定位数</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>padding<span class="token punctuation">)</span>
        message <span class="token operator">+=</span> <span class="token string">&quot;\0\0\0\0\0\0\0\0&quot;</span><span class="token punctuation">;</span> <span class="token comment">//pad the message out with null bytes</span>

    <span class="token comment">//store the result here</span>
    result <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
    tempresult <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>

    <span class="token comment">// 如果选择了 CBC（Cipher Block Chaining）模式，从初始化向量（IV）中读取并构建 cbcleft 和 cbcright，用于与后续的消息块进行异或操作。</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>mode <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//CBC mode</span>
        cbcleft <span class="token operator">=</span> <span class="token punctuation">(</span>iv<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>m<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>iv<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>m<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>iv<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>m<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> iv<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>m<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cbcright <span class="token operator">=</span> <span class="token punctuation">(</span>iv<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>m<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>iv<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>m<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>iv<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>m<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> iv<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>m<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        m<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//loop through each 64 bit chunk of the message</span>
    <span class="token comment">// 循环处理每个 64 位块</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>m <span class="token operator">&lt;</span> len<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        left <span class="token operator">=</span> <span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>m<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>m<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>m<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> message<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>m<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        right <span class="token operator">=</span> <span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>m<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>m<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>m<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> message<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>m<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//for Cipher Block Chaining mode, xor the message with the previous result</span>
        <span class="token comment">// CBC 模式的异或操作</span>
        <span class="token comment">// 在 CBC 模式下，若是加密，则将当前块与前一个块进行异或；若是解密，则保存当前块以便下一轮使用。</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>mode <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>encrypt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                left <span class="token operator">^=</span> cbcleft<span class="token punctuation">;</span> right <span class="token operator">^=</span> cbcright<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                cbcleft2 <span class="token operator">=</span> cbcleft<span class="token punctuation">;</span> cbcright2 <span class="token operator">=</span> cbcright<span class="token punctuation">;</span> cbcleft <span class="token operator">=</span> left<span class="token punctuation">;</span> cbcright <span class="token operator">=</span> right<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//first each 64 but chunk of the message must be permuted according to IP</span>
        <span class="token comment">// 初始置换 对数据块进行初始置换，增加加密的复杂度</span>
        temp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>left <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">^</span> right<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x0f0f0f0f</span><span class="token punctuation">;</span> right <span class="token operator">^=</span> temp<span class="token punctuation">;</span> left <span class="token operator">^=</span> <span class="token punctuation">(</span>temp <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        temp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>left <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">^</span> right<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x0000ffff</span><span class="token punctuation">;</span> right <span class="token operator">^=</span> temp<span class="token punctuation">;</span> left <span class="token operator">^=</span> <span class="token punctuation">(</span>temp <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        temp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>right <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">^</span> left<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x33333333</span><span class="token punctuation">;</span> left <span class="token operator">^=</span> temp<span class="token punctuation">;</span> right <span class="token operator">^=</span> <span class="token punctuation">(</span>temp <span class="token operator">&lt;&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        temp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>right <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">^</span> left<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x00ff00ff</span><span class="token punctuation">;</span> left <span class="token operator">^=</span> temp<span class="token punctuation">;</span> right <span class="token operator">^=</span> <span class="token punctuation">(</span>temp <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        temp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>left <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">^</span> right<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x55555555</span><span class="token punctuation">;</span> right <span class="token operator">^=</span> temp<span class="token punctuation">;</span> left <span class="token operator">^=</span> <span class="token punctuation">(</span>temp <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        left <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>left <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>left <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        right <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>right <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>right <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//do this either 1 or 3 times for each chunk of the message</span>
        <span class="token comment">// 执行加密或解密操作。根据设定的 S-盒和子密钥，对左右数据块进行多轮变换</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span>iterations<span class="token punctuation">;</span> j<span class="token operator">+=</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            endloop <span class="token operator">=</span> looping<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            loopinc <span class="token operator">=</span> looping<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">//now go through and perform the encryption or decryption</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span>looping<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span> i<span class="token operator">!=</span>endloop<span class="token punctuation">;</span> i<span class="token operator">+=</span>loopinc<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//for efficiency</span>
                right1 <span class="token operator">=</span> right <span class="token operator">^</span> keys<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                right2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>right <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>right <span class="token operator">&lt;&lt;</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> keys<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token comment">//the result is attained by passing these bytes through the S selection functions</span>
                temp <span class="token operator">=</span> left<span class="token punctuation">;</span>
                left <span class="token operator">=</span> right<span class="token punctuation">;</span>
                right <span class="token operator">=</span> temp <span class="token operator">^</span> <span class="token punctuation">(</span>spfunction2<span class="token punctuation">[</span><span class="token punctuation">(</span>right1 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3f</span><span class="token punctuation">]</span> <span class="token operator">|</span> spfunction4<span class="token punctuation">[</span><span class="token punctuation">(</span>right1 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3f</span><span class="token punctuation">]</span>
                    <span class="token operator">|</span> spfunction6<span class="token punctuation">[</span><span class="token punctuation">(</span>right1 <span class="token operator">&gt;&gt;&gt;</span>  <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3f</span><span class="token punctuation">]</span> <span class="token operator">|</span> spfunction8<span class="token punctuation">[</span>right1 <span class="token operator">&amp;</span> <span class="token number">0x3f</span><span class="token punctuation">]</span>
                    <span class="token operator">|</span> spfunction1<span class="token punctuation">[</span><span class="token punctuation">(</span>right2 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3f</span><span class="token punctuation">]</span> <span class="token operator">|</span> spfunction3<span class="token punctuation">[</span><span class="token punctuation">(</span>right2 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3f</span><span class="token punctuation">]</span>
                    <span class="token operator">|</span> spfunction5<span class="token punctuation">[</span><span class="token punctuation">(</span>right2 <span class="token operator">&gt;&gt;&gt;</span>  <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3f</span><span class="token punctuation">]</span> <span class="token operator">|</span> spfunction7<span class="token punctuation">[</span>right2 <span class="token operator">&amp;</span> <span class="token number">0x3f</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            temp <span class="token operator">=</span> left<span class="token punctuation">;</span> left <span class="token operator">=</span> right<span class="token punctuation">;</span> right <span class="token operator">=</span> temp<span class="token punctuation">;</span> <span class="token comment">//unreverse left and right</span>
        <span class="token punctuation">}</span> <span class="token comment">//for either 1 or 3 iterations</span>

        <span class="token comment">//move then each one bit to the right</span>
        left <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>left <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>left <span class="token operator">&lt;&lt;</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        right <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>right <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>right <span class="token operator">&lt;&lt;</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//now perform IP-1, which is IP in the opposite direction</span>
        temp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>left <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">^</span> right<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x55555555</span><span class="token punctuation">;</span> right <span class="token operator">^=</span> temp<span class="token punctuation">;</span> left <span class="token operator">^=</span> <span class="token punctuation">(</span>temp <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        temp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>right <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">^</span> left<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x00ff00ff</span><span class="token punctuation">;</span> left <span class="token operator">^=</span> temp<span class="token punctuation">;</span> right <span class="token operator">^=</span> <span class="token punctuation">(</span>temp <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        temp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>right <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">^</span> left<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x33333333</span><span class="token punctuation">;</span> left <span class="token operator">^=</span> temp<span class="token punctuation">;</span> right <span class="token operator">^=</span> <span class="token punctuation">(</span>temp <span class="token operator">&lt;&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        temp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>left <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">^</span> right<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x0000ffff</span><span class="token punctuation">;</span> right <span class="token operator">^=</span> temp<span class="token punctuation">;</span> left <span class="token operator">^=</span> <span class="token punctuation">(</span>temp <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        temp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>left <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">^</span> right<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x0f0f0f0f</span><span class="token punctuation">;</span> right <span class="token operator">^=</span> temp<span class="token punctuation">;</span> left <span class="token operator">^=</span> <span class="token punctuation">(</span>temp <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//for Cipher Block Chaining mode, xor the message with the previous result</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>mode <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">if</span> <span class="token punctuation">(</span>encrypt<span class="token punctuation">)</span> <span class="token punctuation">{</span>cbcleft <span class="token operator">=</span> left<span class="token punctuation">;</span> cbcright <span class="token operator">=</span> right<span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>left <span class="token operator">^=</span> cbcleft2<span class="token punctuation">;</span> right <span class="token operator">^=</span> cbcright2<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
        tempresult <span class="token operator">+=</span> String<span class="token punctuation">.</span><span class="token function">fromCharCode</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>left<span class="token operator">&gt;&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>left<span class="token operator">&gt;&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>left<span class="token operator">&gt;&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>left <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>right<span class="token operator">&gt;&gt;&gt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>right<span class="token operator">&gt;&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>right<span class="token operator">&gt;&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>right <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        chunk <span class="token operator">+=</span> <span class="token number">8</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>chunk <span class="token operator">==</span> <span class="token number">512</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>result <span class="token operator">+=</span> tempresult<span class="token punctuation">;</span> tempresult <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span> chunk <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token comment">//for every 8 characters, or 64 bits in the message</span>

    <span class="token comment">//return the result as an array</span>
    <span class="token keyword">return</span> result <span class="token operator">+</span> tempresult<span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token comment">//end of des</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li></ul><h2 id="aes" tabindex="-1"><a class="header-anchor" href="#aes" aria-hidden="true">#</a> AES</h2><blockquote><p>由于DES算法漏洞的发现及DESede的低效，诞生了AES（Advanced Encryption Standard 高级数据加密标准）算法。分组长度128位，密钥长度128位或192位或256位。</p><p>AES加密算法的实现成为了其他对称加密算法实现的参考模型，如RC2、RC4、IDEA等</p></blockquote><ul><li><p>加密轮数：每个明文块，会进行指定轮数的加密</p><table><thead><tr><th>密钥位数</th><th>32位比特字</th><th>分组长度32位比特字</th><th>加密轮数</th></tr></thead><tbody><tr><td>128</td><td>4</td><td>4</td><td>10</td></tr><tr><td>192</td><td>6</td><td>4</td><td>12</td></tr><tr><td>256</td><td>8</td><td>4</td><td>14</td></tr></tbody></table></li><li><p>分组加密流程：下面说明128位密钥的一轮分组加密中的操作。参考<a href="https://blog.csdn.net/qq_28205153/article/details/55798628" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/qq_28205153/article/details/55798628<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><ul><li><p>准备工作</p><ul><li><p>128位（128/8=16字节）输入明文（在不同工作模式下，输入内容不一定是待加密原文，后续以“明文”简称）P的每一字节记做P0 P1 P2 ... P15。将明文分组按字节组成矩阵（即状态矩阵）</p><table><tr><td>0x61 (P0 = a)</td><td>0x65 (P4 = e)</td><td>0x69 (P8 = i)</td><td>0x6D (P12 = m)</td></tr><tr><td>0x62 (P1 = b)</td><td>0x66 (P5 = f)</td><td>0x6A (P9 = j)</td><td>0x6E (P13 = n)</td></tr><tr><td>0x63 (P2 = c)</td><td>0x67 (P6 = g)</td><td>0x6B (P10 = k)</td><td>0x6F (P14 = o)</td></tr><tr><td>0x64 (P3 = d)</td><td>0x68 (P7 = h)</td><td>0x6C (P11 = l)</td><td>0x70 (P15 = p)</td></tr></table></li><li><p>密钥K 128位可拆分16个字节，4个字。将其扩展成44个字（44 * 4 * 8=1408位）W[0] ... W[43]，其中W[0] - W[3]为原始密钥K。每4个字分为1组，共11组。第一组即原始密钥K用于初始加密，后面10组用于10轮加密运算的<strong>轮密钥加</strong></p></li><li><p>第一个明文块在开始进行第一次分组加密运算前，先对位与原始密钥进行异或（即先执行一次<strong>轮密钥加</strong>）后，将其作为分组加密的输入。即第一轮分组加密的开头处多了一次轮密钥加</p></li></ul></li><li><p>字节替代</p><ul><li><p>通过查表S盒与逆S盒进行字节代换。下表为S盒，从0-255共256个数字</p><table><thead><tr><th>行/列</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>A</th><th>B</th><th>C</th><th>D</th><th>E</th><th>F</th></tr></thead><tbody><tr><td>0</td><td>0x63</td><td>0x7c</td><td>0x77</td><td>0x7b</td><td>0xf2</td><td>0x6b</td><td>0x6f</td><td>0xc5</td><td>0x30</td><td>0x01</td><td>0x67</td><td>0x2b</td><td>0xfe</td><td>0xd7</td><td>0xab</td><td>0x76</td></tr><tr><td>1</td><td>0xca</td><td>0x82</td><td>0xc9</td><td>0x7d</td><td>0xfa</td><td>0x59</td><td>0x47</td><td>0xf0</td><td>0xad</td><td>0xd4</td><td>0xa2</td><td>0xaf</td><td>0x9c</td><td>0xa4</td><td>0x72</td><td>0xc0</td></tr><tr><td>2</td><td>0xb7</td><td>0xfd</td><td>0x93</td><td>0x26</td><td>0x36</td><td>0x3f</td><td>0xf7</td><td>0xcc</td><td>0x34</td><td>0xa5</td><td>0xe5</td><td>0xf1</td><td>0x71</td><td>0xd8</td><td>0x31</td><td>0x15</td></tr><tr><td>3</td><td>0x04</td><td>0xc7</td><td>0x23</td><td>0xc3</td><td>0x18</td><td>0x96</td><td>0x05</td><td>0x9a</td><td>0x07</td><td>0x12</td><td>0x80</td><td>0xe2</td><td>0xeb</td><td>0x27</td><td>0xb2</td><td>0x75</td></tr><tr><td>4</td><td>0x09</td><td>0x83</td><td>0x2c</td><td>0x1a</td><td>0x1b</td><td>0x6e</td><td>0x5a</td><td>0xa0</td><td>0x52</td><td>0x3b</td><td>0xd6</td><td>0xb3</td><td>0x29</td><td>0xe3</td><td>0x2f</td><td>0x84</td></tr><tr><td>5</td><td>0x53</td><td>0xd1</td><td>0x00</td><td>0xed</td><td>0x20</td><td>0xfc</td><td>0xb1</td><td>0x5b</td><td>0x6a</td><td>0xcb</td><td>0xbe</td><td>0x39</td><td>0x4a</td><td>0x4c</td><td>0x58</td><td>0xcf</td></tr><tr><td>6</td><td>0xd0</td><td>0xef</td><td>0xaa</td><td>0xfb</td><td>0x43</td><td>0x4d</td><td>0x33</td><td>0x85</td><td>0x45</td><td>0xf9</td><td>0x02</td><td>0x7f</td><td>0x50</td><td>0x3c</td><td>0x9f</td><td>0xa8</td></tr><tr><td>7</td><td>0x51</td><td>0xa3</td><td>0x40</td><td>0x8f</td><td>0x92</td><td>0x9d</td><td>0x38</td><td>0xf5</td><td>0xbc</td><td>0xb6</td><td>0xda</td><td>0x21</td><td>0x10</td><td>0xff</td><td>0xf3</td><td>0xd2</td></tr><tr><td>8</td><td>0xcd</td><td>0x0c</td><td>0x13</td><td>0xec</td><td>0x5f</td><td>0x97</td><td>0x44</td><td>0x17</td><td>0xc4</td><td>0xa7</td><td>0x7e</td><td>0x3d</td><td>0x64</td><td>0x5d</td><td>0x19</td><td>0x73</td></tr><tr><td>9</td><td>0x60</td><td>0x81</td><td>0x4f</td><td>0xdc</td><td>0x22</td><td>0x2a</td><td>0x90</td><td>0x88</td><td>0x46</td><td>0xee</td><td>0xb8</td><td>0x14</td><td>0xde</td><td>0x5e</td><td>0x0b</td><td>0xdb</td></tr><tr><td>A</td><td>0xe0</td><td>0x32</td><td>0x3a</td><td>0x0a</td><td>0x49</td><td>0x06</td><td>0x24</td><td>0x5c</td><td>0xc2</td><td>0xd3</td><td>0xac</td><td>0x62</td><td>0x91</td><td>0x95</td><td>0xe4</td><td>0x79</td></tr><tr><td>B</td><td>0xe7</td><td>0xc8</td><td>0x37</td><td>0x6d</td><td>0x8d</td><td>0xd5</td><td>0x4e</td><td>0xa9</td><td>0x6c</td><td>0x56</td><td>0xf4</td><td>0xea</td><td>0x65</td><td>0x7a</td><td>0xae</td><td>0x08</td></tr><tr><td>C</td><td>0xba</td><td>0x78</td><td>0x25</td><td>0x2e</td><td>0x1c</td><td>0xa6</td><td>0xb4</td><td>0xc6</td><td>0xe8</td><td>0xdd</td><td>0x74</td><td>0x1f</td><td>0x4b</td><td>0xbd</td><td>0x8b</td><td>0x8a</td></tr><tr><td>D</td><td>0x70</td><td>0x3e</td><td>0xb5</td><td>0x66</td><td>0x48</td><td>0x03</td><td>0xf6</td><td>0x0e</td><td>0x61</td><td>0x35</td><td>0x57</td><td>0xb9</td><td>0x86</td><td>0xc1</td><td>0x1d</td><td>0x9e</td></tr><tr><td>E</td><td>0xe1</td><td>0xf8</td><td>0x98</td><td>0x11</td><td>0x69</td><td>0xd9</td><td>0x8e</td><td>0x94</td><td>0x9b</td><td>0x1e</td><td>0x87</td><td>0xe9</td><td>0xce</td><td>0x55</td><td>0x28</td><td>0xdf</td></tr><tr><td>F</td><td>0x8c</td><td>0xa1</td><td>0x89</td><td>0x0d</td><td>0xbf</td><td>0xe6</td><td>0x42</td><td>0x68</td><td>0x41</td><td>0x99</td><td>0x2d</td><td>0x0f</td><td>0xb0</td><td>0x54</td><td>0xbb</td><td>0x16</td></tr></tbody></table></li><li><p>高4位作为行值，低4位作为列值，取出S盒或者逆S盒中对应的行的元素作为输出。例如，加密时，待操作字节为0x12,则查S盒的第0x01行和0x02列，得到值0xc9</p></li></ul></li><li><p>行位移：按行号左移指定字节，即第0行左移0字节，第1行左移1字节，第2行左移2字节，第3行左移3字节。逆运算则进行右移</p><table><tr><td>S0</td><td>S4</td><td>S8</td><td>S12</td><td>不位移</td><td>S0</td><td>S4</td><td>S8</td><td>S12</td></tr><tr><td>S1</td><td>S5</td><td>S9</td><td>S13</td><td>左移1</td><td>S5</td><td>S9</td><td>S13</td><td>S1</td></tr><tr><td>S2</td><td>S6</td><td>S10</td><td>S14</td><td>左移2</td><td>S10</td><td>S14</td><td>S2</td><td>S6</td></tr><tr><td>S3</td><td>S7</td><td>S11</td><td>S15</td><td>左移3</td><td>S15</td><td>S3</td><td>S7</td><td>S11</td></tr></table></li><li><p>列混淆：</p><ul><li><p>使用矩阵乘法（对应行与对应列的数字对应相乘后求和）进行运算</p><!----></li><li><p>在计算时，加法用异或表示。乘2（0000 0010）即左移一位，低位补0。如果有溢出（即左移后丢失的高位为1），则将移位后结果在加上（异或）0001 1011为最终乘02的结果。乘03表示为乘02+本身，即乘02的结果再与本身异或，03 * A = 02 * A + A = (02 * A) $ \oplus $ A</p></li><li><p>解密时逆混合矩阵，即正混合矩阵与逆混合矩阵相乘为单位矩阵</p><!----></li></ul></li><li><p>轮密钥加：将待处理的输入矩阵（16*8=128位）的每一位与该轮次密钥（128位）相加（异或）后，得到输出矩阵，即该轮运算的加密结果。如：第一轮结果与W[4]-W[7]异或</p></li></ul></li><li><p>特征: 出现长度256数组，可能是S盒，可能是与S盒计算后的数组</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>// S-box 的直接输出 - 256
[
    99,124,119,123,242,107,111,197,48,1,103,43,99,215,171,118,
    202,130,201,125,250,89,71,240,173,212,162,175,254,164,114,192,
    183,253,147,38,54,63,247,204,52,165,229,241,173,216,49,21,
    4,199,35,195,24,150,5,154,7,18,128,226,54,39,178,117,
    9,131,44,26,27,110,90,160,82,59,214,179,4,227,47,132,
    83,209,0,237,32,252,177,91,106,203,190,57,235,76,88,207,
    208,239,170,251,67,77,51,133,69,249,2,127,82,60,159,168,
    81,163,64,143,146,157,56,245,188,182,218,33,32,255,243,210,
    205,12,19,236,95,151,68,23,196,167,126,61,208,93,25,115,
    96,129,79,220,34,42,144,136,70,238,184,20,80,94,11,219,
    224,50,58,10,73,6,36,92,194,211,172,98,188,149,228,121,
    231,200,55,109,141,213,78,169,108,86,244,234,95,122,174,8,
    186,120,37,46,28,166,180,198,232,221,116,31,96,189,139,138,
    112,62,181,102,72,3,246,14,97,53,87,185,222,193,29,158,
    225,248,152,17,105,217,142,148,155,30,135,233,194,85,40,223,
    140,161,137,13,191,230,66,104,65,153,45,15,141,84,187,22
]
// S-box每4个拼接一个字的输出 64
[1669101435,4067127237,805398315,4275546998,3397568893,4200155120,2916393647,2628022976,3086848806,910161868,883287537,1909993749,80159683,412485018,118653154,3945247349,159591450,460216992,1379653299,702754692,1406206189,553431387,1791737401,1246517455,3505367803,1129132933,1173947007,1346150312,1369653391,2459777269,3166100001,285209554,3440120812,1603748887,3299311165,1683822963,1619087324,573214856,1190049812,3730705371,3761388042,1225139292,3268652130,2442519673,3888658285,2379566761,1817638122,1702538760,3128436014,480687302,3906827295,1270713226,1883157862,1208219150,1630885817,2260802974,3791165457,1775865492,2602469353,3461687519,2359396621,3219538536,1100557583,2958342934]

// 逆S盒
[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p><strong>ecb模式</strong> 待加密前16位字节转成4个大端的int32，用于与密钥W[0]-W[3]的4个int32进行异或</p></li><li><p><strong>cbc模式</strong> 待加密前16位字节跟iv进行异或，再转转成4个大端的int32，与密钥W[0]-W[3]的4个int32进行异或</p></li></ul></li><li><p>代码</p><ul><li><p>C语言实现，同样参考文章<a href="https://blog.csdn.net/qq_28205153/article/details/55798628" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/qq_28205153/article/details/55798628<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;aes.h&quot;</span></span>

<span class="token comment">/**
* S盒
*/</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">int</span> S<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token number">0x63</span><span class="token punctuation">,</span> <span class="token number">0x7c</span><span class="token punctuation">,</span> <span class="token number">0x77</span><span class="token punctuation">,</span> <span class="token number">0x7b</span><span class="token punctuation">,</span> <span class="token number">0xf2</span><span class="token punctuation">,</span> <span class="token number">0x6b</span><span class="token punctuation">,</span> <span class="token number">0x6f</span><span class="token punctuation">,</span> <span class="token number">0xc5</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x67</span><span class="token punctuation">,</span> <span class="token number">0x2b</span><span class="token punctuation">,</span> <span class="token number">0xfe</span><span class="token punctuation">,</span> <span class="token number">0xd7</span><span class="token punctuation">,</span> <span class="token number">0xab</span><span class="token punctuation">,</span> <span class="token number">0x76</span><span class="token punctuation">,</span>
    <span class="token number">0xca</span><span class="token punctuation">,</span> <span class="token number">0x82</span><span class="token punctuation">,</span> <span class="token number">0xc9</span><span class="token punctuation">,</span> <span class="token number">0x7d</span><span class="token punctuation">,</span> <span class="token number">0xfa</span><span class="token punctuation">,</span> <span class="token number">0x59</span><span class="token punctuation">,</span> <span class="token number">0x47</span><span class="token punctuation">,</span> <span class="token number">0xf0</span><span class="token punctuation">,</span> <span class="token number">0xad</span><span class="token punctuation">,</span> <span class="token number">0xd4</span><span class="token punctuation">,</span> <span class="token number">0xa2</span><span class="token punctuation">,</span> <span class="token number">0xaf</span><span class="token punctuation">,</span> <span class="token number">0x9c</span><span class="token punctuation">,</span> <span class="token number">0xa4</span><span class="token punctuation">,</span> <span class="token number">0x72</span><span class="token punctuation">,</span> <span class="token number">0xc0</span><span class="token punctuation">,</span>
    <span class="token number">0xb7</span><span class="token punctuation">,</span> <span class="token number">0xfd</span><span class="token punctuation">,</span> <span class="token number">0x93</span><span class="token punctuation">,</span> <span class="token number">0x26</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0x3f</span><span class="token punctuation">,</span> <span class="token number">0xf7</span><span class="token punctuation">,</span> <span class="token number">0xcc</span><span class="token punctuation">,</span> <span class="token number">0x34</span><span class="token punctuation">,</span> <span class="token number">0xa5</span><span class="token punctuation">,</span> <span class="token number">0xe5</span><span class="token punctuation">,</span> <span class="token number">0xf1</span><span class="token punctuation">,</span> <span class="token number">0x71</span><span class="token punctuation">,</span> <span class="token number">0xd8</span><span class="token punctuation">,</span> <span class="token number">0x31</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">,</span>
    <span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token number">0xc7</span><span class="token punctuation">,</span> <span class="token number">0x23</span><span class="token punctuation">,</span> <span class="token number">0xc3</span><span class="token punctuation">,</span> <span class="token number">0x18</span><span class="token punctuation">,</span> <span class="token number">0x96</span><span class="token punctuation">,</span> <span class="token number">0x05</span><span class="token punctuation">,</span> <span class="token number">0x9a</span><span class="token punctuation">,</span> <span class="token number">0x07</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0xe2</span><span class="token punctuation">,</span> <span class="token number">0xeb</span><span class="token punctuation">,</span> <span class="token number">0x27</span><span class="token punctuation">,</span> <span class="token number">0xb2</span><span class="token punctuation">,</span> <span class="token number">0x75</span><span class="token punctuation">,</span>
    <span class="token number">0x09</span><span class="token punctuation">,</span> <span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0x2c</span><span class="token punctuation">,</span> <span class="token number">0x1a</span><span class="token punctuation">,</span> <span class="token number">0x1b</span><span class="token punctuation">,</span> <span class="token number">0x6e</span><span class="token punctuation">,</span> <span class="token number">0x5a</span><span class="token punctuation">,</span> <span class="token number">0xa0</span><span class="token punctuation">,</span> <span class="token number">0x52</span><span class="token punctuation">,</span> <span class="token number">0x3b</span><span class="token punctuation">,</span> <span class="token number">0xd6</span><span class="token punctuation">,</span> <span class="token number">0xb3</span><span class="token punctuation">,</span> <span class="token number">0x29</span><span class="token punctuation">,</span> <span class="token number">0xe3</span><span class="token punctuation">,</span> <span class="token number">0x2f</span><span class="token punctuation">,</span> <span class="token number">0x84</span><span class="token punctuation">,</span>
    <span class="token number">0x53</span><span class="token punctuation">,</span> <span class="token number">0xd1</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0xed</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0xfc</span><span class="token punctuation">,</span> <span class="token number">0xb1</span><span class="token punctuation">,</span> <span class="token number">0x5b</span><span class="token punctuation">,</span> <span class="token number">0x6a</span><span class="token punctuation">,</span> <span class="token number">0xcb</span><span class="token punctuation">,</span> <span class="token number">0xbe</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">,</span> <span class="token number">0x4a</span><span class="token punctuation">,</span> <span class="token number">0x4c</span><span class="token punctuation">,</span> <span class="token number">0x58</span><span class="token punctuation">,</span> <span class="token number">0xcf</span><span class="token punctuation">,</span>
    <span class="token number">0xd0</span><span class="token punctuation">,</span> <span class="token number">0xef</span><span class="token punctuation">,</span> <span class="token number">0xaa</span><span class="token punctuation">,</span> <span class="token number">0xfb</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0x4d</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x85</span><span class="token punctuation">,</span> <span class="token number">0x45</span><span class="token punctuation">,</span> <span class="token number">0xf9</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0x7f</span><span class="token punctuation">,</span> <span class="token number">0x50</span><span class="token punctuation">,</span> <span class="token number">0x3c</span><span class="token punctuation">,</span> <span class="token number">0x9f</span><span class="token punctuation">,</span> <span class="token number">0xa8</span><span class="token punctuation">,</span>
    <span class="token number">0x51</span><span class="token punctuation">,</span> <span class="token number">0xa3</span><span class="token punctuation">,</span> <span class="token number">0x40</span><span class="token punctuation">,</span> <span class="token number">0x8f</span><span class="token punctuation">,</span> <span class="token number">0x92</span><span class="token punctuation">,</span> <span class="token number">0x9d</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">0xf5</span><span class="token punctuation">,</span> <span class="token number">0xbc</span><span class="token punctuation">,</span> <span class="token number">0xb6</span><span class="token punctuation">,</span> <span class="token number">0xda</span><span class="token punctuation">,</span> <span class="token number">0x21</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0xff</span><span class="token punctuation">,</span> <span class="token number">0xf3</span><span class="token punctuation">,</span> <span class="token number">0xd2</span><span class="token punctuation">,</span>
    <span class="token number">0xcd</span><span class="token punctuation">,</span> <span class="token number">0x0c</span><span class="token punctuation">,</span> <span class="token number">0x13</span><span class="token punctuation">,</span> <span class="token number">0xec</span><span class="token punctuation">,</span> <span class="token number">0x5f</span><span class="token punctuation">,</span> <span class="token number">0x97</span><span class="token punctuation">,</span> <span class="token number">0x44</span><span class="token punctuation">,</span> <span class="token number">0x17</span><span class="token punctuation">,</span> <span class="token number">0xc4</span><span class="token punctuation">,</span> <span class="token number">0xa7</span><span class="token punctuation">,</span> <span class="token number">0x7e</span><span class="token punctuation">,</span> <span class="token number">0x3d</span><span class="token punctuation">,</span> <span class="token number">0x64</span><span class="token punctuation">,</span> <span class="token number">0x5d</span><span class="token punctuation">,</span> <span class="token number">0x19</span><span class="token punctuation">,</span> <span class="token number">0x73</span><span class="token punctuation">,</span>
    <span class="token number">0x60</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0x4f</span><span class="token punctuation">,</span> <span class="token number">0xdc</span><span class="token punctuation">,</span> <span class="token number">0x22</span><span class="token punctuation">,</span> <span class="token number">0x2a</span><span class="token punctuation">,</span> <span class="token number">0x90</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0x46</span><span class="token punctuation">,</span> <span class="token number">0xee</span><span class="token punctuation">,</span> <span class="token number">0xb8</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">,</span> <span class="token number">0xde</span><span class="token punctuation">,</span> <span class="token number">0x5e</span><span class="token punctuation">,</span> <span class="token number">0x0b</span><span class="token punctuation">,</span> <span class="token number">0xdb</span><span class="token punctuation">,</span>
    <span class="token number">0xe0</span><span class="token punctuation">,</span> <span class="token number">0x32</span><span class="token punctuation">,</span> <span class="token number">0x3a</span><span class="token punctuation">,</span> <span class="token number">0x0a</span><span class="token punctuation">,</span> <span class="token number">0x49</span><span class="token punctuation">,</span> <span class="token number">0x06</span><span class="token punctuation">,</span> <span class="token number">0x24</span><span class="token punctuation">,</span> <span class="token number">0x5c</span><span class="token punctuation">,</span> <span class="token number">0xc2</span><span class="token punctuation">,</span> <span class="token number">0xd3</span><span class="token punctuation">,</span> <span class="token number">0xac</span><span class="token punctuation">,</span> <span class="token number">0x62</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0x95</span><span class="token punctuation">,</span> <span class="token number">0xe4</span><span class="token punctuation">,</span> <span class="token number">0x79</span><span class="token punctuation">,</span>
    <span class="token number">0xe7</span><span class="token punctuation">,</span> <span class="token number">0xc8</span><span class="token punctuation">,</span> <span class="token number">0x37</span><span class="token punctuation">,</span> <span class="token number">0x6d</span><span class="token punctuation">,</span> <span class="token number">0x8d</span><span class="token punctuation">,</span> <span class="token number">0xd5</span><span class="token punctuation">,</span> <span class="token number">0x4e</span><span class="token punctuation">,</span> <span class="token number">0xa9</span><span class="token punctuation">,</span> <span class="token number">0x6c</span><span class="token punctuation">,</span> <span class="token number">0x56</span><span class="token punctuation">,</span> <span class="token number">0xf4</span><span class="token punctuation">,</span> <span class="token number">0xea</span><span class="token punctuation">,</span> <span class="token number">0x65</span><span class="token punctuation">,</span> <span class="token number">0x7a</span><span class="token punctuation">,</span> <span class="token number">0xae</span><span class="token punctuation">,</span> <span class="token number">0x08</span><span class="token punctuation">,</span>
    <span class="token number">0xba</span><span class="token punctuation">,</span> <span class="token number">0x78</span><span class="token punctuation">,</span> <span class="token number">0x25</span><span class="token punctuation">,</span> <span class="token number">0x2e</span><span class="token punctuation">,</span> <span class="token number">0x1c</span><span class="token punctuation">,</span> <span class="token number">0xa6</span><span class="token punctuation">,</span> <span class="token number">0xb4</span><span class="token punctuation">,</span> <span class="token number">0xc6</span><span class="token punctuation">,</span> <span class="token number">0xe8</span><span class="token punctuation">,</span> <span class="token number">0xdd</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0x1f</span><span class="token punctuation">,</span> <span class="token number">0x4b</span><span class="token punctuation">,</span> <span class="token number">0xbd</span><span class="token punctuation">,</span> <span class="token number">0x8b</span><span class="token punctuation">,</span> <span class="token number">0x8a</span><span class="token punctuation">,</span>
    <span class="token number">0x70</span><span class="token punctuation">,</span> <span class="token number">0x3e</span><span class="token punctuation">,</span> <span class="token number">0xb5</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0x48</span><span class="token punctuation">,</span> <span class="token number">0x03</span><span class="token punctuation">,</span> <span class="token number">0xf6</span><span class="token punctuation">,</span> <span class="token number">0x0e</span><span class="token punctuation">,</span> <span class="token number">0x61</span><span class="token punctuation">,</span> <span class="token number">0x35</span><span class="token punctuation">,</span> <span class="token number">0x57</span><span class="token punctuation">,</span> <span class="token number">0xb9</span><span class="token punctuation">,</span> <span class="token number">0x86</span><span class="token punctuation">,</span> <span class="token number">0xc1</span><span class="token punctuation">,</span> <span class="token number">0x1d</span><span class="token punctuation">,</span> <span class="token number">0x9e</span><span class="token punctuation">,</span>
    <span class="token number">0xe1</span><span class="token punctuation">,</span> <span class="token number">0xf8</span><span class="token punctuation">,</span> <span class="token number">0x98</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0x69</span><span class="token punctuation">,</span> <span class="token number">0xd9</span><span class="token punctuation">,</span> <span class="token number">0x8e</span><span class="token punctuation">,</span> <span class="token number">0x94</span><span class="token punctuation">,</span> <span class="token number">0x9b</span><span class="token punctuation">,</span> <span class="token number">0x1e</span><span class="token punctuation">,</span> <span class="token number">0x87</span><span class="token punctuation">,</span> <span class="token number">0xe9</span><span class="token punctuation">,</span> <span class="token number">0xce</span><span class="token punctuation">,</span> <span class="token number">0x55</span><span class="token punctuation">,</span> <span class="token number">0x28</span><span class="token punctuation">,</span> <span class="token number">0xdf</span><span class="token punctuation">,</span>
    <span class="token number">0x8c</span><span class="token punctuation">,</span> <span class="token number">0xa1</span><span class="token punctuation">,</span> <span class="token number">0x89</span><span class="token punctuation">,</span> <span class="token number">0x0d</span><span class="token punctuation">,</span> <span class="token number">0xbf</span><span class="token punctuation">,</span> <span class="token number">0xe6</span><span class="token punctuation">,</span> <span class="token number">0x42</span><span class="token punctuation">,</span> <span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token number">0x41</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0x2d</span><span class="token punctuation">,</span> <span class="token number">0x0f</span><span class="token punctuation">,</span> <span class="token number">0xb0</span><span class="token punctuation">,</span> <span class="token number">0x54</span><span class="token punctuation">,</span> <span class="token number">0xbb</span><span class="token punctuation">,</span> <span class="token number">0x16</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">/**
* 逆S盒
*/</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">int</span> S2<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token number">0x52</span><span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">,</span> <span class="token number">0x6a</span><span class="token punctuation">,</span> <span class="token number">0xd5</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0xa5</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">0xbf</span><span class="token punctuation">,</span> <span class="token number">0x40</span><span class="token punctuation">,</span> <span class="token number">0xa3</span><span class="token punctuation">,</span> <span class="token number">0x9e</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0xf3</span><span class="token punctuation">,</span> <span class="token number">0xd7</span><span class="token punctuation">,</span> <span class="token number">0xfb</span><span class="token punctuation">,</span>
    <span class="token number">0x7c</span><span class="token punctuation">,</span> <span class="token number">0xe3</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">,</span> <span class="token number">0x82</span><span class="token punctuation">,</span> <span class="token number">0x9b</span><span class="token punctuation">,</span> <span class="token number">0x2f</span><span class="token punctuation">,</span> <span class="token number">0xff</span><span class="token punctuation">,</span> <span class="token number">0x87</span><span class="token punctuation">,</span> <span class="token number">0x34</span><span class="token punctuation">,</span> <span class="token number">0x8e</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0x44</span><span class="token punctuation">,</span> <span class="token number">0xc4</span><span class="token punctuation">,</span> <span class="token number">0xde</span><span class="token punctuation">,</span> <span class="token number">0xe9</span><span class="token punctuation">,</span> <span class="token number">0xcb</span><span class="token punctuation">,</span>
    <span class="token number">0x54</span><span class="token punctuation">,</span> <span class="token number">0x7b</span><span class="token punctuation">,</span> <span class="token number">0x94</span><span class="token punctuation">,</span> <span class="token number">0x32</span><span class="token punctuation">,</span> <span class="token number">0xa6</span><span class="token punctuation">,</span> <span class="token number">0xc2</span><span class="token punctuation">,</span> <span class="token number">0x23</span><span class="token punctuation">,</span> <span class="token number">0x3d</span><span class="token punctuation">,</span> <span class="token number">0xee</span><span class="token punctuation">,</span> <span class="token number">0x4c</span><span class="token punctuation">,</span> <span class="token number">0x95</span><span class="token punctuation">,</span> <span class="token number">0x0b</span><span class="token punctuation">,</span> <span class="token number">0x42</span><span class="token punctuation">,</span> <span class="token number">0xfa</span><span class="token punctuation">,</span> <span class="token number">0xc3</span><span class="token punctuation">,</span> <span class="token number">0x4e</span><span class="token punctuation">,</span>
    <span class="token number">0x08</span><span class="token punctuation">,</span> <span class="token number">0x2e</span><span class="token punctuation">,</span> <span class="token number">0xa1</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0x28</span><span class="token punctuation">,</span> <span class="token number">0xd9</span><span class="token punctuation">,</span> <span class="token number">0x24</span><span class="token punctuation">,</span> <span class="token number">0xb2</span><span class="token punctuation">,</span> <span class="token number">0x76</span><span class="token punctuation">,</span> <span class="token number">0x5b</span><span class="token punctuation">,</span> <span class="token number">0xa2</span><span class="token punctuation">,</span> <span class="token number">0x49</span><span class="token punctuation">,</span> <span class="token number">0x6d</span><span class="token punctuation">,</span> <span class="token number">0x8b</span><span class="token punctuation">,</span> <span class="token number">0xd1</span><span class="token punctuation">,</span> <span class="token number">0x25</span><span class="token punctuation">,</span>
    <span class="token number">0x72</span><span class="token punctuation">,</span> <span class="token number">0xf8</span><span class="token punctuation">,</span> <span class="token number">0xf6</span><span class="token punctuation">,</span> <span class="token number">0x64</span><span class="token punctuation">,</span> <span class="token number">0x86</span><span class="token punctuation">,</span> <span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token number">0x98</span><span class="token punctuation">,</span> <span class="token number">0x16</span><span class="token punctuation">,</span> <span class="token number">0xd4</span><span class="token punctuation">,</span> <span class="token number">0xa4</span><span class="token punctuation">,</span> <span class="token number">0x5c</span><span class="token punctuation">,</span> <span class="token number">0xcc</span><span class="token punctuation">,</span> <span class="token number">0x5d</span><span class="token punctuation">,</span> <span class="token number">0x65</span><span class="token punctuation">,</span> <span class="token number">0xb6</span><span class="token punctuation">,</span> <span class="token number">0x92</span><span class="token punctuation">,</span>
    <span class="token number">0x6c</span><span class="token punctuation">,</span> <span class="token number">0x70</span><span class="token punctuation">,</span> <span class="token number">0x48</span><span class="token punctuation">,</span> <span class="token number">0x50</span><span class="token punctuation">,</span> <span class="token number">0xfd</span><span class="token punctuation">,</span> <span class="token number">0xed</span><span class="token punctuation">,</span> <span class="token number">0xb9</span><span class="token punctuation">,</span> <span class="token number">0xda</span><span class="token punctuation">,</span> <span class="token number">0x5e</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">,</span> <span class="token number">0x46</span><span class="token punctuation">,</span> <span class="token number">0x57</span><span class="token punctuation">,</span> <span class="token number">0xa7</span><span class="token punctuation">,</span> <span class="token number">0x8d</span><span class="token punctuation">,</span> <span class="token number">0x9d</span><span class="token punctuation">,</span> <span class="token number">0x84</span><span class="token punctuation">,</span>
    <span class="token number">0x90</span><span class="token punctuation">,</span> <span class="token number">0xd8</span><span class="token punctuation">,</span> <span class="token number">0xab</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x8c</span><span class="token punctuation">,</span> <span class="token number">0xbc</span><span class="token punctuation">,</span> <span class="token number">0xd3</span><span class="token punctuation">,</span> <span class="token number">0x0a</span><span class="token punctuation">,</span> <span class="token number">0xf7</span><span class="token punctuation">,</span> <span class="token number">0xe4</span><span class="token punctuation">,</span> <span class="token number">0x58</span><span class="token punctuation">,</span> <span class="token number">0x05</span><span class="token punctuation">,</span> <span class="token number">0xb8</span><span class="token punctuation">,</span> <span class="token number">0xb3</span><span class="token punctuation">,</span> <span class="token number">0x45</span><span class="token punctuation">,</span> <span class="token number">0x06</span><span class="token punctuation">,</span>
    <span class="token number">0xd0</span><span class="token punctuation">,</span> <span class="token number">0x2c</span><span class="token punctuation">,</span> <span class="token number">0x1e</span><span class="token punctuation">,</span> <span class="token number">0x8f</span><span class="token punctuation">,</span> <span class="token number">0xca</span><span class="token punctuation">,</span> <span class="token number">0x3f</span><span class="token punctuation">,</span> <span class="token number">0x0f</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0xc1</span><span class="token punctuation">,</span> <span class="token number">0xaf</span><span class="token punctuation">,</span> <span class="token number">0xbd</span><span class="token punctuation">,</span> <span class="token number">0x03</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x13</span><span class="token punctuation">,</span> <span class="token number">0x8a</span><span class="token punctuation">,</span> <span class="token number">0x6b</span><span class="token punctuation">,</span>
    <span class="token number">0x3a</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0x41</span><span class="token punctuation">,</span> <span class="token number">0x4f</span><span class="token punctuation">,</span> <span class="token number">0x67</span><span class="token punctuation">,</span> <span class="token number">0xdc</span><span class="token punctuation">,</span> <span class="token number">0xea</span><span class="token punctuation">,</span> <span class="token number">0x97</span><span class="token punctuation">,</span> <span class="token number">0xf2</span><span class="token punctuation">,</span> <span class="token number">0xcf</span><span class="token punctuation">,</span> <span class="token number">0xce</span><span class="token punctuation">,</span> <span class="token number">0xf0</span><span class="token punctuation">,</span> <span class="token number">0xb4</span><span class="token punctuation">,</span> <span class="token number">0xe6</span><span class="token punctuation">,</span> <span class="token number">0x73</span><span class="token punctuation">,</span>
    <span class="token number">0x96</span><span class="token punctuation">,</span> <span class="token number">0xac</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0x22</span><span class="token punctuation">,</span> <span class="token number">0xe7</span><span class="token punctuation">,</span> <span class="token number">0xad</span><span class="token punctuation">,</span> <span class="token number">0x35</span><span class="token punctuation">,</span> <span class="token number">0x85</span><span class="token punctuation">,</span> <span class="token number">0xe2</span><span class="token punctuation">,</span> <span class="token number">0xf9</span><span class="token punctuation">,</span> <span class="token number">0x37</span><span class="token punctuation">,</span> <span class="token number">0xe8</span><span class="token punctuation">,</span> <span class="token number">0x1c</span><span class="token punctuation">,</span> <span class="token number">0x75</span><span class="token punctuation">,</span> <span class="token number">0xdf</span><span class="token punctuation">,</span> <span class="token number">0x6e</span><span class="token punctuation">,</span>
    <span class="token number">0x47</span><span class="token punctuation">,</span> <span class="token number">0xf1</span><span class="token punctuation">,</span> <span class="token number">0x1a</span><span class="token punctuation">,</span> <span class="token number">0x71</span><span class="token punctuation">,</span> <span class="token number">0x1d</span><span class="token punctuation">,</span> <span class="token number">0x29</span><span class="token punctuation">,</span> <span class="token number">0xc5</span><span class="token punctuation">,</span> <span class="token number">0x89</span><span class="token punctuation">,</span> <span class="token number">0x6f</span><span class="token punctuation">,</span> <span class="token number">0xb7</span><span class="token punctuation">,</span> <span class="token number">0x62</span><span class="token punctuation">,</span> <span class="token number">0x0e</span><span class="token punctuation">,</span> <span class="token number">0xaa</span><span class="token punctuation">,</span> <span class="token number">0x18</span><span class="token punctuation">,</span> <span class="token number">0xbe</span><span class="token punctuation">,</span> <span class="token number">0x1b</span><span class="token punctuation">,</span>
    <span class="token number">0xfc</span><span class="token punctuation">,</span> <span class="token number">0x56</span><span class="token punctuation">,</span> <span class="token number">0x3e</span><span class="token punctuation">,</span> <span class="token number">0x4b</span><span class="token punctuation">,</span> <span class="token number">0xc6</span><span class="token punctuation">,</span> <span class="token number">0xd2</span><span class="token punctuation">,</span> <span class="token number">0x79</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0x9a</span><span class="token punctuation">,</span> <span class="token number">0xdb</span><span class="token punctuation">,</span> <span class="token number">0xc0</span><span class="token punctuation">,</span> <span class="token number">0xfe</span><span class="token punctuation">,</span> <span class="token number">0x78</span><span class="token punctuation">,</span> <span class="token number">0xcd</span><span class="token punctuation">,</span> <span class="token number">0x5a</span><span class="token punctuation">,</span> <span class="token number">0xf4</span><span class="token punctuation">,</span>
    <span class="token number">0x1f</span><span class="token punctuation">,</span> <span class="token number">0xdd</span><span class="token punctuation">,</span> <span class="token number">0xa8</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0x07</span><span class="token punctuation">,</span> <span class="token number">0xc7</span><span class="token punctuation">,</span> <span class="token number">0x31</span><span class="token punctuation">,</span> <span class="token number">0xb1</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x59</span><span class="token punctuation">,</span> <span class="token number">0x27</span><span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0xec</span><span class="token punctuation">,</span> <span class="token number">0x5f</span><span class="token punctuation">,</span>
    <span class="token number">0x60</span><span class="token punctuation">,</span> <span class="token number">0x51</span><span class="token punctuation">,</span> <span class="token number">0x7f</span><span class="token punctuation">,</span> <span class="token number">0xa9</span><span class="token punctuation">,</span> <span class="token number">0x19</span><span class="token punctuation">,</span> <span class="token number">0xb5</span><span class="token punctuation">,</span> <span class="token number">0x4a</span><span class="token punctuation">,</span> <span class="token number">0x0d</span><span class="token punctuation">,</span> <span class="token number">0x2d</span><span class="token punctuation">,</span> <span class="token number">0xe5</span><span class="token punctuation">,</span> <span class="token number">0x7a</span><span class="token punctuation">,</span> <span class="token number">0x9f</span><span class="token punctuation">,</span> <span class="token number">0x93</span><span class="token punctuation">,</span> <span class="token number">0xc9</span><span class="token punctuation">,</span> <span class="token number">0x9c</span><span class="token punctuation">,</span> <span class="token number">0xef</span><span class="token punctuation">,</span>
    <span class="token number">0xa0</span><span class="token punctuation">,</span> <span class="token number">0xe0</span><span class="token punctuation">,</span> <span class="token number">0x3b</span><span class="token punctuation">,</span> <span class="token number">0x4d</span><span class="token punctuation">,</span> <span class="token number">0xae</span><span class="token punctuation">,</span> <span class="token number">0x2a</span><span class="token punctuation">,</span> <span class="token number">0xf5</span><span class="token punctuation">,</span> <span class="token number">0xb0</span><span class="token punctuation">,</span> <span class="token number">0xc8</span><span class="token punctuation">,</span> <span class="token number">0xeb</span><span class="token punctuation">,</span> <span class="token number">0xbb</span><span class="token punctuation">,</span> <span class="token number">0x3c</span><span class="token punctuation">,</span> <span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0x53</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0x61</span><span class="token punctuation">,</span>
    <span class="token number">0x17</span><span class="token punctuation">,</span> <span class="token number">0x2b</span><span class="token punctuation">,</span> <span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token number">0x7e</span><span class="token punctuation">,</span> <span class="token number">0xba</span><span class="token punctuation">,</span> <span class="token number">0x77</span><span class="token punctuation">,</span> <span class="token number">0xd6</span><span class="token punctuation">,</span> <span class="token number">0x26</span><span class="token punctuation">,</span> <span class="token number">0xe1</span><span class="token punctuation">,</span> <span class="token number">0x69</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">,</span> <span class="token number">0x63</span><span class="token punctuation">,</span> <span class="token number">0x55</span><span class="token punctuation">,</span> <span class="token number">0x21</span><span class="token punctuation">,</span> <span class="token number">0x0c</span><span class="token punctuation">,</span> <span class="token number">0x7d</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">/**
* 获取整形数据的低8位的左4个位
*/</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">getLeft4Bit</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> left <span class="token operator">=</span> num <span class="token operator">&amp;</span> <span class="token number">0x000000f0</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> left <span class="token operator">&gt;&gt;</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 获取整形数据的低8位的右4个位
*/</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">getRight4Bit</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> num <span class="token operator">&amp;</span> <span class="token number">0x0000000f</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token comment">/**
* 根据索引，从S盒中获得元素
*/</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">getNumFromSBox</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> row <span class="token operator">=</span> <span class="token function">getLeft4Bit</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> col <span class="token operator">=</span> <span class="token function">getRight4Bit</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> S<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 把一个字符转变成整型
*/</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">getIntFromChar</span><span class="token punctuation">(</span><span class="token keyword">char</span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> result <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> c<span class="token punctuation">;</span>
    <span class="token keyword">return</span> result <span class="token operator">&amp;</span> <span class="token number">0x000000ff</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 把16个字符转变成4X4的数组，
* 该矩阵中字节的排列顺序为从上到下，
* 从左到右依次排列。
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">convertToIntArray</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">,</span> <span class="token keyword">int</span> pa<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            pa<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getIntFromChar</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            k<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 打印4X4的数组
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">printArray</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;a[%d][%d] = 0x%x &quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 打印字符串的ASSCI，
* 以十六进制显示。
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">printASSCI</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;0x%x &quot;</span><span class="token punctuation">,</span> <span class="token function">getIntFromChar</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 把连续的4个字符合并成一个4字节的整型
*/</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">getWordFromStr</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> one <span class="token operator">=</span> <span class="token function">getIntFromChar</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    one <span class="token operator">=</span> one <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> two <span class="token operator">=</span> <span class="token function">getIntFromChar</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    two <span class="token operator">=</span> two <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> three <span class="token operator">=</span> <span class="token function">getIntFromChar</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    three <span class="token operator">=</span> three <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> four <span class="token operator">=</span> <span class="token function">getIntFromChar</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> one <span class="token operator">|</span> two <span class="token operator">|</span> three <span class="token operator">|</span> four<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 把一个4字节的数的第一、二、三、四个字节取出，
* 入进一个4个元素的整型数组里面。
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">splitIntToArray</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">,</span> <span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> one <span class="token operator">=</span> num <span class="token operator">&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">;</span>
    array<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> one <span class="token operator">&amp;</span> <span class="token number">0x000000ff</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> two <span class="token operator">=</span> num <span class="token operator">&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">;</span>
    array<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> two <span class="token operator">&amp;</span> <span class="token number">0x000000ff</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> three <span class="token operator">=</span> num <span class="token operator">&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">;</span>
    array<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> three <span class="token operator">&amp;</span> <span class="token number">0x000000ff</span><span class="token punctuation">;</span>
    array<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> num <span class="token operator">&amp;</span> <span class="token number">0x000000ff</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 将数组中的元素循环左移step位
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">leftLoop4int</span><span class="token punctuation">(</span><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> step<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> temp<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        temp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> index <span class="token operator">=</span> step <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> step <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        array<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
        index<span class="token operator">++</span><span class="token punctuation">;</span>
        index <span class="token operator">=</span> index <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 把数组中的第一、二、三和四元素分别作为
* 4字节整型的第一、二、三和四字节，合并成一个4字节整型
*/</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">mergeArrayToInt</span><span class="token punctuation">(</span><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> one <span class="token operator">=</span> array<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> two <span class="token operator">=</span> array<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> three <span class="token operator">=</span> array<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> four <span class="token operator">=</span> array<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> one <span class="token operator">|</span> two <span class="token operator">|</span> three <span class="token operator">|</span> four<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 常量轮值表
*/</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">int</span> Rcon<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token number">0x01000000</span><span class="token punctuation">,</span> <span class="token number">0x02000000</span><span class="token punctuation">,</span>
    <span class="token number">0x04000000</span><span class="token punctuation">,</span> <span class="token number">0x08000000</span><span class="token punctuation">,</span>
    <span class="token number">0x10000000</span><span class="token punctuation">,</span> <span class="token number">0x20000000</span><span class="token punctuation">,</span>
    <span class="token number">0x40000000</span><span class="token punctuation">,</span> <span class="token number">0x80000000</span><span class="token punctuation">,</span>
    <span class="token number">0x1b000000</span><span class="token punctuation">,</span> <span class="token number">0x36000000</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">/**
* 密钥扩展中的T函数
*/</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">T</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">,</span> <span class="token keyword">int</span> round<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> numArray<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">splitIntToArray</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span> numArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">leftLoop4int</span><span class="token punctuation">(</span>numArray<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//字循环</span>

    <span class="token comment">//字节代换</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        numArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getNumFromSBox</span><span class="token punctuation">(</span>numArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> result <span class="token operator">=</span> <span class="token function">mergeArrayToInt</span><span class="token punctuation">(</span>numArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result <span class="token operator">^</span> Rcon<span class="token punctuation">[</span>round<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//密钥对应的扩展数组</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> w<span class="token punctuation">[</span><span class="token number">44</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">/**
* 扩展密钥，结果是把w[44]中的每个元素初始化
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">extendKey</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        w<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getWordFromStr</span><span class="token punctuation">(</span>key <span class="token operator">+</span> i <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">44</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span> i <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            w<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> w<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token function">T</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span>
            j<span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment">//下一轮</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
            w<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> w<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">^</span> w<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 轮密钥加
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">addRoundKey</span><span class="token punctuation">(</span><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> round<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> warray<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token function">splitIntToArray</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span> round <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> i<span class="token punctuation">]</span><span class="token punctuation">,</span> warray<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            array<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> warray<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 字节代换
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">subBytes</span><span class="token punctuation">(</span><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
            array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getNumFromSBox</span><span class="token punctuation">(</span>array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 行移位
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">shiftRows</span><span class="token punctuation">(</span><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> rowTwo<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> rowThree<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> rowFour<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">//复制状态矩阵的第2,3,4行</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        rowTwo<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        rowThree<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        rowFour<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//循环左移相应的位数</span>
    <span class="token function">leftLoop4int</span><span class="token punctuation">(</span>rowTwo<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">leftLoop4int</span><span class="token punctuation">(</span>rowThree<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">leftLoop4int</span><span class="token punctuation">(</span>rowFour<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//把左移后的行复制回状态矩阵中</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        array<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> rowTwo<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        array<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> rowThree<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        array<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> rowFour<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 列混合要用到的矩阵
*/</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">int</span> colM<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">GFMul2</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> result <span class="token operator">=</span> s <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> a7 <span class="token operator">=</span> result <span class="token operator">&amp;</span> <span class="token number">0x00000100</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>a7 <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        result <span class="token operator">=</span> result <span class="token operator">&amp;</span> <span class="token number">0x000000ff</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> result <span class="token operator">^</span> <span class="token number">0x1b</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">GFMul3</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">GFMul2</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">^</span> s<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">GFMul4</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">GFMul2</span><span class="token punctuation">(</span><span class="token function">GFMul2</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">GFMul8</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">GFMul2</span><span class="token punctuation">(</span><span class="token function">GFMul4</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">GFMul9</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">GFMul8</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">^</span> s<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">GFMul11</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">GFMul9</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">GFMul2</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">GFMul12</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">GFMul8</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">GFMul4</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">GFMul13</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">GFMul12</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">^</span> s<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">GFMul14</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">GFMul12</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">GFMul2</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* GF上的二元运算
*/</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">GFMul</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span> <span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> result<span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
        result <span class="token operator">=</span> s<span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span>
        result <span class="token operator">=</span> <span class="token function">GFMul2</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span>
        result <span class="token operator">=</span> <span class="token function">GFMul3</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0x9</span><span class="token punctuation">)</span>
        result <span class="token operator">=</span> <span class="token function">GFMul9</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0xb</span><span class="token punctuation">)</span><span class="token comment">//11</span>
        result <span class="token operator">=</span> <span class="token function">GFMul11</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0xd</span><span class="token punctuation">)</span><span class="token comment">//13</span>
        result <span class="token operator">=</span> <span class="token function">GFMul13</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0xe</span><span class="token punctuation">)</span><span class="token comment">//14</span>
        result <span class="token operator">=</span> <span class="token function">GFMul14</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/**
* 列混合
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">mixColumns</span><span class="token punctuation">(</span><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">int</span> tempArray<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
            tempArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">GFMul</span><span class="token punctuation">(</span>colM<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>tempArray<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">GFMul</span><span class="token punctuation">(</span>colM<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>tempArray<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> 
                <span class="token operator">^</span> <span class="token function">GFMul</span><span class="token punctuation">(</span>colM<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>tempArray<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">GFMul</span><span class="token punctuation">(</span>colM<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> tempArray<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">/**
* 把4X4数组转回字符串
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">convertArrayToStr</span><span class="token punctuation">(</span><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token operator">*</span>str<span class="token operator">++</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span>array<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>	
<span class="token punctuation">}</span>
<span class="token comment">/**
* 检查密钥长度
*/</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">checkKeyLen</span><span class="token punctuation">(</span><span class="token keyword">int</span> len<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>len <span class="token operator">==</span> <span class="token number">16</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 参数 p: 明文的字符串数组。
* 参数 plen: 明文的长度。
* 参数 key: 密钥的字符串数组。
*/</span>
<span class="token keyword">void</span> <span class="token function">aes</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>p<span class="token punctuation">,</span> <span class="token keyword">int</span> plen<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>key<span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token keyword">int</span> keylen <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>plen <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> plen <span class="token operator">%</span> <span class="token number">16</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;明文字符长度必须为16的倍数！\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">checkKeyLen</span><span class="token punctuation">(</span>keylen<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;密钥字符长度错误！长度必须为16、24和32。当前长度为%d\n&quot;</span><span class="token punctuation">,</span>keylen<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">extendKey</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//扩展密钥</span>
    <span class="token keyword">int</span> pArray<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> plen<span class="token punctuation">;</span> k <span class="token operator">+=</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>	
        <span class="token function">convertToIntArray</span><span class="token punctuation">(</span>p <span class="token operator">+</span> k<span class="token punctuation">,</span> pArray<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">addRoundKey</span><span class="token punctuation">(</span>pArray<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//一开始的轮密钥加</span>

        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//前9轮</span>

            <span class="token function">subBytes</span><span class="token punctuation">(</span>pArray<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//字节代换</span>

            <span class="token function">shiftRows</span><span class="token punctuation">(</span>pArray<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//行移位</span>

            <span class="token function">mixColumns</span><span class="token punctuation">(</span>pArray<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//列混合</span>

            <span class="token function">addRoundKey</span><span class="token punctuation">(</span>pArray<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span>

        <span class="token comment">//第10轮</span>
        <span class="token function">subBytes</span><span class="token punctuation">(</span>pArray<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//字节代换</span>

        <span class="token function">shiftRows</span><span class="token punctuation">(</span>pArray<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//行移位</span>

        <span class="token function">addRoundKey</span><span class="token punctuation">(</span>pArray<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">convertArrayToStr</span><span class="token punctuation">(</span>pArray<span class="token punctuation">,</span> p <span class="token operator">+</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">/**
* 根据索引从逆S盒中获取值
*/</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">getNumFromS1Box</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> row <span class="token operator">=</span> <span class="token function">getLeft4Bit</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> col <span class="token operator">=</span> <span class="token function">getRight4Bit</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> S2<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/**
* 逆字节变换
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">deSubBytes</span><span class="token punctuation">(</span><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
            array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getNumFromS1Box</span><span class="token punctuation">(</span>array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/**
* 把4个元素的数组循环右移step位
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">rightLoop4int</span><span class="token punctuation">(</span><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> step<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> temp<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        temp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> index <span class="token operator">=</span> step <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> step <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">;</span>
    index <span class="token operator">=</span> <span class="token number">3</span> <span class="token operator">-</span> index<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        array<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
        index<span class="token operator">--</span><span class="token punctuation">;</span>
        index <span class="token operator">=</span> index <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">?</span> <span class="token number">3</span> <span class="token operator">:</span> index<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 逆行移位
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">deShiftRows</span><span class="token punctuation">(</span><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> rowTwo<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> rowThree<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> rowFour<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        rowTwo<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        rowThree<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        rowFour<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">rightLoop4int</span><span class="token punctuation">(</span>rowTwo<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">rightLoop4int</span><span class="token punctuation">(</span>rowThree<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">rightLoop4int</span><span class="token punctuation">(</span>rowFour<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        array<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> rowTwo<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        array<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> rowThree<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        array<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> rowFour<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">/**
* 逆列混合用到的矩阵
*/</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">int</span> deColM<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0xe</span><span class="token punctuation">,</span> <span class="token number">0xb</span><span class="token punctuation">,</span> <span class="token number">0xd</span><span class="token punctuation">,</span> <span class="token number">0x9</span><span class="token punctuation">,</span>
    <span class="token number">0x9</span><span class="token punctuation">,</span> <span class="token number">0xe</span><span class="token punctuation">,</span> <span class="token number">0xb</span><span class="token punctuation">,</span> <span class="token number">0xd</span><span class="token punctuation">,</span>
    <span class="token number">0xd</span><span class="token punctuation">,</span> <span class="token number">0x9</span><span class="token punctuation">,</span> <span class="token number">0xe</span><span class="token punctuation">,</span> <span class="token number">0xb</span><span class="token punctuation">,</span>
    <span class="token number">0xb</span><span class="token punctuation">,</span> <span class="token number">0xd</span><span class="token punctuation">,</span> <span class="token number">0x9</span><span class="token punctuation">,</span> <span class="token number">0xe</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">/**
* 逆列混合
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">deMixColumns</span><span class="token punctuation">(</span><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> tempArray<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
            tempArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">GFMul</span><span class="token punctuation">(</span>deColM<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>tempArray<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">GFMul</span><span class="token punctuation">(</span>deColM<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>tempArray<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> 
                <span class="token operator">^</span> <span class="token function">GFMul</span><span class="token punctuation">(</span>deColM<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>tempArray<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">GFMul</span><span class="token punctuation">(</span>deColM<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> tempArray<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">/**
* 把两个4X4数组进行异或
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">addRoundTowArray</span><span class="token punctuation">(</span><span class="token keyword">int</span> aArray<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">int</span> bArray<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
            aArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> aArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">^</span> bArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/**
* 从4个32位的密钥字中获得4X4数组，
* 用于进行逆列混合
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">getArrayFrom4W</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> index <span class="token operator">=</span> i <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> colOne<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> colTwo<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> colThree<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> colFour<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">splitIntToArray</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">,</span> colOne<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">splitIntToArray</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span>index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> colTwo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">splitIntToArray</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span>index <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> colThree<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">splitIntToArray</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span>index <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> colFour<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> colOne<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> colTwo<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> colThree<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> colFour<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* 参数 c: 密文的字符串数组。
* 参数 clen: 密文的长度。
* 参数 key: 密钥的字符串数组。
*/</span>
<span class="token keyword">void</span> <span class="token function">deAes</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>c<span class="token punctuation">,</span> <span class="token keyword">int</span> clen<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>key<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">int</span> keylen <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>clen <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> clen <span class="token operator">%</span> <span class="token number">16</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;密文字符长度必须为16的倍数！现在的长度为%d\n&quot;</span><span class="token punctuation">,</span>clen<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">checkKeyLen</span><span class="token punctuation">(</span>keylen<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;密钥字符长度错误！长度必须为16、24和32。当前长度为%d\n&quot;</span><span class="token punctuation">,</span>keylen<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">extendKey</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//扩展密钥</span>
    <span class="token keyword">int</span> cArray<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> clen<span class="token punctuation">;</span> k <span class="token operator">+=</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">convertToIntArray</span><span class="token punctuation">(</span>c <span class="token operator">+</span> k<span class="token punctuation">,</span> cArray<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">addRoundKey</span><span class="token punctuation">(</span>cArray<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">int</span> wArray<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">deSubBytes</span><span class="token punctuation">(</span>cArray<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token function">deShiftRows</span><span class="token punctuation">(</span>cArray<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token function">deMixColumns</span><span class="token punctuation">(</span>cArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">getArrayFrom4W</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> wArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">deMixColumns</span><span class="token punctuation">(</span>wArray<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token function">addRoundTowArray</span><span class="token punctuation">(</span>cArray<span class="token punctuation">,</span> wArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token function">deSubBytes</span><span class="token punctuation">(</span>cArray<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">deShiftRows</span><span class="token punctuation">(</span>cArray<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">addRoundKey</span><span class="token punctuation">(</span>cArray<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">convertArrayToStr</span><span class="token punctuation">(</span>cArray<span class="token punctuation">,</span> c <span class="token operator">+</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li></ul><h2 id="peb" tabindex="-1"><a class="header-anchor" href="#peb" aria-hidden="true">#</a> PEB</h2><blockquote><p>在PEB（Password Based Encryption基于口令加密）算法中使用口令（系统登陆时的密码）而不是密钥。口令由用户自己掌管，采用随机数（加盐）杂凑多重加密等方法保证数据安全。将盐附加口令，通过消息摘要（MD5等）构建出密钥/IV</p><p>PBE算法是对称加密算法的综合性算法（已知的对称加密算法做包装，并没有构建新的加密算法）。如PBEWithMD5AndDES，使用了MD5与DES构建PBE算法</p></blockquote><p>PBE通常使用摘要算法（MD，SHA）将口令与盐计算出key作为密钥，通过该密钥进行对称加密（DES、AES）得到密文。进行对称加密时一般使用CBC模式</p><ul><li><p>消息传递流程</p><ul><li>消息传递双方同步口令（单方生成 或 协商生成 等，生成后向未知方公布口令）</li><li>发送方构建盐（通过随机方式构建8字节的盐）</li><li>发送方使用口令、盐进行数据加密</li><li>将盐、加密数据发送给接收方</li><li>接收方使用盐、口令对数据解密</li></ul></li><li><p>代码</p><ul><li><p>Java API</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// 生成盐</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">initSalt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token class-name">SecureRandom</span> random <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SecureRandom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> random<span class="token punctuation">.</span><span class="token function">generateSeed</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 加密</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data<span class="token punctuation">,</span> <span class="token class-name">String</span> pwd<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> salt<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token comment">// 转换密钥 String类型 转 密钥类型</span>
    <span class="token class-name">Key</span> key <span class="token operator">=</span> <span class="token constant">PBE</span><span class="token punctuation">.</span><span class="token function">toKey</span><span class="token punctuation">(</span>pwd<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 实例化参数</span>
    <span class="token class-name">PBEParameterSpec</span> paramSpec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PBEParameterSpec</span><span class="token punctuation">(</span>salt<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 盐 + 迭代次数</span>
    <span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;PBEWITHMD5andDES&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token constant">ENCRYPT_MODE</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> paramSpec<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> cipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li></ul></div><div id="comment" class="giscus-wrapper input-top" style="display:block;" data-v-77edf713><div class="loading-icon-wrapper" style="display:flex;align-items:center;justify-content:center;height:96px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div></div><!--]--><footer class="page_footer" data-v-2c01bf66><div class="footer_middle card_border" data-v-2c01bf66><!--[--><span data-v-2c01bf66>Released under the MIT License. <br data-v-2c01bf66></span><span data-v-2c01bf66>Copyright © 2023-present Leopold <br data-v-2c01bf66></span><!--]--></div></footer></div></div></div></div><!----><!----><!--]--></div>
    <script type="module" src="/assets/app-da04b297.js" defer></script>
  </body>
</html>
