<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.68">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <meta property="og:url" content="https://saynop.github.io/detail/016.html"><meta property="og:title" content="非对称加密算法"><meta property="og:description" content="简介 非对称加密算法的加密与解密使用不同的密钥，即公钥和私钥。通常来说，发送方使用公钥加密数据后发送，接受方使用私钥解密数据得到明文 DH DH（Diffie-Hellman 密钥交换）算法用于安全的发放收发双方约定的密钥 DH算法是第一个密钥协商算法，仅用于密钥分配，不能用于加解密消息 消息传递流程 收发双方构建本地密钥。构建密钥时，使用本方的私钥及对方的公钥构建本地密钥 发送方使用本地密钥加密消息发送 接受方使用本地密钥对收到的消息解密"><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="article:tag" content="Cryptography"><meta property="article:tag" content="DH"><meta property="article:tag" content="RSA"><meta property="article:published_time" content="2024-05-03T00:00:00.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"非对称加密算法","image":[""],"datePublished":"2024-05-03T00:00:00.000Z","dateModified":null,"author":[]}</script><link rel="icon" href="/favicon.ico"><title>非对称加密算法</title><meta name="description" content="简介 非对称加密算法的加密与解密使用不同的密钥，即公钥和私钥。通常来说，发送方使用公钥加密数据后发送，接受方使用私钥解密数据得到明文 DH DH（Diffie-Hellman 密钥交换）算法用于安全的发放收发双方约定的密钥 DH算法是第一个密钥协商算法，仅用于密钥分配，不能用于加解密消息 消息传递流程 收发双方构建本地密钥。构建密钥时，使用本方的私钥及对方的公钥构建本地密钥 发送方使用本地密钥加密消息发送 接受方使用本地密钥对收到的消息解密">
    <link rel="preload" href="/assets/style-3253bf1b.css" as="style"><link rel="stylesheet" href="/assets/style-3253bf1b.css">
    <link rel="modulepreload" href="/assets/app-9b1be411.js"><link rel="modulepreload" href="/assets/016.html-79bc20a6.js"><link rel="modulepreload" href="/assets/016.html-adcdf980.js">
    <link rel="prefetch" href="/assets/index.html-f33fda43.js" as="script"><link rel="prefetch" href="/assets/001.html-12451cc3.js" as="script"><link rel="prefetch" href="/assets/002.html-a6d5828c.js" as="script"><link rel="prefetch" href="/assets/003.html-6c773146.js" as="script"><link rel="prefetch" href="/assets/004.html-689926d8.js" as="script"><link rel="prefetch" href="/assets/005.html-d6b96039.js" as="script"><link rel="prefetch" href="/assets/006.html-5b50a542.js" as="script"><link rel="prefetch" href="/assets/007.html-d3b6ddc8.js" as="script"><link rel="prefetch" href="/assets/008.html-042c4a7a.js" as="script"><link rel="prefetch" href="/assets/009.html-7d1574d7.js" as="script"><link rel="prefetch" href="/assets/010.html-f1724340.js" as="script"><link rel="prefetch" href="/assets/011.html-10672fd1.js" as="script"><link rel="prefetch" href="/assets/012.html-5e7aa08e.js" as="script"><link rel="prefetch" href="/assets/013.html-8dd46ba3.js" as="script"><link rel="prefetch" href="/assets/014.html-d0db391f.js" as="script"><link rel="prefetch" href="/assets/015.html-7a04f43c.js" as="script"><link rel="prefetch" href="/assets/017.html-225b58d3.js" as="script"><link rel="prefetch" href="/assets/018.html-185c4621.js" as="script"><link rel="prefetch" href="/assets/019.html-af3ace47.js" as="script"><link rel="prefetch" href="/assets/404.html-a0fec2a7.js" as="script"><link rel="prefetch" href="/assets/index.html-75381ff5.js" as="script"><link rel="prefetch" href="/assets/index.html-c95ce669.js" as="script"><link rel="prefetch" href="/assets/index.html-2c56dc8e.js" as="script"><link rel="prefetch" href="/assets/index.html-98874abd.js" as="script"><link rel="prefetch" href="/assets/index.html-b2308fb7.js" as="script"><link rel="prefetch" href="/assets/index.html-10e703b4.js" as="script"><link rel="prefetch" href="/assets/index.html-5f3af54d.js" as="script"><link rel="prefetch" href="/assets/index.html-56349a98.js" as="script"><link rel="prefetch" href="/assets/index.html-a7c2713a.js" as="script"><link rel="prefetch" href="/assets/index.html-2e96c3d2.js" as="script"><link rel="prefetch" href="/assets/index.html-9f1eff22.js" as="script"><link rel="prefetch" href="/assets/index.html-16b34053.js" as="script"><link rel="prefetch" href="/assets/index.html-4e233464.js" as="script"><link rel="prefetch" href="/assets/index.html-d90f0ec9.js" as="script"><link rel="prefetch" href="/assets/index.html-3202320f.js" as="script"><link rel="prefetch" href="/assets/index.html-c3fe2c85.js" as="script"><link rel="prefetch" href="/assets/index.html-f3052411.js" as="script"><link rel="prefetch" href="/assets/index.html-5485bfc3.js" as="script"><link rel="prefetch" href="/assets/index.html-a7568890.js" as="script"><link rel="prefetch" href="/assets/index.html-9d25f5f2.js" as="script"><link rel="prefetch" href="/assets/index.html-b9dd3162.js" as="script"><link rel="prefetch" href="/assets/index.html-ff33d682.js" as="script"><link rel="prefetch" href="/assets/index.html-3bce843e.js" as="script"><link rel="prefetch" href="/assets/index.html-09b9da96.js" as="script"><link rel="prefetch" href="/assets/index.html-750acad1.js" as="script"><link rel="prefetch" href="/assets/index.html-1c1e573d.js" as="script"><link rel="prefetch" href="/assets/index.html-8eb4570b.js" as="script"><link rel="prefetch" href="/assets/index.html-7dd1db94.js" as="script"><link rel="prefetch" href="/assets/index.html-32048506.js" as="script"><link rel="prefetch" href="/assets/index.html-a4e9e805.js" as="script"><link rel="prefetch" href="/assets/index.html-df3e534f.js" as="script"><link rel="prefetch" href="/assets/index.html-cb3cc9f5.js" as="script"><link rel="prefetch" href="/assets/index.html-0994fca8.js" as="script"><link rel="prefetch" href="/assets/index.html-a902e771.js" as="script"><link rel="prefetch" href="/assets/index.html-76fbbff6.js" as="script"><link rel="prefetch" href="/assets/index.html-7bc29919.js" as="script"><link rel="prefetch" href="/assets/index.html-2642a77f.js" as="script"><link rel="prefetch" href="/assets/index.html-8dfad283.js" as="script"><link rel="prefetch" href="/assets/index.html-0e75c0da.js" as="script"><link rel="prefetch" href="/assets/index.html-1d59d05d.js" as="script"><link rel="prefetch" href="/assets/index.html-5789a1c9.js" as="script"><link rel="prefetch" href="/assets/index.html-a74daf45.js" as="script"><link rel="prefetch" href="/assets/index.html-12b75b8f.js" as="script"><link rel="prefetch" href="/assets/index.html-ec537192.js" as="script"><link rel="prefetch" href="/assets/001.html-9c1c4347.js" as="script"><link rel="prefetch" href="/assets/002.html-5bf961fc.js" as="script"><link rel="prefetch" href="/assets/003.html-752b87e0.js" as="script"><link rel="prefetch" href="/assets/004.html-6c010f36.js" as="script"><link rel="prefetch" href="/assets/005.html-84065f42.js" as="script"><link rel="prefetch" href="/assets/006.html-b6357943.js" as="script"><link rel="prefetch" href="/assets/007.html-590b0537.js" as="script"><link rel="prefetch" href="/assets/008.html-ca91bc0a.js" as="script"><link rel="prefetch" href="/assets/009.html-56971b95.js" as="script"><link rel="prefetch" href="/assets/010.html-6435567d.js" as="script"><link rel="prefetch" href="/assets/011.html-dcc1acbe.js" as="script"><link rel="prefetch" href="/assets/012.html-c5fee40f.js" as="script"><link rel="prefetch" href="/assets/013.html-571f2e1e.js" as="script"><link rel="prefetch" href="/assets/014.html-1d24fa95.js" as="script"><link rel="prefetch" href="/assets/015.html-0a67f543.js" as="script"><link rel="prefetch" href="/assets/017.html-09f4c008.js" as="script"><link rel="prefetch" href="/assets/018.html-71e77188.js" as="script"><link rel="prefetch" href="/assets/019.html-1a4184ee.js" as="script"><link rel="prefetch" href="/assets/404.html-bbe8120e.js" as="script"><link rel="prefetch" href="/assets/index.html-5ead7edf.js" as="script"><link rel="prefetch" href="/assets/index.html-1a797ade.js" as="script"><link rel="prefetch" href="/assets/index.html-a3c767ea.js" as="script"><link rel="prefetch" href="/assets/index.html-1e3ba9e5.js" as="script"><link rel="prefetch" href="/assets/index.html-b88c39e7.js" as="script"><link rel="prefetch" href="/assets/index.html-c1f268ac.js" as="script"><link rel="prefetch" href="/assets/index.html-d700f000.js" as="script"><link rel="prefetch" href="/assets/index.html-1509e72e.js" as="script"><link rel="prefetch" href="/assets/index.html-e8e84c35.js" as="script"><link rel="prefetch" href="/assets/index.html-25285520.js" as="script"><link rel="prefetch" href="/assets/index.html-9f1a16ea.js" as="script"><link rel="prefetch" href="/assets/index.html-2760ca6d.js" as="script"><link rel="prefetch" href="/assets/index.html-9ac8d809.js" as="script"><link rel="prefetch" href="/assets/index.html-d3b1a73e.js" as="script"><link rel="prefetch" href="/assets/index.html-c4e258ef.js" as="script"><link rel="prefetch" href="/assets/index.html-5a179f3a.js" as="script"><link rel="prefetch" href="/assets/index.html-39df3553.js" as="script"><link rel="prefetch" href="/assets/index.html-c46c2d1d.js" as="script"><link rel="prefetch" href="/assets/index.html-31052f30.js" as="script"><link rel="prefetch" href="/assets/index.html-6f08a57f.js" as="script"><link rel="prefetch" href="/assets/index.html-35a076df.js" as="script"><link rel="prefetch" href="/assets/index.html-d089827a.js" as="script"><link rel="prefetch" href="/assets/index.html-d2b19d00.js" as="script"><link rel="prefetch" href="/assets/index.html-9685e1bf.js" as="script"><link rel="prefetch" href="/assets/index.html-23c58ca9.js" as="script"><link rel="prefetch" href="/assets/index.html-dd8b3844.js" as="script"><link rel="prefetch" href="/assets/index.html-fcab64f4.js" as="script"><link rel="prefetch" href="/assets/index.html-9a0f74d4.js" as="script"><link rel="prefetch" href="/assets/index.html-ef8a5599.js" as="script"><link rel="prefetch" href="/assets/index.html-867217ef.js" as="script"><link rel="prefetch" href="/assets/index.html-51b9b5a7.js" as="script"><link rel="prefetch" href="/assets/index.html-41db6dec.js" as="script"><link rel="prefetch" href="/assets/index.html-cc31fca1.js" as="script"><link rel="prefetch" href="/assets/index.html-4b072825.js" as="script"><link rel="prefetch" href="/assets/index.html-111446fc.js" as="script"><link rel="prefetch" href="/assets/index.html-9314e466.js" as="script"><link rel="prefetch" href="/assets/index.html-4c6e8328.js" as="script"><link rel="prefetch" href="/assets/index.html-9bbb9e0b.js" as="script"><link rel="prefetch" href="/assets/index.html-353f14b0.js" as="script"><link rel="prefetch" href="/assets/index.html-5abc65c8.js" as="script"><link rel="prefetch" href="/assets/index.html-f8c2be7e.js" as="script"><link rel="prefetch" href="/assets/index.html-bf1b5d28.js" as="script"><link rel="prefetch" href="/assets/index.html-e936348c.js" as="script"><link rel="prefetch" href="/assets/giscus-0b7adcf8.js" as="script"><link rel="prefetch" href="/assets/SearchResult-e419225b.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div data-v-77edf713><header class="header" style="opacity:0;" data-v-90176301><div class="header_container" data-v-90176301><div data-v-90176301><a class="header_title" href="/" data-v-90176301>Leopold&#39;s Blog</a></div><div class="appearance" data-v-90176301><!--[--><button type="button" class="search-pro-button" role="search" aria-label="搜索"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">搜索</div><!----></button><!--]--><button class="switch" data-v-90176301><span class="icon" style="display:block;" data-v-90176301><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" style="" data-v-90176301><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" style="display:none;" data-v-90176301><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg></span></button><button class="switch mobile_list_btn" type="button" data-v-90176301><span class="btn_top" data-v-90176301></span><span class="btn_middle" data-v-90176301></span><span class="btn_bottom" data-v-90176301></span></button></div></div></header><div class="main"><div class="background" data-v-fee8de4c><svg class="pull_down" viewbox="0 0 1026 1024" xmlns="http://www.w3.org/2000/svg" data-v-fee8de4c data-v-3c8412b0><path d="M857.088 224.256q28.672-28.672 69.12-28.672t69.12 28.672q29.696 28.672 29.696 68.608t-29.696 68.608l-382.976 380.928q-12.288 14.336-30.72 19.968t-38.912 4.608-40.448-8.704-34.304-22.016l-376.832-374.784q-29.696-28.672-29.696-68.608t29.696-68.608q14.336-14.336 32.256-21.504t36.864-7.168 37.376 7.168 32.768 21.504l313.344 309.248z" data-v-3c8412b0></path></svg></div><div style="display:flex;"><div class="sider_keeper" data-v-e01a06ce><div class="folding" data-v-e01a06ce><!-- <div class="folding"> --><div class="sidebar_top card_border" style="min-height:1rem" data-v-e01a06ce><div class="tags_brand" data-v-e01a06ce>本文大纲</div><section class="article_sidebar" data-v-e01a06ce data-v-905b99e1><ul data-v-905b99e1><!--[--><li class="level2" data-v-905b99e1><a class="sidebar-link" href="#简介" data-v-905b99e1>简介</a><ul class="level3" data-v-905b99e1><!--[--><!--]--></ul></li><li class="level2" data-v-905b99e1><a class="sidebar-link" href="#dh" data-v-905b99e1>DH</a><ul class="level3" data-v-905b99e1><!--[--><li data-v-905b99e1><a class="sidebar-link" href="#消息传递流程" data-v-905b99e1>消息传递流程</a><ul class="level4" data-v-905b99e1><!--[--><!--]--></ul></li><li data-v-905b99e1><a class="sidebar-link" href="#api-使用流程" data-v-905b99e1>API 使用流程</a><ul class="level4" data-v-905b99e1><!--[--><!--]--></ul></li><li data-v-905b99e1><a class="sidebar-link" href="#代码" data-v-905b99e1>代码</a><ul class="level4" data-v-905b99e1><!--[--><!--]--></ul></li><!--]--></ul></li><li class="level2" data-v-905b99e1><a class="sidebar-link" href="#rsa" data-v-905b99e1>RSA</a><ul class="level3" data-v-905b99e1><!--[--><li data-v-905b99e1><a class="sidebar-link" href="#消息传递流程-1" data-v-905b99e1>消息传递流程</a><ul class="level4" data-v-905b99e1><!--[--><!--]--></ul></li><li data-v-905b99e1><a class="sidebar-link" href="#工作模式与密钥长度" data-v-905b99e1>工作模式与密钥长度</a><ul class="level4" data-v-905b99e1><!--[--><!--]--></ul></li><li data-v-905b99e1><a class="sidebar-link" href="#涉及到数学内容" data-v-905b99e1>涉及到数学内容</a><ul class="level4" data-v-905b99e1><!--[--><!--]--></ul></li><li data-v-905b99e1><a class="sidebar-link" href="#实现流程" data-v-905b99e1>实现流程</a><ul class="level4" data-v-905b99e1><!--[--><!--]--></ul></li><li data-v-905b99e1><a class="sidebar-link" href="#原理" data-v-905b99e1>原理</a><ul class="level4" data-v-905b99e1><!--[--><!--]--></ul></li><li data-v-905b99e1><a class="sidebar-link" href="#代码-1" data-v-905b99e1>代码</a><ul class="level4" data-v-905b99e1><!--[--><!--]--></ul></li><!--]--></ul></li><!--]--></ul></section></div><div class="sidebar_bottom card_border" data-v-e01a06ce><div class="avatar" style="background-image:url(/assets/imgs/avatar.jpg);" data-v-e01a06ce></div><div class="author" data-v-e01a06ce>Leopold</div><div class="summary" data-v-e01a06ce><div data-v-e01a06ce><p data-v-e01a06ce>文章</p></div><div data-v-e01a06ce><p data-v-e01a06ce>分类</p></div><div data-v-e01a06ce><p data-v-e01a06ce>标签</p></div><div data-v-e01a06ce><p data-v-e01a06ce>19</p></div><div data-v-e01a06ce><p data-v-e01a06ce>10</p></div><div data-v-e01a06ce><p data-v-e01a06ce>31</p></div></div><div class="connection" data-v-e01a06ce><div class="grid_icon" data-v-e01a06ce><svg viewbox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon" data-v-e01a06ce><path d="M1023.560892 524.587752c0 114.331752-32.549236 217.148443-97.647709 308.450075-65.047295 91.301632-149.132822 154.455339-252.205404 189.512299-11.975662 2.303012-20.778286 0.716493-26.305515-4.759558a27.584966 27.584966 0 0 1-8.342021-20.471218V853.150798c0-44.166653-11.566238-76.511177-34.647536-96.982394a446.272549 446.272549 0 0 0 68.32269-12.282731c20.16415-5.476051 41.044792-14.329852 62.590748-26.612583a187.311643 187.311643 0 0 0 53.992837-45.446104c14.432209-18.014672 26.203159-41.914819 35.312851-71.751618 9.109692-29.8368 13.664538-64.074912 13.664538-102.765514 0-55.118754-17.554069-102.049021-52.61103-140.739623 16.376974-41.454216 14.636921-87.872703-5.373695-139.357815-12.436265-4.094244-30.399759-1.535341-53.941659 7.523172a355.17563 355.17563 0 0 0-61.311297 30.041513l-25.333132 16.376974a462.137743 462.137743 0 0 0-127.945112-17.707604 462.137743 462.137743 0 0 0-127.945111 17.758782 589.571074 589.571074 0 0 0-28.301459-18.424096c-11.77095-7.31846-30.34858-16.069906-55.681713-26.305515-25.281954-10.235609-44.422543-13.306292-57.31941-9.212048-19.498835 51.433935-21.085354 97.852421-4.606024 139.306637-35.108139 38.690602-52.713386 85.620869-52.713386 140.739623 0 38.690602 4.606024 72.826357 13.715716 102.458445 9.109692 29.58091 20.778286 53.481057 34.954605 71.700441a180.658498 180.658498 0 0 0 53.634591 45.753172c21.545957 12.282731 42.477777 21.18771 62.641926 26.612583 20.215328 5.527229 42.989557 9.621472 68.32269 12.333909-17.758781 16.376974-28.659705 39.867697-32.651593 70.369811a129.941055 129.941055 0 0 1-29.990334 10.235609 184.087426 184.087426 0 0 1-37.974109 3.428929c-14.688099 0-29.171485-4.913092-43.654872-14.688099-14.432209-9.826185-26.766117-24.053681-37.001726-42.682489a109.162769 109.162769 0 0 0-32.293346-35.517563c-13.101579-9.109692-24.104859-14.585743-33.009839-16.376974l-13.306292-2.047122c-9.314404 0-15.762838 1.023561-19.345301 3.070683-3.582463 2.047122-4.606024 4.606024-3.326572 7.83024a37.769397 37.769397 0 0 0 5.987831 9.570295 49.182101 49.182101 0 0 0 8.700267 8.188487l4.606024 3.377751c9.826185 4.606024 19.447657 13.255114 29.017952 25.998447 9.570294 12.743333 16.581686 24.360749 20.982998 34.80107l6.653146 15.71166c5.783119 17.298179 15.558126 31.320963 29.376197 42.017174 13.766894 10.747389 28.659705 17.554069 44.627255 20.471218 15.96755 2.968327 31.423319 4.606024 46.316131 4.810736 14.841633 0.204712 27.22672-0.562958 37.001726-2.405368l15.302235-2.712436c0 17.298179 0.102356 37.564685 0.358247 60.799517l0.307068 36.848192c0 8.188487-2.86597 15.046345-8.700268 20.471218-5.731941 5.527229-14.636921 7.113748-26.612583 4.810736-103.072582-35.056961-187.158109-98.261846-252.205404-189.512299C32.549236 741.736195 0 638.919504 0 524.587752c0-95.191163 22.876586-182.910331 68.629758-263.31104a516.028224 516.028224 0 0 1 186.288082-190.894106A491.309228 491.309228 0 0 1 511.780446 0.012795a491.309228 491.309228 0 0 1 256.913784 70.369811 516.028224 516.028224 0 0 1 186.236905 190.894106C1000.684306 341.626242 1023.560892 429.447767 1023.560892 524.587752z"></path></svg></div><div data-v-e01a06ce><span data-v-e01a06ce>github.com/SayNop</span></div><div class="grid_icon" data-v-e01a06ce><svg viewbox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon" data-v-e01a06ce><path d="M512 1024C229.222 1024 0 794.778 0 512S229.222 0 512 0s512 229.222 512 512-229.222 512-512 512z m259.149-568.883h-290.74a25.293 25.293 0 0 0-25.292 25.293l-0.026 63.206c0 13.952 11.315 25.293 25.267 25.293h177.024c13.978 0 25.293 11.315 25.293 25.267v12.646a75.853 75.853 0 0 1-75.853 75.853h-240.23a25.293 25.293 0 0 1-25.267-25.293V417.203a75.853 75.853 0 0 1 75.827-75.853h353.946a25.293 25.293 0 0 0 25.267-25.292l0.077-63.207a25.293 25.293 0 0 0-25.268-25.293H417.152a189.62 189.62 0 0 0-189.62 189.645V771.15c0 13.977 11.316 25.293 25.294 25.293h372.94a170.65 170.65 0 0 0 170.65-170.65V480.384a25.293 25.293 0 0 0-25.293-25.267z"></path></svg></div><div data-v-e01a06ce><span data-v-e01a06ce>gitee.com/WhenTimeGoesBy</span></div><!-- <div class="grid_icon"><mail_icon class="icon" /></div><div><span @click="open_link(themeData.connection_link.mail)">{{ themeData.connection_link.mail }}</span></div> --><div class="grid_icon" data-v-e01a06ce><svg viewbox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon" data-v-e01a06ce><path d="M874.666667 181.333333H149.333333c-40.533333 0-74.666667 34.133333-74.666666 74.666667v512c0 40.533333 34.133333 74.666667 74.666666 74.666667h725.333334c40.533333 0 74.666667-34.133333 74.666666-74.666667V256c0-40.533333-34.133333-74.666667-74.666666-74.666667z m-725.333334 64h725.333334c6.4 0 10.666667 4.266667 10.666666 10.666667v25.6L512 516.266667l-373.333333-234.666667V256c0-6.4 4.266667-10.666667 10.666666-10.666667z m725.333334 533.333334H149.333333c-6.4 0-10.666667-4.266667-10.666666-10.666667V356.266667l356.266666 224c4.266667 4.266667 10.666667 4.266667 17.066667 4.266666s12.8-2.133333 17.066667-4.266666l356.266666-224V768c0 6.4-4.266667 10.666667-10.666666 10.666667z"></path></svg></div><div data-v-e01a06ce><a href="mailto:fur999immer@gmail.com" data-v-e01a06ce>fur999immer@gmail.com</a></div></div></div></div></div><div class="content_container"><!--[--><div class="card_border article_container" data-v-77edf713><div class="frontmatter_info" data-v-77edf713><h1 data-v-77edf713>非对称加密算法</h1><div data-v-77edf713>2024-05-03</div><div class="card_tag frontmatter_tags" data-v-77edf713><span class="icon" data-v-77edf713><svg viewbox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" data-v-77edf713><path d="M896 682.666667a42.666667 42.666667 0 0 0-42.666667-42.666667h-85.333333v-85.333333a85.333333 85.333333 0 0 0-85.333333-85.333334h-128V384h85.333333a42.666667 42.666667 0 0 0 42.666667-42.666667V170.666667a42.666667 42.666667 0 0 0-42.666667-42.666667H384a42.666667 42.666667 0 0 0-42.666667 42.666667v170.666666a42.666667 42.666667 0 0 0 42.666667 42.666667h85.333333v85.333333H341.333333a85.333333 85.333333 0 0 0-85.333333 85.333334v85.333333H170.666667a42.666667 42.666667 0 0 0-42.666667 42.666667v170.666666a42.666667 42.666667 0 0 0 42.666667 42.666667h256a42.666667 42.666667 0 0 0 42.666666-42.666667v-170.666666a42.666667 42.666667 0 0 0-42.666666-42.666667H341.333333v-85.333333h341.333334v85.333333h-85.333334a42.666667 42.666667 0 0 0-42.666666 42.666667v170.666666a42.666667 42.666667 0 0 0 42.666666 42.666667h256a42.666667 42.666667 0 0 0 42.666667-42.666667z"></path></svg></span><!--[--><!-- 使用冒泡stop，阻止父组件的跳转覆盖子组件 --><span class="article_category" data-v-77edf713 data-v-c2920afd>Cryptography</span><!--]--><span class="icon" style="margin-right:5px;" data-v-77edf713><svg viewbox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" data-v-77edf713><path d="M985.6 473.6 985.6 473.6l-256 256-256 256 0 0C454.4 1011.2 422.4 1024 384 1024c-38.4 0-70.4-12.8-89.6-38.4l0 0-256-256 0 0C12.8 710.4 0 678.4 0 640c0-38.4 12.8-70.4 38.4-89.6l0 0 256-256 256-256 0 0C569.6 12.8 601.6 0 640 0l256 0c70.4 0 128 57.6 128 128l0 256C1024 422.4 1011.2 454.4 985.6 473.6zM768 128c-70.4 0-128 57.6-128 128 0 70.4 57.6 128 128 128 70.4 0 128-57.6 128-128C896 185.6 838.4 128 768 128z"></path></svg></span><!--[--><!--[--><!-- 使用冒泡stop，阻止父组件的跳转覆盖子组件 --><span class="article_tag" data-v-77edf713 data-v-15d5095d>Cryptography</span><!--]--><!--[--><!-- 使用冒泡stop，阻止父组件的跳转覆盖子组件 --><span class="article_tag" data-v-77edf713 data-v-15d5095d>DH</span><!--]--><!--[--><!-- 使用冒泡stop，阻止父组件的跳转覆盖子组件 --><span class="article_tag" data-v-77edf713 data-v-15d5095d>RSA</span><!--]--><!--]--></div></div><div data-v-77edf713><h2 id="简介" tabindex="-1"><a class="header-anchor" href="#简介" aria-hidden="true">#</a> 简介</h2><p>非对称加密算法的加密与解密使用不同的密钥，即公钥和私钥。通常来说，发送方使用公钥加密数据后发送，接受方使用私钥解密数据得到明文</p><h2 id="dh" tabindex="-1"><a class="header-anchor" href="#dh" aria-hidden="true">#</a> DH</h2><p>DH（Diffie-Hellman 密钥交换）算法用于安全的发放收发双方约定的密钥</p><blockquote><p>DH算法是第一个密钥协商算法，仅用于密钥分配，不能用于加解密消息</p></blockquote><h3 id="消息传递流程" tabindex="-1"><a class="header-anchor" href="#消息传递流程" aria-hidden="true">#</a> 消息传递流程</h3><ul><li>收发双方构建本地密钥。构建密钥时，使用本方的私钥及对方的公钥构建本地密钥</li><li>发送方使用本地密钥加密消息发送</li><li>接受方使用本地密钥对收到的消息解密</li></ul><h3 id="api-使用流程" tabindex="-1"><a class="header-anchor" href="#api-使用流程" aria-hidden="true">#</a> API 使用流程</h3><ul><li>通过调用生成甲方密钥对</li><li>通过甲方公钥生成乙方密钥对</li><li>构建甲方本地密钥：通过甲方私钥与乙方公钥构建</li><li>构建乙方本地密钥：通过乙方私钥与甲方公钥构建</li><li>甲方加密</li><li>乙方解密</li></ul><h3 id="代码" tabindex="-1"><a class="header-anchor" href="#代码" aria-hidden="true">#</a> 代码</h3><ul><li>Java API<div class="macos language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// 初始化甲方密钥 - 直接构建</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">initKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token comment">// 1.实例化DH算法的密钥对生成器</span>
    <span class="token class-name">KeyPairGenerator</span> keyPairGenerator <span class="token operator">=</span> <span class="token class-name">KeyPairGenerator</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;DH&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    keyPairGenerator<span class="token punctuation">.</span><span class="token function">initialize</span><span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 初始化生成器 - 密钥长度需64的整数倍，默认1024</span>

    <span class="token comment">// 2.生成密钥对</span>
    <span class="token class-name">KeyPair</span> keyPair <span class="token operator">=</span> keyPairGenerator<span class="token punctuation">.</span><span class="token function">generateKeyPair</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">DHPublicKey</span> publicKey <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">DHPublicKey</span><span class="token punctuation">)</span> keyPair<span class="token punctuation">.</span><span class="token function">getPublic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 甲方公钥</span>
    <span class="token class-name">DHPrivateKey</span> privateKey <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">DHPrivateKey</span><span class="token punctuation">)</span> keyPair<span class="token punctuation">.</span><span class="token function">getPrivate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 甲方私钥</span>
    
    <span class="token comment">// 3.hash表存储密钥并返回</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">KeyMap</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    keyMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;DHPublicKey&quot;</span><span class="token punctuation">,</span> publicKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
    keyMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;DHPrivateKey&quot;</span><span class="token punctuation">,</span> privateKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> keyMap<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 初始化乙方密钥 - 根据甲方公钥构建自己的密钥对</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">initKey</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> publicKey<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token comment">// 1.根据传入的公钥转换成可生成本地密钥对的公钥</span>
    <span class="token class-name">X509EncodedKeySpec</span> x509KeySpec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">X509EncodedKeySpec</span><span class="token punctuation">(</span>publickey<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 公钥转换材料。X509为数字证书文档，根据RFC 5280编码</span>
    <span class="token class-name">KeyFactory</span> keyFactory <span class="token operator">=</span> <span class="token class-name">KeyFactory</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;DH&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 实例化</span>
    <span class="token class-name">PublicKey</span> pubKey <span class="token operator">=</span> keyFactory<span class="token punctuation">.</span><span class="token function">generatePublic</span><span class="token punctuation">(</span>x509KeySpec<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 产生转换后的公钥</span>
        
    <span class="token comment">// 2.根据转化后的公钥构建密钥对</span>
    <span class="token class-name">DHParameterSpec</span> dhParamSpec <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">DHPublicKey</span><span class="token punctuation">)</span> pubKey<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 密钥对生成器</span>
    <span class="token class-name">KeyPairGenerator</span> <span class="token class-name">KeyPairGenerator</span> <span class="token operator">=</span> <span class="token class-name">KeyPairGenerator</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>keyFactory<span class="token punctuation">.</span><span class="token function">getAlgorithm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">// 生成密钥对</span>
    <span class="token class-name">KeyPair</span> keyPair <span class="token operator">=</span> keyPairGenerator<span class="token punctuation">.</span><span class="token function">generateKeyPair</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">DHPublicKey</span> publicKey <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">DHPublicKey</span><span class="token punctuation">)</span> keyPair<span class="token punctuation">.</span><span class="token function">getPublic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 已方公钥</span>
    <span class="token class-name">DHPrivateKey</span> privateKey <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">DHPrivateKey</span><span class="token punctuation">)</span> keyPair<span class="token punctuation">.</span><span class="token function">getPrivate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 已方私钥</span>
    
    <span class="token comment">// 3.hash表存储密钥对并返回</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">KeyMap</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    keyMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;DHPublicKey&quot;</span><span class="token punctuation">,</span> publicKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
    keyMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;DHPrivateKey&quot;</span><span class="token punctuation">,</span> privateKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> keyMap<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 构建本地密钥 - 本方的私钥及对方的公钥</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getSecretKey</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> publicKey<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> privateKey<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span> 
    <span class="token comment">// 公钥转换为可用公钥</span>
    <span class="token class-name">X509EncodedKeySpec</span> x509KeySpec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">X509EncodedKeySpec</span><span class="token punctuation">(</span>publickey<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 公钥转换材料。X509为数字证书文档，根据RFC 5280编码</span>
    <span class="token class-name">KeyFactory</span> keyFactory <span class="token operator">=</span> <span class="token class-name">KeyFactory</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;DH&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 实例化</span>
    <span class="token class-name">PublicKey</span> pubKey <span class="token operator">=</span> keyFactory<span class="token punctuation">.</span><span class="token function">generatePublic</span><span class="token punctuation">(</span>x509KeySpec<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 产生转换后的公钥</span>
        
    <span class="token comment">// 私钥转换为可用私钥</span>
    <span class="token class-name">PKCS8EncodedKeySpec</span> pkcs8KeySpec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PKCS8EncodedKeySpec</span><span class="token punctuation">(</span>privateKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">PrivateKey</span> priKey <span class="token operator">=</span> <span class="token class-name">KeyFactory</span><span class="token punctuation">.</span>generatory<span class="token punctuation">.</span><span class="token function">generatePrivate</span><span class="token punctuation">(</span>pkcs8KeySpec<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
    <span class="token comment">// 构建本地密钥</span>
    <span class="token class-name">KeyAgreement</span> keyAgree <span class="token operator">=</span> <span class="token class-name">KeyAgreement</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>keyFactory<span class="token punctuation">.</span><span class="token function">getAlgorithm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    keyAgree<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>priKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">KeyAgree</span><span class="token punctuation">.</span><span class="token function">doPhase</span><span class="token punctuation">(</span>pubKey<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 生成本地密钥</span>
    <span class="token class-name">SecretKey</span> secretKey <span class="token operator">=</span> keyAgree<span class="token punctuation">.</span><span class="token function">generateSecret</span><span class="token punctuation">(</span><span class="token string">&quot;AES&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> secretKey<span class="token punctuation">.</span><span class="token function">getEncoded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 加密 - 消息加解密使用AES进行，DH只在密钥交换中使用</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> key<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token comment">// 转换成可用本地密钥</span>
    <span class="token class-name">SecretKey</span> secretKey <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SecretKeySpec</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token string">&quot;AES&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 加密</span>
    <span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>secretKey<span class="token punctuation">.</span><span class="token function">getAlgorithm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cipher<span class="token punctuation">,</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token constant">ENCRYPT_MODE</span><span class="token punctuation">,</span> secretKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> cipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 解密 - 消息加解密使用AES进行，DH只在密钥交换中使用</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">decrypt</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> key<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token comment">// 转换成可用本地密钥</span>
    <span class="token class-name">SecretKey</span> secretKey <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SecretKeySpec</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token string">&quot;AES&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 解密</span>
    <span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>secretKey<span class="token punctuation">.</span><span class="token function">getAlgorithm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cipher<span class="token punctuation">,</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token constant">DECRYPT_MODE</span><span class="token punctuation">,</span> secretKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> cipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h2 id="rsa" tabindex="-1"><a class="header-anchor" href="#rsa" aria-hidden="true">#</a> RSA</h2><blockquote><p>RSA算法由三位学者提出，以三位学者首字母命名，基于因数分解，可用与加密与数字签名。</p><p>相对于DES算法，RSA算法效率低，速度慢</p></blockquote><h3 id="消息传递流程-1" tabindex="-1"><a class="header-anchor" href="#消息传递流程-1" aria-hidden="true">#</a> 消息传递流程</h3><ul><li>发送方构建密钥对，公布公钥至消息接受方</li><li>发送方使用私钥加密数据，将加密内容发送至接受方</li><li>接受方通过公钥解密，得到消息内容。即“私钥加密，公钥解密”</li><li>消息的互相发送，即接受方需要向发送方发送消息 <ul><li>如果保持之前情况，则采用“公钥加密，私钥解密”（容易被窃听）</li><li>接受方同样生成密钥对，并告知发送方自己的公钥，以保证“私钥加密，公钥解密”</li><li>即：私钥加密的数据需要公钥解密，公钥加密的数据需要私钥解密</li></ul></li></ul><h3 id="工作模式与密钥长度" tabindex="-1"><a class="header-anchor" href="#工作模式与密钥长度" aria-hidden="true">#</a> 工作模式与密钥长度</h3><p>密钥长度支持512-65536，必须是64的整数倍</p><ul><li>ECB：密钥长度1024</li><li>None：密钥长度2024</li></ul><h3 id="涉及到数学内容" tabindex="-1"><a class="header-anchor" href="#涉及到数学内容" aria-hidden="true">#</a> 涉及到数学内容</h3><ul><li>互质：若N个整数的最大公因数为1，则这N个数互质 <ul><li>判断1：两个质数一定互质</li><li>判断2：一个质数与另一个不是它倍数的数一定互质</li><li>判断3：两个相邻的数一定互质</li><li>判断4：两个相邻的奇数一定互质</li><li>判断5：较大的数为质数时，两数互质</li><li>判断6：较小的数为质数，较大的数不是其倍数，两数互质（与判断2类似）</li><li>判断7：2与任何奇数互质</li><li>判断8：1与任何数互质</li><li>判断9：通过 辗转相除法</li></ul></li><li>欧拉函数：小于等于指定数字 n 的正整数中，与 n 互质的数的个数。例如：n=8，则与 n 互质的数为1、3、5、7，最终结果为4，记为 <!---->。质数的欧拉函数为自身减1，即 <!----> (<!---->为质数) <ul><li>若 <!---->，其中p与q为质数，则有 <!----></li></ul></li><li>同余：若 a 与 b 对 m 求模的值相等，则a与b关于模m同余，记为 <!---->。例如 <!----><ul><li><!---->，则 <!----></li></ul></li><li>模反元素：若 a 与 n 互质，则存在 b ，使 <!----> 可以被n整除（ <!----> 除以 n 的余数为1, <!---->），则b为a的模反元素 - 参考<a href="https://baike.baidu.com/item/%E6%A8%A1%E5%8F%8D%E5%85%83%E7%B4%A0/20417595" target="_blank" rel="noopener noreferrer">百度百科 模反元素<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a><ul><li>根据定义可知 <!----> （k为任意常数），求解出 x 得到一组模反元素</li><li>例如：3 与 11 互质，4 为 3 的模反元素 ，<!----> 可以被11整除。-18，-7，15，26等也为3的模反元素（除以11等于0），即 <!----> 都为模反元素。</li><li>此时记为 <!----> ，或记为 <!----></li><li>模逆元的存在，在模数n下的除法可以用和对应模逆元的乘法来达成，此概念和实数除法的概念相同 - 参考<a href="https://zh.wikipedia.org/wiki/%E6%A8%A1%E5%8F%8D%E5%85%83%E7%B4%A0" target="_blank" rel="noopener noreferrer">wiki百科 模反元素<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul></li><li>欧拉定理：若 m 与 n 互质，则 <!----><ul><li>引申：<!----> 。根据模反元素定义 <!----> 就是 m 在模 n 时的模反元素</li></ul></li></ul><h3 id="实现流程" tabindex="-1"><a class="header-anchor" href="#实现流程" aria-hidden="true">#</a> 实现流程</h3><p>寻找一对数字a，b，使得对a求幂还是对b求幂，对n取余后值为对方的逆运算。即 <!----> ，<!----></p><ul><li>公私钥产生 <ul><li>取余对象：任意两质数 p 与 q （加密中会使用较大质数），且 <!---->，得到 <!---->。例如，取 p = 3，q = 11，<!----> (二进制为<code>100001</code>，6位二进制，即6位加密，实际中会常用1024位)</li><li>公钥范围：计算n的互质个数 <!----></li><li>选公钥：选择小于 <!----> 的整数 e , <!----> ，且需要互质（取模反的条件）。这里取 e = 7。其中，取 e = 19 时，后续生成的公私钥相同</li><li>算私钥：求 e 模 <!----> 的模反元素，命名为d（模反元素定义，需要 e 与 <!----> 互质）。这里取 k = 1 时, d 的值，3</li><li>(n, e) 为公钥，（n，d）为私钥。本例中公钥 (33, 7) ，私钥 (33, 3)</li><li>如果需要猜测私钥，需要知道公钥范围<!---->。而<!---->需要两个质数因子p和q，即对n进行质因数分解</li></ul></li><li>加密 <ul><li>将待加密文本进行编码，得到字节码。例如：加密数字 3</li><li><strong>待加密数字 m 必须小于 n（本例中必须小于33）</strong>，使用事先约定好的方法将待加密文本转换成数组（每两位16进制组成一个数字，举例中直接用ascii码数组）。数组中数字依次使用 <!----> 得到密文c。 <!----> 可用 <!----> ，得到 <!----> ，密文9</li></ul></li><li>解密 <ul><li>根据流程目标，与加密同理</li><li>计算<!---->, 明文为3</li></ul></li></ul><h3 id="原理" tabindex="-1"><a class="header-anchor" href="#原理" aria-hidden="true">#</a> 原理</h3><ul><li><p>明确流程</p><ul><li>明文 m 使用公钥 e 经过 <!----> 加密得到密文 c</li><li>密文 c 使用私钥 d 经过 <!----> 解密得到明文 m′</li><li>将加密公式代入解密公式可知，只需 <strong>证明 <!----> 即可证明该算法</strong></li></ul></li><li><p>根据公私钥生成过程可知，e 与 d 是模 <!----> 的模反元素，即存在整数 k ，使得</p><!----></li><li><p>将 式(1) 代入 <!----> 得到 式(2)</p><!----></li><li><p>将 m 与 n 代入欧拉定理（欧拉定理要求 m 与 n 互质，实际计算中明文 m 与模数 n 不互质也能正常输出），得到 式(3)</p><!----></li><li><p>将 式(3) 两边同乘 m 得到</p><!----></li><li><p>将 式(2) 代入 式(4) 得到 待证明式，即证明完成</p><!----></li></ul><h3 id="代码-1" tabindex="-1"><a class="header-anchor" href="#代码-1" aria-hidden="true">#</a> 代码</h3><ul><li><p>Python实现。代码出自GPT：使用python编写rsa算法的实现流程</p><div class="macos language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> random
<span class="token keyword">from</span> math <span class="token keyword">import</span> gcd  <span class="token comment"># 用于计算最大公约数</span>
<span class="token keyword">from</span> sympy <span class="token keyword">import</span> mod_inverse  <span class="token comment"># 计算模反元素</span>

<span class="token keyword">def</span> <span class="token function">is_prime</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;检查一个数是否为素数&quot;&quot;&quot;</span>
    <span class="token keyword">if</span> n <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>n <span class="token operator">**</span> <span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> n <span class="token operator">%</span> i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>
    <span class="token keyword">return</span> <span class="token boolean">True</span>

<span class="token keyword">def</span> <span class="token function">generate_prime</span><span class="token punctuation">(</span>bits<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;生成一个指定位数的素数&quot;&quot;&quot;</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        num <span class="token operator">=</span> random<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span>bits<span class="token punctuation">)</span>
        <span class="token keyword">if</span> is_prime<span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> num

<span class="token keyword">def</span> <span class="token function">generate_keys</span><span class="token punctuation">(</span>bits<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;生成 RSA 密钥对&quot;&quot;&quot;</span>
    <span class="token comment"># 生成两个大素数 p 和 q</span>
    p <span class="token operator">=</span> generate_prime<span class="token punctuation">(</span>bits<span class="token punctuation">)</span>
    q <span class="token operator">=</span> generate_prime<span class="token punctuation">(</span>bits<span class="token punctuation">)</span>
    <span class="token comment"># 计算 n 和 φ(n)</span>
    n <span class="token operator">=</span> p <span class="token operator">*</span> q
    phi_n <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token comment"># 选择公钥指数 e (通常选择 65537)</span>
    e <span class="token operator">=</span> <span class="token number">65537</span>  <span class="token comment"># 公钥指数</span>
    d <span class="token operator">=</span> mod_inverse<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi_n<span class="token punctuation">)</span>  <span class="token comment"># 私钥指数 - 求模反元素</span>
    
    <span class="token keyword">return</span> <span class="token punctuation">(</span>e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> public_key<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;加密&quot;&quot;&quot;</span>
    e<span class="token punctuation">,</span> n <span class="token operator">=</span> public_key
    encrypted_message <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>char<span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token keyword">for</span> char <span class="token keyword">in</span> message<span class="token punctuation">]</span>
    <span class="token keyword">return</span> encrypted_message

<span class="token keyword">def</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>encrypted_message<span class="token punctuation">,</span> private_key<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;解密&quot;&quot;&quot;</span>
    d<span class="token punctuation">,</span> n <span class="token operator">=</span> private_key
    decrypted_message <span class="token operator">=</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>char<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> char <span class="token keyword">in</span> encrypted_message<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> decrypted_message

<span class="token comment"># 测试 RSA 加密解密</span>
public_key<span class="token punctuation">,</span> private_key <span class="token operator">=</span> generate_keys<span class="token punctuation">(</span>bits<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">)</span>
message <span class="token operator">=</span> <span class="token string">&quot;Hello RSA&quot;</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;原始消息:&quot;</span><span class="token punctuation">,</span> message<span class="token punctuation">)</span>

<span class="token comment"># 加密</span>
encrypted_message <span class="token operator">=</span> encrypt<span class="token punctuation">(</span>message<span class="token punctuation">,</span> public_key<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;加密后的消息:&quot;</span><span class="token punctuation">,</span> encrypted_message<span class="token punctuation">)</span>

<span class="token comment"># 解密</span>
decrypted_message <span class="token operator">=</span> decrypt<span class="token punctuation">(</span>encrypted_message<span class="token punctuation">,</span> private_key<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;解密后的消息:&quot;</span><span class="token punctuation">,</span> decrypted_message<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>代码中的公钥指数补充：关于公钥指数e常用65537，可以加快加密过程</p><ul><li>65537 是一个费马素数（Fermat prime），形式为 <!---->，k = 4时，<!---->。费马素数的二进制较为特殊，如65537的二进制为<code>10000000000000001</code>，在计算乘法和模运算可以通过快速指数算法（如 快速幂算法）进行优化，从而显著提高计算效率</li><li>快速幂算法：将较大的幂运算拆成多个较小的幂运算的乘积，循环查看指定位数是否为1后进行连乘，详细内容可查看<a href="https://oi-wiki.org/math/binary-exponentiation/" target="_blank" rel="noopener noreferrer">快速幂<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>。以对65537求幂为例<!----><div class="macos language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">binpow</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
    res <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">while</span> b <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> b <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">:</span>
            res <span class="token operator">=</span> res <span class="token operator">*</span> a
        a <span class="token operator">=</span> a <span class="token operator">*</span> a
        b <span class="token operator">&gt;&gt;</span><span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">return</span> res
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li></ul></div><div id="comment" class="giscus-wrapper input-top" style="display:block;" data-v-77edf713><div class="loading-icon-wrapper" style="display:flex;align-items:center;justify-content:center;height:96px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div></div><!--]--><footer class="page_footer" data-v-2c01bf66><div class="footer_middle card_border" data-v-2c01bf66><!--[--><span data-v-2c01bf66>Released under the MIT License. <br data-v-2c01bf66></span><span data-v-2c01bf66>Copyright © 2023-present Leopold <br data-v-2c01bf66></span><!--]--></div></footer></div></div></div></div><!----><!----><!--]--></div>
    <script type="module" src="/assets/app-9b1be411.js" defer></script>
  </body>
</html>
