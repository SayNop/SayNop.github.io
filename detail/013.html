<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.68">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <meta property="og:url" content="https://saynop.github.io/detail/013.html"><meta property="og:title" content="密码学与Base64编码"><meta property="og:description" content="概述 机密性问题 对称加密： 经典算法 DES，3DES，AES 分组模式 问题：中间人攻击：明文与密钥同时传送。中间人可取得密钥完成解密 密钥配送：解决中间人攻击问题。如：事先共享密钥等 非对称加密：RSA。存在问题如下 中间人冒充通讯对象，替换公钥 运算慢 对称+非对称混合：解决运算慢问题。对称加密明文，非对称加密密钥。实例：PGP、SSL/TLS。关键点如下 伪随机数生成器算法 对称密码分组模式 非对称密钥长度"><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="article:tag" content="Cryptography"><meta property="article:tag" content="Base64"><meta property="article:published_time" content="2024-03-22T00:00:00.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"密码学与Base64编码","image":[""],"datePublished":"2024-03-22T00:00:00.000Z","dateModified":null,"author":[]}</script><link rel="icon" href="/favicon.ico"><title>密码学与Base64编码</title><meta name="description" content="概述 机密性问题 对称加密： 经典算法 DES，3DES，AES 分组模式 问题：中间人攻击：明文与密钥同时传送。中间人可取得密钥完成解密 密钥配送：解决中间人攻击问题。如：事先共享密钥等 非对称加密：RSA。存在问题如下 中间人冒充通讯对象，替换公钥 运算慢 对称+非对称混合：解决运算慢问题。对称加密明文，非对称加密密钥。实例：PGP、SSL/TLS。关键点如下 伪随机数生成器算法 对称密码分组模式 非对称密钥长度">
    <link rel="preload" href="/assets/style-3253bf1b.css" as="style"><link rel="stylesheet" href="/assets/style-3253bf1b.css">
    <link rel="modulepreload" href="/assets/app-a3536e5f.js"><link rel="modulepreload" href="/assets/013.html-75768f79.js"><link rel="modulepreload" href="/assets/013.html-8dd46ba3.js">
    <link rel="prefetch" href="/assets/index.html-f33fda43.js" as="script"><link rel="prefetch" href="/assets/001.html-12451cc3.js" as="script"><link rel="prefetch" href="/assets/002.html-a6d5828c.js" as="script"><link rel="prefetch" href="/assets/003.html-3e8b49c2.js" as="script"><link rel="prefetch" href="/assets/004.html-689926d8.js" as="script"><link rel="prefetch" href="/assets/005.html-d6b96039.js" as="script"><link rel="prefetch" href="/assets/006.html-5b50a542.js" as="script"><link rel="prefetch" href="/assets/007.html-d3b6ddc8.js" as="script"><link rel="prefetch" href="/assets/008.html-834ef0e1.js" as="script"><link rel="prefetch" href="/assets/009.html-7d1574d7.js" as="script"><link rel="prefetch" href="/assets/010.html-f1724340.js" as="script"><link rel="prefetch" href="/assets/011.html-10672fd1.js" as="script"><link rel="prefetch" href="/assets/012.html-5e7aa08e.js" as="script"><link rel="prefetch" href="/assets/014.html-d0db391f.js" as="script"><link rel="prefetch" href="/assets/015.html-7a04f43c.js" as="script"><link rel="prefetch" href="/assets/016.html-79bc20a6.js" as="script"><link rel="prefetch" href="/assets/017.html-f2df444a.js" as="script"><link rel="prefetch" href="/assets/404.html-a0fec2a7.js" as="script"><link rel="prefetch" href="/assets/index.html-75381ff5.js" as="script"><link rel="prefetch" href="/assets/index.html-c95ce669.js" as="script"><link rel="prefetch" href="/assets/index.html-2c56dc8e.js" as="script"><link rel="prefetch" href="/assets/index.html-98874abd.js" as="script"><link rel="prefetch" href="/assets/index.html-b2308fb7.js" as="script"><link rel="prefetch" href="/assets/index.html-10e703b4.js" as="script"><link rel="prefetch" href="/assets/index.html-5f3af54d.js" as="script"><link rel="prefetch" href="/assets/index.html-56349a98.js" as="script"><link rel="prefetch" href="/assets/index.html-a7c2713a.js" as="script"><link rel="prefetch" href="/assets/index.html-2e96c3d2.js" as="script"><link rel="prefetch" href="/assets/index.html-9f1eff22.js" as="script"><link rel="prefetch" href="/assets/index.html-16b34053.js" as="script"><link rel="prefetch" href="/assets/index.html-4e233464.js" as="script"><link rel="prefetch" href="/assets/index.html-d90f0ec9.js" as="script"><link rel="prefetch" href="/assets/index.html-3202320f.js" as="script"><link rel="prefetch" href="/assets/index.html-c3fe2c85.js" as="script"><link rel="prefetch" href="/assets/index.html-f3052411.js" as="script"><link rel="prefetch" href="/assets/index.html-5485bfc3.js" as="script"><link rel="prefetch" href="/assets/index.html-a7568890.js" as="script"><link rel="prefetch" href="/assets/index.html-9d25f5f2.js" as="script"><link rel="prefetch" href="/assets/index.html-ff33d682.js" as="script"><link rel="prefetch" href="/assets/index.html-3bce843e.js" as="script"><link rel="prefetch" href="/assets/index.html-09b9da96.js" as="script"><link rel="prefetch" href="/assets/index.html-750acad1.js" as="script"><link rel="prefetch" href="/assets/index.html-1c1e573d.js" as="script"><link rel="prefetch" href="/assets/index.html-8eb4570b.js" as="script"><link rel="prefetch" href="/assets/index.html-7dd1db94.js" as="script"><link rel="prefetch" href="/assets/index.html-32048506.js" as="script"><link rel="prefetch" href="/assets/index.html-a4e9e805.js" as="script"><link rel="prefetch" href="/assets/index.html-df3e534f.js" as="script"><link rel="prefetch" href="/assets/index.html-cb3cc9f5.js" as="script"><link rel="prefetch" href="/assets/index.html-0994fca8.js" as="script"><link rel="prefetch" href="/assets/index.html-a902e771.js" as="script"><link rel="prefetch" href="/assets/index.html-76fbbff6.js" as="script"><link rel="prefetch" href="/assets/index.html-7bc29919.js" as="script"><link rel="prefetch" href="/assets/index.html-2642a77f.js" as="script"><link rel="prefetch" href="/assets/index.html-8dfad283.js" as="script"><link rel="prefetch" href="/assets/index.html-0e75c0da.js" as="script"><link rel="prefetch" href="/assets/index.html-1d59d05d.js" as="script"><link rel="prefetch" href="/assets/index.html-cdb37c02.js" as="script"><link rel="prefetch" href="/assets/001.html-a565a0f5.js" as="script"><link rel="prefetch" href="/assets/002.html-730d5d45.js" as="script"><link rel="prefetch" href="/assets/003.html-991569c8.js" as="script"><link rel="prefetch" href="/assets/004.html-4e4d2935.js" as="script"><link rel="prefetch" href="/assets/005.html-279d9ba6.js" as="script"><link rel="prefetch" href="/assets/006.html-2d68c37e.js" as="script"><link rel="prefetch" href="/assets/007.html-2d87829e.js" as="script"><link rel="prefetch" href="/assets/008.html-010f2788.js" as="script"><link rel="prefetch" href="/assets/009.html-988a470b.js" as="script"><link rel="prefetch" href="/assets/010.html-3858cf15.js" as="script"><link rel="prefetch" href="/assets/011.html-eda4600e.js" as="script"><link rel="prefetch" href="/assets/012.html-4aad72d2.js" as="script"><link rel="prefetch" href="/assets/014.html-ca1a00ac.js" as="script"><link rel="prefetch" href="/assets/015.html-e09481cc.js" as="script"><link rel="prefetch" href="/assets/016.html-d49822fe.js" as="script"><link rel="prefetch" href="/assets/017.html-7245b0ea.js" as="script"><link rel="prefetch" href="/assets/404.html-a97f5fa0.js" as="script"><link rel="prefetch" href="/assets/index.html-73d8a350.js" as="script"><link rel="prefetch" href="/assets/index.html-5a3a9c3c.js" as="script"><link rel="prefetch" href="/assets/index.html-85b03498.js" as="script"><link rel="prefetch" href="/assets/index.html-3111a30a.js" as="script"><link rel="prefetch" href="/assets/index.html-712b8542.js" as="script"><link rel="prefetch" href="/assets/index.html-ed9f92b1.js" as="script"><link rel="prefetch" href="/assets/index.html-5d773cf9.js" as="script"><link rel="prefetch" href="/assets/index.html-bcd63050.js" as="script"><link rel="prefetch" href="/assets/index.html-736d2a6e.js" as="script"><link rel="prefetch" href="/assets/index.html-0ce4c43b.js" as="script"><link rel="prefetch" href="/assets/index.html-524970c4.js" as="script"><link rel="prefetch" href="/assets/index.html-79ec3c25.js" as="script"><link rel="prefetch" href="/assets/index.html-48193e87.js" as="script"><link rel="prefetch" href="/assets/index.html-104ebfa1.js" as="script"><link rel="prefetch" href="/assets/index.html-5051aabb.js" as="script"><link rel="prefetch" href="/assets/index.html-f6e813a9.js" as="script"><link rel="prefetch" href="/assets/index.html-123b20ae.js" as="script"><link rel="prefetch" href="/assets/index.html-333f4110.js" as="script"><link rel="prefetch" href="/assets/index.html-48a1ece6.js" as="script"><link rel="prefetch" href="/assets/index.html-f115050e.js" as="script"><link rel="prefetch" href="/assets/index.html-7cf381dc.js" as="script"><link rel="prefetch" href="/assets/index.html-b5e4e390.js" as="script"><link rel="prefetch" href="/assets/index.html-427b173f.js" as="script"><link rel="prefetch" href="/assets/index.html-37ccdc84.js" as="script"><link rel="prefetch" href="/assets/index.html-c7f20e5a.js" as="script"><link rel="prefetch" href="/assets/index.html-55f6390f.js" as="script"><link rel="prefetch" href="/assets/index.html-9a181443.js" as="script"><link rel="prefetch" href="/assets/index.html-4280d0ae.js" as="script"><link rel="prefetch" href="/assets/index.html-38c55b9f.js" as="script"><link rel="prefetch" href="/assets/index.html-ffdd3aca.js" as="script"><link rel="prefetch" href="/assets/index.html-e9e6c7dd.js" as="script"><link rel="prefetch" href="/assets/index.html-84dc5256.js" as="script"><link rel="prefetch" href="/assets/index.html-ea69158f.js" as="script"><link rel="prefetch" href="/assets/index.html-eeb4af0a.js" as="script"><link rel="prefetch" href="/assets/index.html-008b37c0.js" as="script"><link rel="prefetch" href="/assets/index.html-15d9fcd4.js" as="script"><link rel="prefetch" href="/assets/index.html-2f3553f8.js" as="script"><link rel="prefetch" href="/assets/index.html-9328bfd5.js" as="script"><link rel="prefetch" href="/assets/index.html-7d054b85.js" as="script"><link rel="prefetch" href="/assets/giscus-0b7adcf8.js" as="script"><link rel="prefetch" href="/assets/SearchResult-97ceaa1a.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div data-v-77edf713><header class="header" style="opacity:0;" data-v-90176301><div class="header_container" data-v-90176301><div data-v-90176301><a class="header_title" href="/" data-v-90176301>Leopold&#39;s Blog</a></div><div class="appearance" data-v-90176301><!--[--><button type="button" class="search-pro-button" role="search" aria-label="搜索"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">搜索</div><!----></button><!--]--><button class="switch" data-v-90176301><span class="icon" style="display:block;" data-v-90176301><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" style="" data-v-90176301><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" style="display:none;" data-v-90176301><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg></span></button><button class="switch mobile_list_btn" type="button" data-v-90176301><span class="btn_top" data-v-90176301></span><span class="btn_middle" data-v-90176301></span><span class="btn_bottom" data-v-90176301></span></button></div></div></header><div class="main"><div class="background" data-v-fee8de4c><svg class="pull_down" viewbox="0 0 1026 1024" xmlns="http://www.w3.org/2000/svg" data-v-fee8de4c data-v-3c8412b0><path d="M857.088 224.256q28.672-28.672 69.12-28.672t69.12 28.672q29.696 28.672 29.696 68.608t-29.696 68.608l-382.976 380.928q-12.288 14.336-30.72 19.968t-38.912 4.608-40.448-8.704-34.304-22.016l-376.832-374.784q-29.696-28.672-29.696-68.608t29.696-68.608q14.336-14.336 32.256-21.504t36.864-7.168 37.376 7.168 32.768 21.504l313.344 309.248z" data-v-3c8412b0></path></svg></div><div style="display:flex;"><div class="sider_keeper" data-v-e01a06ce><div class="folding" data-v-e01a06ce><!-- <div class="folding"> --><div class="sidebar_top card_border" style="min-height:1rem" data-v-e01a06ce><div class="tags_brand" data-v-e01a06ce>本文大纲</div><section class="article_sidebar" data-v-e01a06ce data-v-905b99e1><ul data-v-905b99e1><!--[--><li class="level2" data-v-905b99e1><a class="sidebar-link" href="#概述" data-v-905b99e1>概述</a><ul class="level3" data-v-905b99e1><!--[--><li data-v-905b99e1><a class="sidebar-link" href="#机密性问题" data-v-905b99e1>机密性问题</a><ul class="level4" data-v-905b99e1><!--[--><!--]--></ul></li><li data-v-905b99e1><a class="sidebar-link" href="#认证问题" data-v-905b99e1>认证问题</a><ul class="level4" data-v-905b99e1><!--[--><!--]--></ul></li><!--]--></ul></li><li class="level2" data-v-905b99e1><a class="sidebar-link" href="#编码流程中的单位问题" data-v-905b99e1>编码流程中的单位问题</a><ul class="level3" data-v-905b99e1><!--[--><!--]--></ul></li><li class="level2" data-v-905b99e1><a class="sidebar-link" href="#电子邮件传输算法-base64编码" data-v-905b99e1>电子邮件传输算法 - Base64编码</a><ul class="level3" data-v-905b99e1><!--[--><li data-v-905b99e1><a class="sidebar-link" href="#base64编码表" data-v-905b99e1>base64编码表</a><ul class="level4" data-v-905b99e1><!--[--><!--]--></ul></li><li data-v-905b99e1><a class="sidebar-link" href="#编码原理" data-v-905b99e1>编码原理</a><ul class="level4" data-v-905b99e1><!--[--><!--]--></ul></li><li data-v-905b99e1><a class="sidebar-link" href="#代码" data-v-905b99e1>代码</a><ul class="level4" data-v-905b99e1><!--[--><!--]--></ul></li><!--]--></ul></li><!--]--></ul></section></div><div class="sidebar_bottom card_border" data-v-e01a06ce><div class="avatar" style="background-image:url(/assets/imgs/avatar.jpg);" data-v-e01a06ce></div><div class="author" data-v-e01a06ce>Leopold</div><div class="summary" data-v-e01a06ce><div data-v-e01a06ce><p data-v-e01a06ce>文章</p></div><div data-v-e01a06ce><p data-v-e01a06ce>分类</p></div><div data-v-e01a06ce><p data-v-e01a06ce>标签</p></div><div data-v-e01a06ce><p data-v-e01a06ce>17</p></div><div data-v-e01a06ce><p data-v-e01a06ce>9</p></div><div data-v-e01a06ce><p data-v-e01a06ce>28</p></div></div><div class="connection" data-v-e01a06ce><div class="grid_icon" data-v-e01a06ce><svg viewbox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon" data-v-e01a06ce><path d="M1023.560892 524.587752c0 114.331752-32.549236 217.148443-97.647709 308.450075-65.047295 91.301632-149.132822 154.455339-252.205404 189.512299-11.975662 2.303012-20.778286 0.716493-26.305515-4.759558a27.584966 27.584966 0 0 1-8.342021-20.471218V853.150798c0-44.166653-11.566238-76.511177-34.647536-96.982394a446.272549 446.272549 0 0 0 68.32269-12.282731c20.16415-5.476051 41.044792-14.329852 62.590748-26.612583a187.311643 187.311643 0 0 0 53.992837-45.446104c14.432209-18.014672 26.203159-41.914819 35.312851-71.751618 9.109692-29.8368 13.664538-64.074912 13.664538-102.765514 0-55.118754-17.554069-102.049021-52.61103-140.739623 16.376974-41.454216 14.636921-87.872703-5.373695-139.357815-12.436265-4.094244-30.399759-1.535341-53.941659 7.523172a355.17563 355.17563 0 0 0-61.311297 30.041513l-25.333132 16.376974a462.137743 462.137743 0 0 0-127.945112-17.707604 462.137743 462.137743 0 0 0-127.945111 17.758782 589.571074 589.571074 0 0 0-28.301459-18.424096c-11.77095-7.31846-30.34858-16.069906-55.681713-26.305515-25.281954-10.235609-44.422543-13.306292-57.31941-9.212048-19.498835 51.433935-21.085354 97.852421-4.606024 139.306637-35.108139 38.690602-52.713386 85.620869-52.713386 140.739623 0 38.690602 4.606024 72.826357 13.715716 102.458445 9.109692 29.58091 20.778286 53.481057 34.954605 71.700441a180.658498 180.658498 0 0 0 53.634591 45.753172c21.545957 12.282731 42.477777 21.18771 62.641926 26.612583 20.215328 5.527229 42.989557 9.621472 68.32269 12.333909-17.758781 16.376974-28.659705 39.867697-32.651593 70.369811a129.941055 129.941055 0 0 1-29.990334 10.235609 184.087426 184.087426 0 0 1-37.974109 3.428929c-14.688099 0-29.171485-4.913092-43.654872-14.688099-14.432209-9.826185-26.766117-24.053681-37.001726-42.682489a109.162769 109.162769 0 0 0-32.293346-35.517563c-13.101579-9.109692-24.104859-14.585743-33.009839-16.376974l-13.306292-2.047122c-9.314404 0-15.762838 1.023561-19.345301 3.070683-3.582463 2.047122-4.606024 4.606024-3.326572 7.83024a37.769397 37.769397 0 0 0 5.987831 9.570295 49.182101 49.182101 0 0 0 8.700267 8.188487l4.606024 3.377751c9.826185 4.606024 19.447657 13.255114 29.017952 25.998447 9.570294 12.743333 16.581686 24.360749 20.982998 34.80107l6.653146 15.71166c5.783119 17.298179 15.558126 31.320963 29.376197 42.017174 13.766894 10.747389 28.659705 17.554069 44.627255 20.471218 15.96755 2.968327 31.423319 4.606024 46.316131 4.810736 14.841633 0.204712 27.22672-0.562958 37.001726-2.405368l15.302235-2.712436c0 17.298179 0.102356 37.564685 0.358247 60.799517l0.307068 36.848192c0 8.188487-2.86597 15.046345-8.700268 20.471218-5.731941 5.527229-14.636921 7.113748-26.612583 4.810736-103.072582-35.056961-187.158109-98.261846-252.205404-189.512299C32.549236 741.736195 0 638.919504 0 524.587752c0-95.191163 22.876586-182.910331 68.629758-263.31104a516.028224 516.028224 0 0 1 186.288082-190.894106A491.309228 491.309228 0 0 1 511.780446 0.012795a491.309228 491.309228 0 0 1 256.913784 70.369811 516.028224 516.028224 0 0 1 186.236905 190.894106C1000.684306 341.626242 1023.560892 429.447767 1023.560892 524.587752z"></path></svg></div><div data-v-e01a06ce><span data-v-e01a06ce>github.com/SayNop</span></div><div class="grid_icon" data-v-e01a06ce><svg viewbox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon" data-v-e01a06ce><path d="M512 1024C229.222 1024 0 794.778 0 512S229.222 0 512 0s512 229.222 512 512-229.222 512-512 512z m259.149-568.883h-290.74a25.293 25.293 0 0 0-25.292 25.293l-0.026 63.206c0 13.952 11.315 25.293 25.267 25.293h177.024c13.978 0 25.293 11.315 25.293 25.267v12.646a75.853 75.853 0 0 1-75.853 75.853h-240.23a25.293 25.293 0 0 1-25.267-25.293V417.203a75.853 75.853 0 0 1 75.827-75.853h353.946a25.293 25.293 0 0 0 25.267-25.292l0.077-63.207a25.293 25.293 0 0 0-25.268-25.293H417.152a189.62 189.62 0 0 0-189.62 189.645V771.15c0 13.977 11.316 25.293 25.294 25.293h372.94a170.65 170.65 0 0 0 170.65-170.65V480.384a25.293 25.293 0 0 0-25.293-25.267z"></path></svg></div><div data-v-e01a06ce><span data-v-e01a06ce>gitee.com/WhenTimeGoesBy</span></div><!-- <div class="grid_icon"><mail_icon class="icon" /></div><div><span @click="open_link(themeData.connection_link.mail)">{{ themeData.connection_link.mail }}</span></div> --><div class="grid_icon" data-v-e01a06ce><svg viewbox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon" data-v-e01a06ce><path d="M874.666667 181.333333H149.333333c-40.533333 0-74.666667 34.133333-74.666666 74.666667v512c0 40.533333 34.133333 74.666667 74.666666 74.666667h725.333334c40.533333 0 74.666667-34.133333 74.666666-74.666667V256c0-40.533333-34.133333-74.666667-74.666666-74.666667z m-725.333334 64h725.333334c6.4 0 10.666667 4.266667 10.666666 10.666667v25.6L512 516.266667l-373.333333-234.666667V256c0-6.4 4.266667-10.666667 10.666666-10.666667z m725.333334 533.333334H149.333333c-6.4 0-10.666667-4.266667-10.666666-10.666667V356.266667l356.266666 224c4.266667 4.266667 10.666667 4.266667 17.066667 4.266666s12.8-2.133333 17.066667-4.266666l356.266666-224V768c0 6.4-4.266667 10.666667-10.666666 10.666667z"></path></svg></div><div data-v-e01a06ce><a href="mailto:fur999immer@gmail.com" data-v-e01a06ce>fur999immer@gmail.com</a></div></div></div></div></div><div class="content_container"><!--[--><div class="card_border article_container" data-v-77edf713><div class="frontmatter_info" data-v-77edf713><h1 data-v-77edf713>密码学与Base64编码</h1><div data-v-77edf713>2024-03-22</div><div class="card_tag frontmatter_tags" data-v-77edf713><span class="icon" data-v-77edf713><svg viewbox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" data-v-77edf713><path d="M896 682.666667a42.666667 42.666667 0 0 0-42.666667-42.666667h-85.333333v-85.333333a85.333333 85.333333 0 0 0-85.333333-85.333334h-128V384h85.333333a42.666667 42.666667 0 0 0 42.666667-42.666667V170.666667a42.666667 42.666667 0 0 0-42.666667-42.666667H384a42.666667 42.666667 0 0 0-42.666667 42.666667v170.666666a42.666667 42.666667 0 0 0 42.666667 42.666667h85.333333v85.333333H341.333333a85.333333 85.333333 0 0 0-85.333333 85.333334v85.333333H170.666667a42.666667 42.666667 0 0 0-42.666667 42.666667v170.666666a42.666667 42.666667 0 0 0 42.666667 42.666667h256a42.666667 42.666667 0 0 0 42.666666-42.666667v-170.666666a42.666667 42.666667 0 0 0-42.666666-42.666667H341.333333v-85.333333h341.333334v85.333333h-85.333334a42.666667 42.666667 0 0 0-42.666666 42.666667v170.666666a42.666667 42.666667 0 0 0 42.666666 42.666667h256a42.666667 42.666667 0 0 0 42.666667-42.666667z"></path></svg></span><!--[--><!-- 使用冒泡stop，阻止父组件的跳转覆盖子组件 --><span class="article_category" data-v-77edf713 data-v-c2920afd>Cryptography</span><!--]--><span class="icon" style="margin-right:5px;" data-v-77edf713><svg viewbox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" data-v-77edf713><path d="M985.6 473.6 985.6 473.6l-256 256-256 256 0 0C454.4 1011.2 422.4 1024 384 1024c-38.4 0-70.4-12.8-89.6-38.4l0 0-256-256 0 0C12.8 710.4 0 678.4 0 640c0-38.4 12.8-70.4 38.4-89.6l0 0 256-256 256-256 0 0C569.6 12.8 601.6 0 640 0l256 0c70.4 0 128 57.6 128 128l0 256C1024 422.4 1011.2 454.4 985.6 473.6zM768 128c-70.4 0-128 57.6-128 128 0 70.4 57.6 128 128 128 70.4 0 128-57.6 128-128C896 185.6 838.4 128 768 128z"></path></svg></span><!--[--><!--[--><!-- 使用冒泡stop，阻止父组件的跳转覆盖子组件 --><span class="article_tag" data-v-77edf713 data-v-15d5095d>Cryptography</span><!--]--><!--[--><!-- 使用冒泡stop，阻止父组件的跳转覆盖子组件 --><span class="article_tag" data-v-77edf713 data-v-15d5095d>Base64</span><!--]--><!--]--></div></div><div data-v-77edf713><h2 id="概述" tabindex="-1"><a class="header-anchor" href="#概述" aria-hidden="true">#</a> 概述</h2><h3 id="机密性问题" tabindex="-1"><a class="header-anchor" href="#机密性问题" aria-hidden="true">#</a> 机密性问题</h3><ul><li>对称加密： <ul><li>经典算法 DES，3DES，AES</li><li>分组模式</li><li>问题：中间人攻击：明文与密钥同时传送。中间人可取得密钥完成解密</li></ul></li><li>密钥配送：解决中间人攻击问题。如：事先共享密钥等</li><li>非对称加密：RSA。存在问题如下 <ul><li>中间人冒充通讯对象，替换公钥</li><li>运算慢</li></ul></li><li>对称+非对称混合：解决运算慢问题。对称加密明文，非对称加密密钥。实例：PGP、SSL/TLS。关键点如下 <ul><li>伪随机数生成器算法</li><li>对称密码分组模式</li><li>非对称密钥长度</li></ul></li></ul><h3 id="认证问题" tabindex="-1"><a class="header-anchor" href="#认证问题" aria-hidden="true">#</a> 认证问题</h3><ul><li>单项散列函数：用于防中间人篡改。别名：哈希、杂凑、摘要。输出消息，输出散列值 <ul><li>经典算法：MD5、SHA1、SHA-256、SHA3等</li><li>攻击：算法破解、暴力破解（撞库）、生日攻击（穷举，任意散列值一致概率）</li><li>问题：中间人伪装 - 无法判断消息是否来自正确的发送者</li></ul></li><li>消息认证码（MAC）：解决中间人伪装问题，防篡改，防伪装 <ul><li>实现：带密钥的hash函数。分组密码，单向散列，流密码等都可实现</li><li>原理：密钥和原明文组合，计算hash值（mac值）。中间人不知道密钥值，伪装消息时无法计算正确的mac值，无法伪装。做到了<strong>双方认证</strong></li><li>应用：SWIFT、IPsec、SSL/TLS</li><li>攻击 <ul><li>重放攻击：中间人将截获的内容与mac保存，重复发送。解决：序号、时间戳、随机值nonce</li><li>密钥推测：对于非随机密钥。通过mac值逆向密钥值</li></ul></li><li>问题 <ul><li>共享密钥不可泄漏（非对称加密或Diffie-Hllman）</li><li>第三方证明：需要防止否认。明确消息发送方，消息即可能为A发送，也可能为B发送。</li></ul></li></ul></li><li>数字签名：防篡改，防伪装、防否认。单向散列函数+非对称加密的反向使用 <ul><li>原理：没有私钥无法生成该私钥所生成的密文。持有密钥才能生成消息</li><li>过程 <ul><li>A持有私钥，B持有公钥</li><li>B向A发送消息，直接使用公钥加密后发送。私钥方通过私钥解密得到明文</li><li>A发送消息时，A用私钥对明文hash值进行加密得到密文（即签名），将明文与签名都发送给B公钥方</li><li>B用公钥对签名进行解密的到hash值，与明文的hash进行对比。确保数据源正常</li></ul></li><li>应用：SSL/TLS</li><li>经典算法 ：RSA、DSA、Rabin</li><li>攻击： <ul><li>单向散列函数是否抗碰撞</li><li>数字签名攻击公钥密码（不对意思不清楚的消息进行签名）</li></ul></li><li>问题 <ul><li>中间人攻击：无法确认公钥来自正确的通信对象。C想伪装成A。将B手中的公钥替换为C生成的公钥，C便可伪装成A进行通信（或者C持有A的私钥，也可伪装）</li><li>签名被盗用</li></ul></li></ul></li><li>公钥证书：第三方认证机构给公钥加数字签名，降低遭遇中间人攻击的风险（认证公钥来防止公钥被替换）。 <ul><li>原理：通过CA的公钥，得到A的公钥。再使用公钥对签名解密得到hash值，与正文hash值对比</li></ul></li><li>公钥基础设施PKI：证书颁发管理 <ul><li>认证机构CA：证书管理人，对注册人的公钥加上数字签名</li><li>证书层级：可通过证书验证另一个证书公钥，实现递归</li><li>攻击 <ul><li>公钥注册证书前替换公钥</li><li>相似注册人名攻击</li><li>认证机构的私钥泄漏 发布CRL</li><li>伪装成认证机构</li><li>CRL发布时差漏洞</li></ul></li></ul></li></ul><h2 id="编码流程中的单位问题" tabindex="-1"><a class="header-anchor" href="#编码流程中的单位问题" aria-hidden="true">#</a> 编码流程中的单位问题</h2><ul><li>位（Bit）：1个二进制</li><li>字节（Byte）：8位二进制</li><li>字（word）：在32位系统中，一个字4字节，共32位二进制；64位系统中，一个字8字节，共64位二进制</li></ul><h2 id="电子邮件传输算法-base64编码" tabindex="-1"><a class="header-anchor" href="#电子邮件传输算法-base64编码" aria-hidden="true">#</a> 电子邮件传输算法 - Base64编码</h2><p>为了解决早期电子邮件传输非ascii码字符时，经过有历史问题的网关（将非ascii码8位二进制最高位的数值置为0）时出现的问题。</p><p>经过Base64编码后的数据比原始数据略长，为原来的4/3倍。base64编码字符串的字符数是4的整数倍，结尾的等号用于补位</p><h3 id="base64编码表" tabindex="-1"><a class="header-anchor" href="#base64编码表" aria-hidden="true">#</a> base64编码表</h3><p>包含字符&quot;A-Za-z0-9+/&quot;</p><table><thead><tr><th style="text-align:left;">码值</th><th style="text-align:left;">字符</th><th style="text-align:left;">码值</th><th style="text-align:left;">字符</th><th style="text-align:left;">码值</th><th style="text-align:left;">字符</th><th style="text-align:left;">码值</th><th style="text-align:left;">字符</th></tr></thead><tbody><tr><td style="text-align:left;">0</td><td style="text-align:left;">A</td><td style="text-align:left;">16</td><td style="text-align:left;">Q</td><td style="text-align:left;">32</td><td style="text-align:left;">g</td><td style="text-align:left;">48</td><td style="text-align:left;">w</td></tr><tr><td style="text-align:left;">1</td><td style="text-align:left;">B</td><td style="text-align:left;">17</td><td style="text-align:left;">R</td><td style="text-align:left;">33</td><td style="text-align:left;">h</td><td style="text-align:left;">49</td><td style="text-align:left;">x</td></tr><tr><td style="text-align:left;">2</td><td style="text-align:left;">C</td><td style="text-align:left;">18</td><td style="text-align:left;">S</td><td style="text-align:left;">34</td><td style="text-align:left;">i</td><td style="text-align:left;">50</td><td style="text-align:left;">y</td></tr><tr><td style="text-align:left;">3</td><td style="text-align:left;">D</td><td style="text-align:left;">19</td><td style="text-align:left;">T</td><td style="text-align:left;">35</td><td style="text-align:left;">j</td><td style="text-align:left;">51</td><td style="text-align:left;">z</td></tr><tr><td style="text-align:left;">4</td><td style="text-align:left;">E</td><td style="text-align:left;">20</td><td style="text-align:left;">U</td><td style="text-align:left;">36</td><td style="text-align:left;">k</td><td style="text-align:left;">52</td><td style="text-align:left;">0</td></tr><tr><td style="text-align:left;">5</td><td style="text-align:left;">F</td><td style="text-align:left;">21</td><td style="text-align:left;">V</td><td style="text-align:left;">37</td><td style="text-align:left;">l</td><td style="text-align:left;">53</td><td style="text-align:left;">1</td></tr><tr><td style="text-align:left;">6</td><td style="text-align:left;">G</td><td style="text-align:left;">22</td><td style="text-align:left;">W</td><td style="text-align:left;">38</td><td style="text-align:left;">m</td><td style="text-align:left;">54</td><td style="text-align:left;">2</td></tr><tr><td style="text-align:left;">7</td><td style="text-align:left;">H</td><td style="text-align:left;">23</td><td style="text-align:left;">X</td><td style="text-align:left;">39</td><td style="text-align:left;">n</td><td style="text-align:left;">55</td><td style="text-align:left;">3</td></tr><tr><td style="text-align:left;">8</td><td style="text-align:left;">I</td><td style="text-align:left;">24</td><td style="text-align:left;">Y</td><td style="text-align:left;">40</td><td style="text-align:left;">o</td><td style="text-align:left;">56</td><td style="text-align:left;">4</td></tr><tr><td style="text-align:left;">9</td><td style="text-align:left;">J</td><td style="text-align:left;">25</td><td style="text-align:left;">Z</td><td style="text-align:left;">41</td><td style="text-align:left;">p</td><td style="text-align:left;">57</td><td style="text-align:left;">5</td></tr><tr><td style="text-align:left;">10</td><td style="text-align:left;">K</td><td style="text-align:left;">26</td><td style="text-align:left;">a</td><td style="text-align:left;">42</td><td style="text-align:left;">q</td><td style="text-align:left;">58</td><td style="text-align:left;">6</td></tr><tr><td style="text-align:left;">11</td><td style="text-align:left;">L</td><td style="text-align:left;">27</td><td style="text-align:left;">b</td><td style="text-align:left;">43</td><td style="text-align:left;">r</td><td style="text-align:left;">59</td><td style="text-align:left;">7</td></tr><tr><td style="text-align:left;">12</td><td style="text-align:left;">M</td><td style="text-align:left;">28</td><td style="text-align:left;">c</td><td style="text-align:left;">44</td><td style="text-align:left;">s</td><td style="text-align:left;">60</td><td style="text-align:left;">8</td></tr><tr><td style="text-align:left;">13</td><td style="text-align:left;">N</td><td style="text-align:left;">29</td><td style="text-align:left;">d</td><td style="text-align:left;">45</td><td style="text-align:left;">t</td><td style="text-align:left;">61</td><td style="text-align:left;">9</td></tr><tr><td style="text-align:left;">14</td><td style="text-align:left;">O</td><td style="text-align:left;">30</td><td style="text-align:left;">e</td><td style="text-align:left;">46</td><td style="text-align:left;">u</td><td style="text-align:left;">62</td><td style="text-align:left;">+</td></tr><tr><td style="text-align:left;">15</td><td style="text-align:left;">P</td><td style="text-align:left;">31</td><td style="text-align:left;">f</td><td style="text-align:left;">47</td><td style="text-align:left;">v</td><td style="text-align:left;">63</td><td style="text-align:left;">/</td></tr></tbody></table><h3 id="编码原理" tabindex="-1"><a class="header-anchor" href="#编码原理" aria-hidden="true">#</a> 编码原理</h3><ul><li>流程 <ul><li>目标字符串以字符为单位转换成字符编码（ascii码）</li><li>将字符编码转换为二进制码</li><li>对二进制码进行分组转换，即每3个8位二进制码一组，转换为每4个8位二进制码为一组（不足6为低位补0）。注意方向从左往右</li><li>对每组中的6位二进制码高位补0，变为每组4个8位进制码</li><li>将变换后的二进制码换为10进制码</li><li>将10进制码对照码表得到结果字符串</li></ul></li><li>例子：目标字符串 <code>A</code><ul><li><code>A</code> 的ascii码为<code>65</code></li><li>ascii码的二进制码<code>01000001</code></li><li>从左往右每6位切分得到4-6二进制码<code>010000 010000</code></li><li>补0得到4-8二进制码<code>00010000 00010000</code></li><li>转换为10进制<code>16 16</code></li><li>对照码表，并补成4的倍数 <code>QQ==</code></li></ul></li></ul><h3 id="代码" tabindex="-1"><a class="header-anchor" href="#代码" aria-hidden="true">#</a> 代码</h3><ul><li><p>Java API</p><div class="macos language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sun<span class="token punctuation">.</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>bcel<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>generic<span class="token punctuation">.</span></span><span class="token class-name">NEW</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> testbase64 <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span><span class="token string">&quot;1101&quot;</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span><span class="token string">&quot;MTEwMQ==&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>C实现，参考<a href="https://blog.csdn.net/qq_26093511/article/details/78836087" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/qq_26093511/article/details/78836087<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="macos language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token comment">/*base64.c*/</span>  
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;base64.h&quot;</span>  </span>
  
<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">)</span>  
<span class="token punctuation">{</span>  
    <span class="token keyword">long</span> len<span class="token punctuation">;</span>  
    <span class="token keyword">long</span> str_len<span class="token punctuation">;</span>  
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>res<span class="token punctuation">;</span>  
    <span class="token keyword">int</span> i<span class="token punctuation">,</span>j<span class="token punctuation">;</span>  
    <span class="token comment">//定义base64编码表  </span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>base64_table <span class="token operator">=</span> <span class="token string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span><span class="token punctuation">;</span>  
  
    <span class="token comment">//计算经过base64编码后的字符串长度  </span>
    str_len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token keyword">if</span><span class="token punctuation">(</span>str_len <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>  
        len <span class="token operator">=</span> str_len<span class="token operator">/</span><span class="token number">3</span><span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">;</span>  
    <span class="token keyword">else</span>  
        len <span class="token operator">=</span> <span class="token punctuation">(</span>str_len<span class="token operator">/</span><span class="token number">3</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">;</span>  
  
    res <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span><span class="token operator">*</span>len<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    res<span class="token punctuation">[</span>len<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">&#39;\0&#39;</span><span class="token punctuation">;</span>  
  
    <span class="token comment">//以3个8位字符为一组进行编码  </span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">;</span> j<span class="token operator">+=</span><span class="token number">3</span><span class="token punctuation">,</span>i<span class="token operator">+=</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> base64_table<span class="token punctuation">[</span>str<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//取出第一个字符的前6位并找出对应的结果字符  </span>
        res<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> base64_table<span class="token punctuation">[</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&amp;</span><span class="token number">0x3</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">4</span> <span class="token operator">|</span> <span class="token punctuation">(</span>str<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//将第一个字符的后位与第二个字符的前4位进行组合并找到对应的结果字符  </span>
        res<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> base64_table<span class="token punctuation">[</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&amp;</span><span class="token number">0xf</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">2</span> <span class="token operator">|</span> <span class="token punctuation">(</span>str<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//将第二个字符的后4位与第三个字符的前2位组合并找出对应的结果字符  </span>
        res<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> base64_table<span class="token punctuation">[</span>str<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&amp;</span><span class="token number">0x3f</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//取出第三个字符的后6位并找出结果字符  </span>
    <span class="token punctuation">}</span>  
  
    <span class="token keyword">switch</span><span class="token punctuation">(</span>str_len <span class="token operator">%</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
    <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>  
        res<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">&#39;=&#39;</span><span class="token punctuation">;</span>  
        res<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">&#39;=&#39;</span><span class="token punctuation">;</span>  
        <span class="token keyword">break</span><span class="token punctuation">;</span>  
    <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>  
        res<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">&#39;=&#39;</span><span class="token punctuation">;</span>  
        <span class="token keyword">break</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  
  
<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>code<span class="token punctuation">)</span>  
<span class="token punctuation">{</span>  
    <span class="token comment">//根据base64表，以字符找到对应的十进制数据  </span>
    <span class="token keyword">int</span> table<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span>
        <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">62</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token number">63</span><span class="token punctuation">,</span><span class="token number">52</span><span class="token punctuation">,</span><span class="token number">53</span><span class="token punctuation">,</span><span class="token number">54</span><span class="token punctuation">,</span><span class="token number">55</span><span class="token punctuation">,</span><span class="token number">56</span><span class="token punctuation">,</span><span class="token number">57</span><span class="token punctuation">,</span><span class="token number">58</span><span class="token punctuation">,</span>
        <span class="token number">59</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token number">61</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span>
        <span class="token number">13</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span>
        <span class="token number">22</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">26</span><span class="token punctuation">,</span>
        <span class="token number">27</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">31</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token number">34</span><span class="token punctuation">,</span><span class="token number">35</span><span class="token punctuation">,</span>
        <span class="token number">36</span><span class="token punctuation">,</span><span class="token number">37</span><span class="token punctuation">,</span><span class="token number">38</span><span class="token punctuation">,</span><span class="token number">39</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">41</span><span class="token punctuation">,</span><span class="token number">42</span><span class="token punctuation">,</span><span class="token number">43</span><span class="token punctuation">,</span><span class="token number">44</span><span class="token punctuation">,</span>
        <span class="token number">45</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">51</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>  
    <span class="token keyword">long</span> len<span class="token punctuation">;</span>  
    <span class="token keyword">long</span> str_len<span class="token punctuation">;</span>  
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>res<span class="token punctuation">;</span>  
    <span class="token keyword">int</span> i<span class="token punctuation">,</span>j<span class="token punctuation">;</span>  
  
    <span class="token comment">//计算解码后的字符串长度  </span>
    len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token comment">//判断编码后的字符串后是否有=  </span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strstr</span><span class="token punctuation">(</span>code<span class="token punctuation">,</span><span class="token string">&quot;==&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  
        str_len <span class="token operator">=</span> len<span class="token operator">/</span><span class="token number">4</span><span class="token operator">*</span><span class="token number">3</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">;</span>  
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strstr</span><span class="token punctuation">(</span>code<span class="token punctuation">,</span><span class="token string">&quot;=&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  
        str_len <span class="token operator">=</span> len<span class="token operator">/</span><span class="token number">4</span><span class="token operator">*</span><span class="token number">3</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>  
    <span class="token keyword">else</span>  
        str_len <span class="token operator">=</span> len<span class="token operator">/</span><span class="token number">4</span><span class="token operator">*</span><span class="token number">3</span><span class="token punctuation">;</span>  
  
    res <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span><span class="token operator">*</span>str_len<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    res<span class="token punctuation">[</span>str_len<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">&#39;\0&#39;</span><span class="token punctuation">;</span>  
  
    <span class="token comment">//以4个字符为一位进行解码  </span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> len<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">;</span>j<span class="token operator">+=</span><span class="token number">3</span><span class="token punctuation">,</span>i<span class="token operator">+=</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        res<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span>table<span class="token punctuation">[</span>code<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">2</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span>table<span class="token punctuation">[</span>code<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&gt;&gt;</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//取出第一个字符对应base64表的十进制数的前6位与第二个字符对应base64表的十进制数的后2位进行组合  </span>
        res<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span>table<span class="token punctuation">[</span>code<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span>table<span class="token punctuation">[</span>code<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&gt;&gt;</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//取出第二个字符对应base64表的十进制数的后4位与第三个字符对应bas464表的十进制数的后4位进行组合  </span>
        res<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span>table<span class="token punctuation">[</span>code<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span>table<span class="token punctuation">[</span>code<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//取出第三个字符对应base64表的十进制数的后2位与第4个字符进行组合  </span>
    <span class="token punctuation">}</span>  
  
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>  
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></div><div id="comment" class="giscus-wrapper input-top" style="display:block;" data-v-77edf713><div class="loading-icon-wrapper" style="display:flex;align-items:center;justify-content:center;height:96px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div></div><!--]--><footer class="page_footer" data-v-2c01bf66><div class="footer_middle card_border" data-v-2c01bf66><!--[--><span data-v-2c01bf66>Released under the MIT License. <br data-v-2c01bf66></span><span data-v-2c01bf66>Copyright © 2023-present Leopold <br data-v-2c01bf66></span><!--]--></div></footer></div></div></div></div><!----><!----><!--]--></div>
    <script type="module" src="/assets/app-a3536e5f.js" defer></script>
  </body>
</html>
